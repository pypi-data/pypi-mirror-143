{% load i18n static favtags %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE|default:"en-gb" }}" class="{% block html_class %}no-js{% endblock %}">
  <head>
    <title>{% block title %}{{ shop_name }} - {{ shop_tagline }}{% endblock %}</title>
    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="created" content="{% now 'jS M Y h:i' %}" />
    <meta name="description" content="{% block description %}{% endblock %}" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    {% if STAGE != 'PRODUCTIVE' %}
      <meta name="robots" content="NOARCHIVE,NOCACHE" />
    {% endif %}
    {% if CONFIG.google_site_id %}
      <meta name="google-site-verification" content="{{ CONFIG.google_site_id }}" />
    {% endif %}
    {% place_favicon %}
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">

    {% include 'partials/import_js.html' %}
    {% include 'partials/import_css.html' %}
    {# Block where global CSS will go. #}
    {% block styles %}{% endblock %}

    {# Additional CSS - specific to certain pages #}
    {% block extrastyles %}{% endblock %}

    {% block extrahead %}{% endblock %}

    {% block tracking %}
        {# Default to using Google analytics #}
        {% include "oscar/partials/google_analytics.html" %}
    {% endblock %}
    <script>
     	const base_url = new URL("{{ request.scheme }}://{{ request.get_host }}");
    	const dynamicDataUrl = "{% url 'dynamic-data' %}";
    	const messageAjaxUrl = "{% url 'message-ajax-url' %}";
    	const toggleSidebarUrl = "{% url 'toggle-sidebar-url' %}";
    </script>
    <style>
      .htmx-indicator{
        display:none;
      }
      .htmx-request{
        display:flex!important;
      }
      .htmx-request{
        display:flex!important;
      }
    </style>
  </head>

  <body id="{% block body_id %}default{% endblock %}" class="{% block body_class %}default{% endblock %} bg-white" style="min-height:100%;" hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
    {% include 'menu.html' %}

    {% block cms_content %}{% endblock %}

    {# Main content goes in this 'layout' block #}
    {% block layout %}{% endblock %}

    {% block footer %}{% include 'partials/footer.html' %}{% endblock %}

    <nav id="sidebarCollapse" class="collapse navbar-collapse container-fluid w-100 h-100 position-fixed d-md-none" style="z-index:10000;top:0;left:0;right:0;bottom:0;">
      <div class="row">
        <div class="col-10 col-sm-8 position-fixed w-100 h-100 pt-5 bg-white" style="overflow-y:scroll;">
          {% include 'oscar/catalogue/partials/browse_sidebar.html' %}
        </div>
        <div class="col-2 col-sm-4 vh-100 position-fixed d-flex text-center p-0" style="right:0;opacity:0.6;">
          <span class="w-100 h-100" type="button" data-toggle="collapse" data-target="#sidebarCollapse" aria-controls="sidebarCollapse" aria-expanded="false" aria-label="Toggle navigation">
          </span>
        </div>
      </div>
    </nav>
    <div class="container-fluid position-fixed" style="z-index: 10000000;bottom:0;left:0;visibility:hidden;">
      <div class="row">
        <div id="messages" class="col-11 col-sm-6 col-xl-3" style="visibility:visible;">
          {% include 'oscar/partials/alert_message.html' %}
        </div>
        <div class="col-auto ml-auto d-flex mt-auto invisible p-0" style="visibility:hidden;">
          <a id="scroll_top_button" class="btn btn-link text-center p-0 nofocus visible" style="display:none;opacity: 0.6;" href="#default">
            <i class="fas fa-caret-square-up text-secondary fa-3x m-3 mr-lg-5"></i>
          </a>
        </div>
      </div>
    </div>
    <div class="htmx-indicator position-fixed w-100 h-100" style="left: 0; top: 0; z-index: 10000; background-color: rgba(255, 255, 255, 0.5);">
      <div class="spinner-border m-auto" role="status">
        <span class="sr-only">Loading...</span>
      </div>
    </div>

    {# Scripts loaded from a CDN. #}
        {% block cdn_scripts %}
        {% endblock %}
    {# Local scripts #}
    {% block scripts %}
    {% endblock %}

    {# Additional JS scripts #}
    {% block extrascripts %}{% endblock %}

    {# Block for body onload functions #}
    <script>
        $(function() {
            {% block onbodyload %}{% endblock %}
            htmx.onLoad(function() {
	        	$('.dropdown-toggle').dropdown();
            });
        	//refreshDynamicSiteData();
        });
    </script>
    {# Page meta-data - this is populated by the 'metadata' template context processor #}
  </body>
</html>
