"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[9152],{40701:(e,t,n)=>{n.d(t,{J0:()=>g,YA:()=>v,bK:()=>_,CB:()=>b,Mu:()=>I,L1:()=>N,aZ:()=>w,qL:()=>O,nj:()=>h,x_:()=>Z,LM:()=>T,Ww:()=>m,v7:()=>E,g3:()=>C,_p:()=>x,az:()=>L,iO:()=>R,Ou:()=>A,WZ:()=>f,A7:()=>y});var r=n(21090),i=n(61988),o=n(72570),s=n(81255),d=n(80621),a=n(47456),c=n(44803),u=n(81395),l=n(31758);const h="UPDATE_COMPONENTS";function p(e){return(...t)=>(n,r)=>{const i=e(...t);if(n("function"==typeof i?i(n,r):i),i.type!==h||!i.payload||!i.payload.nextComponents){const e=r().dashboardLayout.present;n((0,u.P_)(e))}r().dashboardState.hasUnsavedChanges||n((0,l.if)(!0))}}const f=p((e=>({type:h,payload:{nextComponents:e}})));function y(e){return(t,n)=>{const{dashboardLayout:r}=n();t(f({[d.M2]:{...r.present[d.M2],meta:{text:e}}}))}}const _="DASHBOARD_TITLE_CHANGED";function m(e){return{type:_,text:e}}const b="DELETE_COMPONENT",E=p(((e,t)=>({type:b,payload:{id:e,parentId:t}}))),g="CREATE_COMPONENT",T=p((e=>({type:g,payload:{dropResult:e}}))),v="CREATE_TOP_LEVEL_TABS",S=p((e=>({type:v,payload:{dropResult:e}}))),I="DELETE_TOP_LEVEL_TABS",C=p((()=>({type:I,payload:{}}))),O="RESIZE_COMPONENT";function R({id:e,width:t,height:n}){return(r,i)=>{const{dashboardLayout:o}=i(),{present:s}=o,d=s[e],a=t&&d.meta.width!==t,c=n&&d.meta.height!==n;if(d&&(a||c)){const i={[e]:{...d,meta:{...d.meta,width:t||d.meta.width,height:n||d.meta.height}}};r(f(i))}}}const w="MOVE_COMPONENT",D=p((e=>({type:w,payload:{dropResult:e}}))),N="HANDLE_COMPONENT_DROP";function x(e){return(t,n)=>{const r=function(e,t){const n=(0,a.Z)({dropResult:e,layout:t});return"number"==typeof n&&n<0}(e,n().dashboardLayout.present);if(r)return t((0,o.Dz)((0,i.t)("There is not enough space for this component. Try decreasing its width, or increasing the destination width.")));const{source:u,destination:l}=e,h=l&&l.id===d._4,p=u.id===d.D0,f=n().dashboardLayout.present[d._4],y=f&&f.children?f.children[0]:"";if(h)t(S(e));else if(l&&p)t(T(e));else{if(u.type===s.yR&&l.type===s.yR&&u.id===y&&l.id!==y)return t((0,o.Dz)((0,i.t)("Can not move top level tab into nested tabs")));l&&u&&(l.id!==u.id||l.index!==u.index)&&t(D(e))}const{dashboardFilters:_,dashboardLayout:m}=n();if(!p){const{present:e}=m,n=e[u.id]||{},r=e[l.id]||{};if((n.type===s.yR||n.type===s.Os)&&n.children&&0===n.children.length){const n=(0,c.Z)({childId:u.id,layout:e});t(E(u.id,n))}(function({dashboardFilters:e={},source:t=[],destination:n=[]}){const r=new Set(t),i=new Set(n);return[].concat(...Object.values(e).map((({scopes:e})=>[].concat(...Object.values(e).map((({scope:e})=>e)))))).some((e=>i.has(e)!==r.has(e)))})({dashboardFilters:_,source:(n.parents||[]).concat(u.id),destination:(r.parents||[]).concat(l.id)})&&t((0,o.Dz)((0,i.t)("This chart has been moved to a different filter scope.")))}return null}}function A(){return(e,t)=>{e(r.zF.undo());const{dashboardLayout:n,dashboardState:i}=t();0!==n.past.length||i.maxUndoHistoryExceeded||i.updatedColorScheme||e((0,l.if)(!1))}}const L=p(r.zF.redo),Z="UPDATE_COMPONENTS_PARENTS_LIST"},31758:(e,t,n)=>{n.d(t,{BD:()=>C,P0:()=>$,bs:()=>V,sm:()=>J,ec:()=>Q,k5:()=>K,Ii:()=>B,Vd:()=>O,nV:()=>ae,J$:()=>ie,RU:()=>se,$f:()=>j,mq:()=>ue,r$:()=>fe,n1:()=>_e,yV:()=>W,ee:()=>S,oJ:()=>ee,ek:()=>Z,Z9:()=>w,H9:()=>A,Iw:()=>he,Be:()=>F,Pi:()=>ne,Mn:()=>z,Lb:()=>N,Qt:()=>be,z2:()=>H,YC:()=>Y,Yy:()=>X,rL:()=>re,M8:()=>k,TN:()=>x,dr:()=>L,$_:()=>ce,ps:()=>oe,E2:()=>de,Mb:()=>U,GH:()=>le,zL:()=>ye,uN:()=>me,sL:()=>q,if:()=>I,O8:()=>te,WL:()=>P,oY:()=>pe,Sn:()=>M});var r=n(21090),i=n(31069),o=n(61988),s=n(55786),d=n(52256),a=n(37863),c=n(35854),u=n(98286),l=n(80621),h=n(72570),p=n(11370),f=n(43399),y=n(9679),_=n(91877),m=n(93185),b=n(40701),E=n(41295),g=n(50810),T=n(81395),v=n(52794);const S="SET_UNSAVED_CHANGES";function I(e){return{type:S,payload:{hasUnsavedChanges:e}}}const C="ADD_SLICE",O="REMOVE_SLICE",R="/superset/favstar/Dashboard",w="TOGGLE_FAVE_STAR";function D(e){return{type:w,isStarred:e}}function N(e){return function(t){return i.Z.get({endpoint:`${R}/${e}/count/`}).then((({json:e})=>{e.count>0&&t(D(!0))})).catch((()=>t((0,h.Gb)((0,o.t)("There was an issue fetching the favorite status of this dashboard.")))))}}function x(e,t){return function(n){const r=t?"unselect":"select";return i.Z.get({endpoint:`${R}/${e}/${r}/`}).then((()=>{n(D(!t))})).catch((()=>n((0,h.Gb)((0,o.t)("There was an issue favoriting this dashboard.")))))}}const A="TOGGLE_PUBLISHED";function L(e,t){return function(n){return i.Z.put({endpoint:`/api/v1/dashboard/${e}`,headers:{"Content-Type":"application/json"},body:JSON.stringify({published:t})}).then((()=>{n((0,h.ws)(t?(0,o.t)("This dashboard is now published"):(0,o.t)("This dashboard is now hidden"))),n(function(e){return{type:A,isPublished:e}}(t))})).catch((()=>{n((0,h.Gb)((0,o.t)("You do not have permissions to edit this dashboard.")))}))}}const Z="TOGGLE_EXPAND_SLICE";function P(e){return{type:Z,sliceId:e}}const F="UPDATE_CSS";function M(e){return{type:F,css:e}}const j="SET_EDIT_MODE";function U(e){return{type:j,editMode:e}}const $="ON_CHANGE";function H(){return{type:$}}const B="ON_SAVE",W="SET_REFRESH_FREQUENCY";function q(e,t=!1){return{type:W,refreshFrequency:e,isPersistent:t}}function G(e){return t=>{t(function(e){return{type:B,lastModifiedTime:e}}(e)),t(r.zF.clearHistory())}}function k(e,t,n){return(r,d)=>{var a,c,g,S,I,C;r({type:b.x_});const{dashboardFilters:O,dashboardLayout:R}=d(),w=R.present;Object.values(O).forEach((e=>{var t;const{chartId:n}=e,i=e.directPathToFilter.slice().pop(),o=((null==(t=w[i])?void 0:t.parents)||[]).slice();o.push(i),r((0,T.yz)(n,o))}));const D=(0,p.Z)((0,f.De)()),N=function(e){return Object.values(e).reduce(((e,{chartId:t,scopes:n})=>({...e,[t]:Object.keys(n).reduce(((e,t)=>({...e,[t]:n[t]})),{})})),{})}(O),{certified_by:x,certification_details:A,css:L,dashboard_title:Z,owners:P,roles:F,slug:M}=e,j=e=>void 0!==e.id,U={...e,certified_by:x||"",certification_details:x&&A?A:"",css:L||"",dashboard_title:Z||(0,o.t)("[ untitled dashboard ]"),owners:(0,s.Z)(P).map((e=>j(e)?e.id:e)),roles:(0,_.cr)(m.T.DASHBOARD_RBAC)?(0,s.Z)(F).map((e=>j(e)?e.id:e)):void 0,slug:M||null,metadata:{...e.metadata,color_namespace:(null==(a=e.metadata)?void 0:a.color_namespace)||void 0,color_scheme:(null==(c=e.metadata)?void 0:c.color_scheme)||"",expanded_slices:(null==(g=e.metadata)?void 0:g.expanded_slices)||{},label_colors:(null==(S=e.metadata)?void 0:S.label_colors)||{},refresh_frequency:(null==(I=e.metadata)?void 0:I.refresh_frequency)||0,timed_refresh_immune_slices:(null==(C=e.metadata)?void 0:C.timed_refresh_immune_slices)||[]}},$=()=>{const{dashboardInfo:{metadata:{chart_configuration:e={}}}}=d();return Object.values(e).reduce(((e,t)=>Object.values(w).find((e=>{var n;return(null==e||null==(n=e.meta)?void 0:n.chartId)===t.id}))?{...e,[t.id]:t}:e),{})},H=async e=>{const{error:t,message:n}=await(0,u.O)(e);let i=(0,o.t)("Sorry, an unknown error occured");t&&(i=(0,o.t)("Sorry, there was an error saving this dashboard: %s",t)),"string"==typeof n&&"Forbidden"===n&&(i=(0,o.t)("You do not have permission to edit this dashboard")),r((0,h.Gb)(i))};if(n===l.TN){let e={};(0,_.cr)(m.T.DASHBOARD_CROSS_FILTERS)&&(e=$());const n={certified_by:U.certified_by,certification_details:U.certification_details,css:U.css,dashboard_title:U.dashboard_title,slug:U.slug,owners:U.owners,roles:U.roles,json_metadata:(0,y.o)({...(null==U?void 0:U.metadata)||{},default_filters:(0,y.o)(D),filter_scopes:N,chart_configuration:e})};return i.Z.put({endpoint:`/api/v1/dashboard/${t}`,headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>(e=>{const n=e.json.result,i=e.json.last_modified_time;if(n.json_metadata){const e=JSON.parse(n.json_metadata);r((0,E.a8)({metadata:e})),e.chart_configuration&&r({type:E.t$,chartConfiguration:e.chart_configuration}),e.native_filter_configuration&&r({type:v.qe,filterConfig:e.native_filter_configuration})}return i&&r(G(i)),window.history.pushState({event:"dashboard_properties_changed"},"",`/superset/dashboard/${M||t}/`),r((0,h.ws)((0,o.t)("This dashboard was saved successfully."))),e})(e))).catch((e=>H(e)))}const B={...U};B.metadata&&delete B.metadata;const W={...B,...(null==U?void 0:U.metadata)||{}};return i.Z.post({endpoint:`/superset/copy_dash/${t}/`,postPayload:{data:{...W,default_filters:(0,y.o)(D),filter_scopes:(0,y.o)(N)}}}).then((e=>(e=>{const t=e.json.last_modified_time;if(t&&r(G(t)),(0,_.cr)(m.T.DASHBOARD_CROSS_FILTERS)){const e=$();r((0,E.Aw)(e))}return r((0,h.ws)((0,o.t)("This dashboard was saved successfully."))),e})(e))).catch((e=>H(e)))}}function z(e=[],t=!1,n=0,r){return(i,o)=>{if(!n)return void e.forEach((e=>i((0,d.refreshChart)(e,t,r))));const{metadata:s}=o().dashboardInfo,a=Math.max(n,s.stagger_time||5e3);"boolean"!=typeof s.stagger_refresh&&(s.stagger_refresh=void 0===s.stagger_refresh||"true"===s.stagger_refresh);const c=s.stagger_refresh?a/(e.length-1):0;e.forEach(((e,n)=>{setTimeout((()=>i((0,d.refreshChart)(e,t,r))),c*n)}))}}const V="ON_FILTERS_REFRESH",J="ON_FILTERS_REFRESH_SUCCESS";function Y(){return{type:J}}const K="ON_REFRESH_SUCCESS",Q="ON_REFRESH";function X(e=[],t=!1,n=0,r){return i=>{i({type:Q}),((e,t,n,r,i)=>new Promise((o=>{i(z(e,t,n,r)),o()})))(e,t,n,r,i).then((()=>{i({type:K}),i({type:V})}))}}const ee="SHOW_BUILDER_PANE";function te(){return{type:ee}}function ne(e,t){return(n,r)=>{const{sliceEntities:i}=r(),o=i.slices[e];if(!o)return n((0,h.Dz)("Sorry, there is no chart definition associated with the chart trying to be added."));const s={...o.form_data,slice_id:o.slice_id},u={...a.u,id:e,form_data:s,formData:(0,c.oN)(s)};return Promise.all([n((0,d.addChart)(u,e)),n((0,g.QR)(s.datasource))]).then((()=>{n({type:C,slice:o}),o&&"filter_box"===o.viz_type&&n((0,T.KJ)(e,t,o.form_data))}))}}function re(e){return(t,n)=>{const r=n().sliceEntities.slices[e];r&&"filter_box"===r.viz_type&&t((0,T.ku)(e)),t({type:O,sliceId:e}),t((0,d.removeChart)(e))}}const ie="SET_COLOR_SCHEME";function oe(e){return t=>{t(function(e){return{type:ie,colorScheme:e}}(e)),t(I(!0))}}const se="SET_DIRECT_PATH";function de(e){return{type:se,path:e}}const ae="SET_ACTIVE_TABS";function ce(e,t){return{type:ae,tabId:e,prevTabId:t}}const ue="SET_FOCUSED_FILTER_FIELD";function le(e,t){return{type:ue,chartId:e,column:t}}const he="UNSET_FOCUSED_FILTER_FIELD";function pe(e,t){return{type:he,chartId:e,column:t}}const fe="SET_FULL_SIZE_CHART_ID";function ye(e){return{type:fe,chartId:e}}const _e="SET_MAX_UNDO_HISTORY_EXCEEDED";function me(e=!0){return{type:_e,payload:{maxUndoHistoryExceeded:e}}}function be(){return(e,t)=>{const{dashboardLayout:n}=t(),r=n.past.length;return e((0,h.Dz)(`You have used all ${r} undo slots and will not be able to fully undo subsequent actions. You may save your current state to reset the history.`))}}},44803:(e,t,n)=>{n.d(t,{Z:()=>i});const r={};function i({childId:e,layout:t={}}){if(r[e]){const n=t[r[e]]||{};if(n.children&&n.children.includes(e))return n.id}return r[e]=function({childId:e,layout:t={}}){let n=null;const r=Object.keys(t);for(let i=0;i<=r.length-1;i+=1){const o=r[i],s=t[o]||{};if(o!==e&&s.children&&s.children.includes(e)){n=o;break}}return n}({childId:e,layout:t}),r[e]}},47456:(e,t,n)=>{n.d(t,{Z:()=>d});var r=n(80621),i=n(44803),o=n(72673),s=n(28428);function d({dropResult:e,layout:t}){const{source:n,destination:d,dragging:a}=e,c=n.id===r.D0?(0,s.Z)(a.type):t[a.id]||{};if(n.id===d.id)return c.meta.width;const{width:u,minimumWidth:l}=(0,o.Z)({component:c,components:t}),{width:h,occupiedWidth:p}=(0,o.Z)({id:d.id,components:t});let f=Number(h-p);if(Number.isNaN(f)){const{width:e,occupiedWidth:n}=(0,o.Z)({id:(0,i.Z)({childId:d.id,layout:t}),components:t});f=Number(e-n)}return Number.isNaN(f)||Number.isNaN(Number(u))||f>=u?u:f>=l?f:-1}},72673:(e,t,n)=>{n.d(t,{Z:()=>d});var r=n(44803),i=n(80621),o=n(81255);function s({id:e,components:t}){const n=t[e];if(!n)return 0;let r=0;return(n.children||[]).forEach((e=>{const n=t[e]||{};r+=(n.meta||{}).width||0})),r}function d({id:e,component:t,components:n={}}){const a={width:void 0,occupiedWidth:void 0,minimumWidth:void 0},c=t||n[e];return c?(a.width=(c.meta||{}).width,a.occupiedWidth=a.width,c.type===o.Os?(a.width=d({id:(0,r.Z)({childId:c.id,layout:n}),components:n}).width||i.cz,a.occupiedWidth=s({id:c.id,components:n}),a.minimumWidth=a.occupiedWidth||i.cx):c.type===o.BA?(a.minimumWidth=i.cx,a.occupiedWidth=0,(c.children||[]).forEach((e=>{n[e].type===o.Os&&(a.minimumWidth=Math.max(a.minimumWidth,s({id:e,components:n})))}))):c.type!==o.t&&c.type!==o.xh&&c.type!==o.dW||(a.minimumWidth=i.cx),a):a}},11370:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(20194);function i(e){return Object.entries(e).reduce(((e,t)=>{const[n,{values:i}]=t,{chartId:o,column:s}=(0,r._)(n),d={...e[o],[s]:i};return{...e,[o]:d}}),{})}},61358:(e,t,n)=>{n.d(t,{jt:()=>a,Aw:()=>c,J8:()=>l,cq:()=>h,Dr:()=>p,Me:()=>f,M:()=>y,MZ:()=>_});var r=n(31069),i=n(61988),o=n(15926),s=n.n(o),d=n(72570);const a="SET_REPORT";function c(e,t,n,o){const c=s().encode({filters:[{col:t,opr:"eq",value:o},{col:"creation_method",opr:"eq",value:n},{col:"created_by",opr:"rel_o_m",value:e}]});return function(e){return r.Z.get({endpoint:`/api/v1/report/?q=${c}`}).then((({json:t})=>{e({type:a,report:t})})).catch((()=>e((0,d.Gb)((0,i.t)("There was an issue fetching reports attached to this dashboard.")))))}}const u=(e,t)=>{const n=t(),{user:r,dashboardInfo:i,charts:o,explore:s}=n;if(i)e(c(r.userId,"dashboard_id","dashboards",i.id));else{const[t]=Object.keys(o);e(c(s.user.userId,"chart_id","charts",o[t].id))}},l="ADD_REPORT",h=e=>t=>r.Z.post({endpoint:"/api/v1/report/",jsonPayload:e}).then((({json:e})=>{t({type:l,json:e}),t((0,d.ws)((0,i.t)("The report has been created")))})),p="EDIT_REPORT";function f(e,t){return function(n){r.Z.put({endpoint:`/api/v1/report/${e}`,jsonPayload:t}).then((({json:e})=>{n({type:p,json:e})})).catch((()=>n((0,d.Gb)((0,i.t)("An error occurred while editing this report.")))))}}function y(e,t){return function(n){return r.Z.put({endpoint:encodeURI(`/api/v1/report/${e.id}`),headers:{"Content-Type":"application/json"},body:JSON.stringify({active:t})}).catch((()=>{n((0,d.Gb)((0,i.t)("We were unable to active or deactivate this report.")))})).finally((()=>{n(u)}))}}function _(e){return function(t){return r.Z.delete({endpoint:encodeURI(`/api/v1/report/${e.id}`)}).catch((()=>{t((0,d.Gb)((0,i.t)("Your report could not be deleted")))})).finally((()=>{t(u),t((0,d.ws)((0,i.t)("Deleted: %s",e.name)))}))}}},29147:(e,t,n)=>{n.d(t,{fG:()=>a,DG:()=>c});var r=n(67294),i=n(27600),o=n(23525),s=n(11965);const d=(0,r.createContext)({hideTitle:!1,hideTab:!1,hideNav:!1,hideChartControls:!1}),a=()=>(0,r.useContext)(d),c=({children:e})=>{const t=(0,o.e)(i.KD.uiConfig),[n]=(0,r.useState)({hideTitle:0!=(1&t),hideTab:0!=(2&t),hideNav:0!=(4&t),hideChartControls:0!=(8&t)});return(0,s.tZ)(d.Provider,{value:n},e)}},89474:(e,t,n)=>{n.d(t,{h:()=>J});var r=n(14890),i=n(53894),o=n(72570),s=n(99543),d=n(37863),a=n(8868),c=n(61358),u=n(41295),l=n(63389),h=n(31758),p=n(39023),f=n(39759),y=n(24350),_=n.n(y),m=n(50810),b=n(37927),E=n(21090),g=n(80621),T=n(40701),v=n(81255);function S(e){return[v.BA,v.dW,v.xh,v.t].indexOf(e.type)>-1}var I=n(44803),C=n(47456);function O({currentComponent:e,layout:t={}}){if(e&&t[e.id]){const n=(e.parents||[]).slice();n.push(e.id),e.children.forEach((e=>{t[e].parents=n,O({currentComponent:t[e],layout:t})}))}}var R=n(28428);const w={[v.BG]:{[v.dW]:!0,[v.BA]:!0,[v.xh]:!0},[v.gn]:{[v.dW]:!0,[v.BA]:!0,[v.xh]:!0}};function D({parentType:e,childType:t}){if(!e||!t)return!1;const n=w[e];return!!n&&Boolean(n[t])}function N({dropResult:e,layout:t}){const{dragging:n,destination:r}=e,i=n.type,o=t[r.id],s=o.type;let d=(0,R.Z)(i,n.meta);d.parents=(o.parents||[]).concat(o.id),S(n)&&(d.meta.width=(0,C.Z)({dropResult:e,layout:t})||void 0);const a=D({parentType:s,childType:i}),c={[d.id]:d};if(a){const e=(0,R.Z)(v.Os);e.children=[d.id],e.parents=(o.parents||[]).concat(o.id),c[e.id]=e,d.parents=e.parents.concat(e.id),d=e}else if(i===v.yR){const e=(0,R.Z)(v.gn);e.parents=(o.parents||[]).concat(o.id),d.children=[e.id],c[e.id]=e}const u=[...o.children];return u.splice(r.index,0,d.id),c[r.id]={...o,children:u},c}const x={[l.$]:(e,t)=>({...t.data.dashboardLayout.present}),[T.nj](e,t){const{payload:{nextComponents:n}}=t;return{...e,...n}},[T.CB](e,t){const{payload:{id:n,parentId:r}}=t;if(!(r&&n&&e[n]&&e[r]))return e;const i={...e};function o(e,t){const n=i[e];delete i[e];const{children:r=[]}=n;r.forEach((t=>{o(t,e)}));const s=i[t];if(s){const n=(s.children||[]).indexOf(e);if(n>-1){const e=[...s.children];e.splice(n,1),i[t]={...s,children:e}}}}o(n,r);const s=i[r];return s.type===v.Os&&0===s.children.length&&o(r,(0,I.Z)({childId:r,layout:i})),i},[T.J0](e,t){const{payload:{dropResult:n}}=t,r=N({dropResult:n,layout:e});return{...e,...r}},[T.aZ](e,t){const{payload:{dropResult:n}}=t,{source:r,destination:i,dragging:o}=n;if(!r||!i||!o)return e;const s=function({entitiesMap:e,source:t,destination:n}){const r=[...e[t.id].children],i=[...e[n.id].children],o=r[t.index];if(t.id===n.id){const i=function(e,t,n){const r=[...e],[i]=r.splice(t,1);return r.splice(n,0,i),r}(r,t.index,n.index);return{...e,[t.id]:{...e[t.id],children:i}}}return r.splice(t.index,1),i.splice(n.index,0,o),{...e,[t.id]:{...e[t.id],children:r},[n.id]:{...e[n.id],children:i}}}({entitiesMap:e,source:r,destination:i});if(S(s[o.id])){const t=(0,C.Z)({dropResult:n,layout:e})||void 0;(s[o.id].meta||{}).width!==t&&(s[o.id]={...s[o.id],meta:{...s[o.id].meta,width:t}})}if(D({parentType:i.type,childType:o.type})){const e=s[i.id],t=e.children,n=(0,R.Z)(v.Os);n.children=[t[i.index]],n.parents=(e.parents||[]).concat(i.id),t[i.index]=n.id,s[n.id]=n}return{...e,...s}},[T.YA](e,t){const{payload:{dropResult:n}}=t,{source:r,dragging:i}=n,o=e[g._4],s=o.children[0],d=e[s];if(r.id!==g.D0){const t=e[i.id].children[0],n=e[t],r=[...d.children].filter((e=>e!==i.id));return{...e,[g._4]:{...o,children:[i.id]},[s]:{...d,children:[]},[t]:{...n,children:[...n.children,...r]}}}const a=N({dropResult:n,layout:e}),c=Object.values(a),u=c.find((e=>e.type===v.gn)),l=c.find((e=>e.type===v.yR));return u.children=[...d.children],a[s]={...d,children:[]},a[g._4]={...o,children:[l.id]},{...e,...a}},[T.Mu](e){const t=e[g._4],n=t.children[0],r=e[n];if(r.type!==v.yR)return e;let i=[];const o={...e};return r.children.forEach((t=>{const n=e[t];i=[...i,...n.children],delete o[t]})),delete o[n],o[g._4]={...t,children:[g.PV]},o[g.PV]={...e[g.PV],children:i},o},[T.x_](e){const t={...e};return O({currentComponent:t[g._4],layout:t}),{...t}},[T.bK]:(e,t)=>({...e,[g.M2]:{...e[g.M2],meta:{...e[g.M2].meta,text:t.text}}})},A=(0,E.ZP)((function(e={},t){return t.type in x?(0,x[t.type])(e,t):e}),{limit:g.Q9+2,ignoreInitialState:!0,filter:(0,E.an)([l.$,T.nj,T.CB,T.J0,T.YA,T.Mu,T.qL,T.aZ,T.L1])});var L=n(14670),Z=n.n(L),P=n(31069),F=n(9679),M=n(97381),j=n(3741),U=n(23279),$=n.n(U);const H=new class{constructor({callback:e=(()=>{}),sizeThreshold:t=1e3,delayThreshold:n=1e3}){this.queue=[],this.sizeThreshold=t,this.delayThrehold=n,this.trigger=$()(this.trigger.bind(this),this.delayThrehold),this.callback=e}append(e){this.queue.push(e),this.trigger()}trigger(){if(this.queue.length>0){const e=this.queue.splice(0,this.sizeThreshold);this.callback.call(null,e),this.queue.length>0&&this.trigger()}}}({callback:e=>{if(e.length<=0)return;let t="/superset/log/?explode=events";const{source:n,source_id:r}=e[0];if("dashboard"===n?t+=`&dashboard_id=${r}`:"slice"===n&&(t+=`&slice_id=${r}`),navigator.sendBeacon){const n=new FormData;n.append("events",(0,F.o)(e)),navigator.sendBeacon(t,n)}else P.Z.post({endpoint:t,postPayload:{events:e},parseMethod:null})},sizeThreshold:1024,delayThreshold:1e3});let B=0;var W;const q=e=>(t=e)=>t,G=document.getElementById("app"),k=JSON.parse(null!=(W=null==G?void 0:G.getAttribute("data-bootstrap"))?W:"{}"),z={charts:d.Z,datasources:function(e,t){return t.type===m.Rn.SET_DATASOURCES?{...e,..._()(t.datasources,"uid")}:t.type===m.Rn.SET_DATASOURCE?{...e,[t.key]:t.datasource}:e||{}},dashboardInfo:function(e={},t){switch(t.type){case u.$A:return{...e,...t.newInfo,last_modified_time:Math.round((new Date).getTime()/1e3)};case l.$:return{...e,...t.data.dashboardInfo};default:return e}},dashboardFilters:p.ZP,dataMask:a.Z,nativeFilters:f.Z,dashboardState:function(e={},t){const n={[l.$]:()=>({...e,...t.data.dashboardState}),[h.Be]:()=>({...e,css:t.css}),[h.BD](){const n=new Set(e.sliceIds);return n.add(t.slice.slice_id),{...e,sliceIds:Array.from(n)}},[h.Vd](){const{sliceId:n}=t,r=new Set(e.sliceIds);return r.delete(n),{...e,sliceIds:Array.from(r)}},[h.Z9]:()=>({...e,isStarred:t.isStarred}),[h.H9]:()=>({...e,isPublished:t.isPublished}),[h.$f]:()=>({...e,editMode:t.editMode}),[h.n1](){const{maxUndoHistoryExceeded:n=!0}=t.payload;return{...e,maxUndoHistoryExceeded:n}},[h.oJ]:()=>({...e}),[h.J$]:()=>({...e,colorScheme:t.colorScheme,updatedColorScheme:!0}),[h.ek](){const n={...e.expandedSlices},{sliceId:r}=t;return n[r]?delete n[r]:n[r]=!0,{...e,expandedSlices:n}},[h.P0]:()=>({...e,hasUnsavedChanges:!0}),[h.Ii]:()=>({...e,hasUnsavedChanges:!1,maxUndoHistoryExceeded:!1,editMode:!1,updatedColorScheme:!1,lastModifiedTime:t.lastModifiedTime}),[h.ee](){const{hasUnsavedChanges:n}=t.payload;return{...e,hasUnsavedChanges:n}},[h.yV]:()=>({...e,refreshFrequency:t.refreshFrequency,shouldPersistRefreshFrequency:t.isPersistent,hasUnsavedChanges:t.isPersistent}),[h.ec]:()=>({...e,isRefreshing:!0}),[h.bs]:()=>({...e,isFiltersRefreshing:!0}),[h.sm]:()=>({...e,isFiltersRefreshing:!1}),[h.k5]:()=>({...e,isRefreshing:!1}),[h.RU]:()=>({...e,directPathToChild:t.path,directPathLastUpdated:Date.now()}),[h.nV](){const n=new Set(e.activeTabs);return n.delete(t.prevTabId),n.add(t.tabId),{...e,activeTabs:Array.from(n)}},[h.mq]:()=>({...e,focusedFilterField:{chartId:t.chartId,column:t.column}}),[h.Iw]:()=>e.focusedFilterField&&t.chartId===e.focusedFilterField.chartId&&t.column===e.focusedFilterField.column?{...e,focusedFilterField:null}:e,[h.r$]:()=>({...e,fullSizeChartId:t.chartId})};return t.type in n?n[t.type]():e},dashboardLayout:A,sliceEntities:b.Z,reports:function(e={},t){const n={[c.jt]:()=>({...t.report.result.reduce(((e,t)=>({...e,[t.id]:t})),{})}),[c.J8](){const n=t.json.result;return n.id=t.json.id,{...e,[t.json.id]:n}},[c.Dr](){const n=t.json.result;return n.id=t.json.id,{...e,[t.json.id]:n}}};return t.type in n?n[t.type]():e}},V=(0,r.UY)({messageToasts:function(e=[],t){switch(t.type){case o.h:{const{payload:n}=t,r=e.slice();return n.noDuplicate&&r.find((e=>e.text===n.text))?e:[n,...e]}case o.K7:{const{payload:{id:n}}=t;return[...e].filter((e=>e.id!==n))}default:return e}},common:q(k.common||{}),user:q(k.user||{}),impressionId:q(Z().generate()),...z}),J=(0,r.MT)(V,{},(0,r.qC)((0,r.md)(i.Z,(e=>t=>n=>{var r;if(n.type!==M.LOG_EVENT)return t(n);const{dashboardInfo:i,explore:o,impressionId:s,dashboardLayout:d}=e.getState();let a={impression_id:s,version:"v2"};i?a={source:"dashboard",source_id:i.id,...a}:o&&(a={source:"explore",source_id:o.slice?o.slice.slice_id:0,...a});const{eventName:c}=n.payload;let{eventData:u={}}=n.payload;if(u={...a,ts:(new Date).getTime(),event_name:c,...u},j.TY.has(c)?u={...u,event_type:"timing",trigger_event:B}:(B=Z().generate(),u={...u,event_type:"user",event_id:B,visibility:document.visibilityState}),u.target_id&&null!=d&&null!=(r=d.present)&&r[u.target_id]){const{meta:e}=d.present[u.target_id];u.target_name=e.chartId?e.sliceName:e.text}return H.append(u),u})),(0,s.hU)(!1)))}}]);