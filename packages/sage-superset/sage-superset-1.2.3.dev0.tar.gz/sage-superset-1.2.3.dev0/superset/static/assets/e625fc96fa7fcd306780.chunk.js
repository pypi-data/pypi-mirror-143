(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[7465],{27465:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>m});var r=n(43323),a=n(15078),l=n.n(a),i=n(45697),o=n.n(i),s=(n(81896),n(32383)),c=n(67190),d=n(45636),u=n(45511);const h={data:o().shape({records:o().arrayOf(o().shape({x:o().string,y:o().string,v:o().number,perc:o().number,rank:o().number})),extents:o().arrayOf(o().number)}),width:o().number,height:o().number,bottomMargin:o().oneOfType([o().string,o().number]),colorScheme:o().string,columnX:o().string,columnY:o().string,leftMargin:o().oneOfType([o().string,o().number]),metric:o().oneOfType([o().string,o().object]),normalized:o().bool,numberFormat:o().string,showLegend:o().bool,showPercentage:o().bool,showValues:o().bool,sortXAxis:o().string,sortYAxis:o().string,xScaleInterval:o().number,yScaleInterval:o().number,yAxisBounds:o().arrayOf(o().number)};function f(t,e){return t>e?1:-1}function g(t,e){const{data:n,width:r,height:a,bottomMargin:i,canvasImageRendering:o,colorScheme:h,columnX:g,columnY:p,leftMargin:m,metric:x,normalized:v,numberFormat:y,showLegend:b,showPercentage:_,showValues:w,sortXAxis:k,sortYAxis:T,xScaleInterval:$,yScaleInterval:A,yAxisBounds:B}=e,{records:C,extents:O}=n,S={top:10,right:10,bottom:35,left:35};let L=!0,M=!0;const z=(0,c.JB)(y);function P(t,e,n){let r={};const a={};C.forEach((e=>{r[e[t]]=(r[e[t]]||0)+e.v,a[e[t]]=e[t]}));const i=Object.keys(a).map((t=>a[t]));return"alpha_asc"===n?r=i.sort(f):"alpha_desc"===n?r=i.sort(f).reverse():"value_desc"===n?r=Object.keys(r).sort(((t,e)=>r[t]>r[e]?-1:1)):"value_asc"===n&&(r=Object.keys(r).sort(((t,e)=>r[e]>r[t]?-1:1))),"y"===t&&e&&r.reverse(),e?l().scale.ordinal().domain(r).rangeBands(e):l().scale.ordinal().domain(r).range(l().range(r.length))}t.innerHTML="";const E={};!function(){let t=1,e=1;C.forEach((n=>{t=Math.max(t,n.x&&n.x.toString().length||1),e=Math.max(e,n.y&&n.y.toString().length||1)})),S.left="auto"===m?Math.ceil(Math.max(S.left,6*e)):m,b&&(S.right+=40),S.bottom="auto"===i?Math.ceil(Math.max(S.bottom,4.5*t)):i}();let R=r-(S.left+S.right),D=a-(S.bottom+S.top);const I=()=>{S.left="auto"===m?35:m,R=r-(S.left+S.right),L=!1};R<150&&I(),(D<150||R<150)&&(S.bottom="auto"===i?35:i,D=a-(S.bottom+S.top),M=!1),L&&D<150&&I();const F=(0,c.JB)(d.Z.PERCENT),N=P("x",null,k),W=P("y",null,T),Z=P("x",[0,R],k),j=P("y",[D,0],T),U=[Z.domain().length,j.domain().length],H=B[0]||0,V=B[1]||1,X=(0,u.Z)().get(h).createLinearScale([H,V]),Y=[l().scale.linear().domain([0,U[0]]).range([0,R]),l().scale.linear().domain([0,U[1]]).range([0,D])],q=l().select(t);q.classed("superset-legacy-chart-heatmap",!0);const J=q.append("canvas").attr("width",U[0]).attr("height",U[1]).style("width",`${R}px`).style("height",`${D}px`).style("image-rendering",o).style("left",`${S.left}px`).style("top",`${S.top}px`).style("position","absolute"),G=q.append("svg").attr("width",r).attr("height",a).attr("class","heatmap-container").style("position","relative");if(w&&G.selectAll("rect").data(C).enter().append("g").attr("transform",`translate(${S.left}, ${S.top})`).append("text").attr("transform",(t=>`translate(${Z(t.x)}, ${j(t.y)})`)).attr("y",j.rangeBand()/2).attr("x",Z.rangeBand()/2).attr("text-anchor","middle").attr("dy",".35em").text((t=>z(t.v))).attr("font-size",Math.min(j.rangeBand(),Z.rangeBand())/3+"px").attr("fill",(t=>t.v>=O[1]/2?"white":"black")),b){const t=l().legend.color().labelFormat(z).scale(X).shapePadding(0).cells(10).shapeWidth(10).shapeHeight(10).labelOffset(3);G.append("g").attr("transform",`translate(${r-40}, ${S.top})`).call(t)}const K=(0,s.Z)().attr("class","d3-tip").offset((function(){const t=l().mouse(this),e=t[0]-R/2;return[t[1]-20,e]})).html((function(){let t="";const e=l().mouse(this),n=Math.floor(Y[0].invert(e[0])),r=Math.floor(Y[1].invert(e[1])),a="object"==typeof x?x.label:x;if(n in E&&r in E[n]){const e=E[n][r];t+=`<div><b>${g}: </b>${e.x}<div>`,t+=`<div><b>${p}: </b>${e.y}<div>`,t+=`<div><b>${a}: </b>${z(e.v)}<div>`,_&&(t+=`<div><b>%: </b>${F(v?e.rank:e.perc)}<div>`),K.style("display",null)}else K.style("display","none");return t}));if(G.append("g").attr("transform",`translate(${S.left}, ${S.top})`).append("rect").classed("background-rect",!0).on("mousemove",K.show).on("mouseout",K.hide).attr("width",R).attr("height",D).call(K),M){const t=l().svg.axis().scale(Z).outerTickSize(0).tickValues(Z.domain().filter(((t,e)=>!(e%$)))).orient("bottom");G.append("g").attr("class","x axis").attr("transform",`translate(${S.left},${S.top+D})`).call(t).selectAll("text").attr("x",-4).attr("y",10).attr("dy","0.3em").style("text-anchor","end").attr("transform","rotate(-45)")}if(L){const t=l().svg.axis().scale(j).outerTickSize(0).tickValues(j.domain().filter(((t,e)=>!(e%A)))).orient("left");G.append("g").attr("class","y axis").attr("transform",`translate(${S.left},${S.top})`).call(t)}!function(t){const e=t.select(".x.axis").node();e&&e.getBoundingClientRect().x+4<t.node().getBoundingClientRect().x&&t.selectAll(".x.axis").selectAll("text").attr("transform","rotate(-90)").attr("x",-6).attr("y",0).attr("dy","0.3em")}(q);const Q=J.node().getContext("2d");Q.imageSmoothingEnabled=!1,function(){const t=new Image,e=Q.createImageData(U[0],U[1]),n={};C.forEach((t=>{const e=l().rgb(X(v?t.rank:t.perc)),r=N(t.x),a=W(t.y);n[r+a*N.domain().length]=e,void 0===E[r]&&(E[r]={}),void 0===E[r][a]&&(E[r][a]=t)}));let r=0;for(let t=0;t<U[0]*U[1];t+=1){let a=n[t],i=255;void 0===a&&(a=l().rgb("#F00"),i=0),e.data[r+0]=a.r,e.data[r+1]=a.g,e.data[r+2]=a.b,e.data[r+3]=i,r+=4}Q.putImageData(e,0,0),t.src=J.node().toDataURL()}()}g.displayName="Heatmap",g.propTypes=h;const p=g,m=(0,r.Z)(p)},81896:(t,e,n)=>{var r=n(15078);r.legend=n(54510),t.exports=r},54510:(t,e,n)=>{t.exports={color:n(47e3),size:n(28734),symbol:n(84238)}},47e3:(t,e,n)=>{var r=n(8424);t.exports=function(){var t,e=d3.scale.linear(),n="rect",a=15,l=15,i=10,o=2,s=[5],c=[],d="",u=!1,h="",f=d3.format(".01f"),g=10,p="middle",m="to",x="vertical",v=!1,y=d3.dispatch("cellover","cellout","cellclick");function b(b){var _=r.d3_calcType(e,v,s,c,f,m),w=b.selectAll("g").data([e]);w.enter().append("g").attr("class",d+"legendCells");var k=w.selectAll("."+d+"cell").data(_.data),T=k.enter().append("g",".cell").attr("class",d+"cell").style("opacity",1e-6),$=(T.append(n).attr("class",d+"swatch"),k.select("g."+d+"cell "+n));r.d3_addEvents(T,y),k.exit().transition().style("opacity",0).remove(),r.d3_drawShapes(n,$,l,a,i,t),r.d3_addText(w,T,_.labels,d);var A=k.select("text"),B=$[0].map((function(t){return t.getBBox()}));u?$.attr("class",(function(t){return d+"swatch "+_.feature(t)})):"line"==n?$.style("stroke",_.feature):$.style("fill",_.feature);var C,O,S="start"==p?0:"middle"==p?.5:1;"vertical"===x?(C=function(t,e){return"translate(0, "+e*(B[e].height+o)+")"},O=function(t,e){return"translate("+(B[e].width+B[e].x+g)+","+(B[e].y+B[e].height/2+5)+")"}):"horizontal"===x&&(C=function(t,e){return"translate("+e*(B[e].width+o)+",0)"},O=function(t,e){return"translate("+(B[e].width*S+B[e].x)+","+(B[e].height+B[e].y+g+8)+")"}),r.d3_placement(x,k,C,A,O,p),r.d3_title(b,w,h,d),k.transition().style("opacity",1)}return b.scale=function(t){return arguments.length?(e=t,b):e},b.cells=function(t){return arguments.length?((t.length>1||t>=2)&&(s=t),b):s},b.shape=function(e,r){return arguments.length?(("rect"==e||"circle"==e||"line"==e||"path"==e&&"string"==typeof r)&&(n=e,t=r),b):n},b.shapeWidth=function(t){return arguments.length?(a=+t,b):a},b.shapeHeight=function(t){return arguments.length?(l=+t,b):l},b.shapeRadius=function(t){return arguments.length?(i=+t,b):i},b.shapePadding=function(t){return arguments.length?(o=+t,b):o},b.labels=function(t){return arguments.length?(c=t,b):c},b.labelAlign=function(t){return arguments.length?("start"!=t&&"end"!=t&&"middle"!=t||(p=t),b):p},b.labelFormat=function(t){return arguments.length?(f=t,b):f},b.labelOffset=function(t){return arguments.length?(g=+t,b):g},b.labelDelimiter=function(t){return arguments.length?(m=t,b):m},b.useClass=function(t){return arguments.length?(!0!==t&&!1!==t||(u=t),b):u},b.orient=function(t){return arguments.length?("horizontal"!=(t=t.toLowerCase())&&"vertical"!=t||(x=t),b):x},b.ascending=function(t){return arguments.length?(v=!!t,b):v},b.classPrefix=function(t){return arguments.length?(d=t,b):d},b.title=function(t){return arguments.length?(h=t,b):h},d3.rebind(b,y,"on"),b}},8424:t=>{t.exports={d3_identity:function(t){return t},d3_mergeLabels:function(t,e){if(0===e.length)return t;t=t||[];for(var n=e.length;n<t.length;n++)e.push(t[n]);return e},d3_linearLegend:function(t,e,n){var r=[];if(e.length>1)r=e;else for(var a=t.domain(),l=(a[a.length-1]-a[0])/(e-1),i=0;i<e;i++)r.push(a[0]+i*l);var o=r.map(n);return{data:r,labels:o,feature:function(e){return t(e)}}},d3_quantLegend:function(t,e,n){var r=t.range().map((function(r){var a=t.invertExtent(r);return e(a[0]),e(a[1]),e(a[0])+" "+n+" "+e(a[1])}));return{data:t.range(),labels:r,feature:this.d3_identity}},d3_ordinalLegend:function(t){return{data:t.domain(),labels:t.domain(),feature:function(e){return t(e)}}},d3_drawShapes:function(t,e,n,r,a,l){"rect"===t?e.attr("height",n).attr("width",r):"circle"===t?e.attr("r",a):"line"===t?e.attr("x1",0).attr("x2",r).attr("y1",0).attr("y2",0):"path"===t&&e.attr("d",l)},d3_addText:function(t,e,n,r){e.append("text").attr("class",r+"label"),t.selectAll("g."+r+"cell text."+r+"label").data(n).text(this.d3_identity)},d3_calcType:function(t,e,n,r,a,l){var i=t.ticks?this.d3_linearLegend(t,n,a):t.invertExtent?this.d3_quantLegend(t,a,l):this.d3_ordinalLegend(t);return i.labels=this.d3_mergeLabels(i.labels,r),e&&(i.labels=this.d3_reverse(i.labels),i.data=this.d3_reverse(i.data)),i},d3_reverse:function(t){for(var e=[],n=0,r=t.length;n<r;n++)e[n]=t[r-n-1];return e},d3_placement:function(t,e,n,r,a,l){e.attr("transform",n),r.attr("transform",a),"horizontal"===t&&r.style("text-anchor",l)},d3_addEvents:function(t,e){var n=this;t.on("mouseover.legend",(function(t){n.d3_cellOver(e,t,this)})).on("mouseout.legend",(function(t){n.d3_cellOut(e,t,this)})).on("click.legend",(function(t){n.d3_cellClick(e,t,this)}))},d3_cellOver:function(t,e,n){t.cellover.call(n,e)},d3_cellOut:function(t,e,n){t.cellout.call(n,e)},d3_cellClick:function(t,e,n){t.cellclick.call(n,e)},d3_title:function(t,e,n,r){if(""!==n){t.selectAll("text."+r+"legendTitle").data([n]).enter().append("text").attr("class",r+"legendTitle"),t.selectAll("text."+r+"legendTitle").text(n);var a=t.select("."+r+"legendTitle").map((function(t){return t[0].getBBox().height}))[0],l=-e.map((function(t){return t[0].getBBox().x}))[0];e.attr("transform","translate("+l+","+(a+10)+")")}}}},28734:(t,e,n)=>{var r=n(8424);t.exports=function(){var t,e=d3.scale.linear(),n="rect",a=15,l=2,i=[5],o=[],s="",c="",d=d3.format(".01f"),u=10,h="middle",f="to",g="vertical",p=!1,m=d3.dispatch("cellover","cellout","cellclick");function x(x){var v=r.d3_calcType(e,p,i,o,d,f),y=x.selectAll("g").data([e]);y.enter().append("g").attr("class",s+"legendCells");var b=y.selectAll("."+s+"cell").data(v.data),_=b.enter().append("g",".cell").attr("class",s+"cell").style("opacity",1e-6),w=(_.append(n).attr("class",s+"swatch"),b.select("g."+s+"cell "+n));r.d3_addEvents(_,m),b.exit().transition().style("opacity",0).remove(),"line"===n?(r.d3_drawShapes(n,w,0,a),w.attr("stroke-width",v.feature)):r.d3_drawShapes(n,w,v.feature,v.feature,v.feature,t),r.d3_addText(y,_,v.labels,s);var k,T,$=b.select("text"),A=w[0].map((function(t,r){var a=t.getBBox(),l=e(v.data[r]);return"line"===n&&"horizontal"===g?a.height=a.height+l:"line"===n&&"vertical"===g&&(a.width=a.width),a})),B=d3.max(A,(function(t){return t.height+t.y})),C=d3.max(A,(function(t){return t.width+t.x})),O="start"==h?0:"middle"==h?.5:1;"vertical"===g?(k=function(t,e){var n=d3.sum(A.slice(0,e+1),(function(t){return t.height}));return"translate(0, "+(n+e*l)+")"},T=function(t,e){return"translate("+(C+u)+","+(A[e].y+A[e].height/2+5)+")"}):"horizontal"===g&&(k=function(t,e){var n=d3.sum(A.slice(0,e+1),(function(t){return t.width}));return"translate("+(n+e*l)+",0)"},T=function(t,e){return"translate("+(A[e].width*O+A[e].x)+","+(B+u)+")"}),r.d3_placement(g,b,k,$,T,h),r.d3_title(x,y,c,s),b.transition().style("opacity",1)}return x.scale=function(t){return arguments.length?(e=t,x):e},x.cells=function(t){return arguments.length?((t.length>1||t>=2)&&(i=t),x):i},x.shape=function(e,r){return arguments.length?("rect"!=e&&"circle"!=e&&"line"!=e||(n=e,t=r),x):n},x.shapeWidth=function(t){return arguments.length?(a=+t,x):a},x.shapePadding=function(t){return arguments.length?(l=+t,x):l},x.labels=function(t){return arguments.length?(o=t,x):o},x.labelAlign=function(t){return arguments.length?("start"!=t&&"end"!=t&&"middle"!=t||(h=t),x):h},x.labelFormat=function(t){return arguments.length?(d=t,x):d},x.labelOffset=function(t){return arguments.length?(u=+t,x):u},x.labelDelimiter=function(t){return arguments.length?(f=t,x):f},x.orient=function(t){return arguments.length?("horizontal"!=(t=t.toLowerCase())&&"vertical"!=t||(g=t),x):g},x.ascending=function(t){return arguments.length?(p=!!t,x):p},x.classPrefix=function(t){return arguments.length?(s=t,x):s},x.title=function(t){return arguments.length?(c=t,x):c},d3.rebind(x,m,"on"),x}},84238:(t,e,n)=>{var r=n(8424);t.exports=function(){var t=d3.scale.linear(),e="path",n=5,a=[5],l=[],i="",o="",s=d3.format(".01f"),c="middle",d=10,u="to",h="vertical",f=!1,g=d3.dispatch("cellover","cellout","cellclick");function p(p){var m=r.d3_calcType(t,f,a,l,s,u),x=p.selectAll("g").data([t]);x.enter().append("g").attr("class",i+"legendCells");var v=x.selectAll("."+i+"cell").data(m.data),y=v.enter().append("g",".cell").attr("class",i+"cell").style("opacity",1e-6),b=(y.append(e).attr("class",i+"swatch"),v.select("g."+i+"cell "+e));r.d3_addEvents(y,g),v.exit().transition().style("opacity",0).remove(),r.d3_drawShapes(e,b,15,15,10,m.feature),r.d3_addText(x,y,m.labels,i);var _,w,k=v.select("text"),T=b[0].map((function(t){return t.getBBox()})),$=d3.max(T,(function(t){return t.height})),A=d3.max(T,(function(t){return t.width})),B="start"==c?0:"middle"==c?.5:1;"vertical"===h?(_=function(t,e){return"translate(0, "+e*($+n)+")"},w=function(t,e){return"translate("+(A+d)+","+(T[e].y+T[e].height/2+5)+")"}):"horizontal"===h&&(_=function(t,e){return"translate("+e*(A+n)+",0)"},w=function(t,e){return"translate("+(T[e].width*B+T[e].x)+","+($+d)+")"}),r.d3_placement(h,v,_,k,w,c),r.d3_title(p,x,o,i),v.transition().style("opacity",1)}return p.scale=function(e){return arguments.length?(t=e,p):t},p.cells=function(t){return arguments.length?((t.length>1||t>=2)&&(a=t),p):a},p.shapePadding=function(t){return arguments.length?(n=+t,p):n},p.labels=function(t){return arguments.length?(l=t,p):l},p.labelAlign=function(t){return arguments.length?("start"!=t&&"end"!=t&&"middle"!=t||(c=t),p):c},p.labelFormat=function(t){return arguments.length?(s=t,p):s},p.labelOffset=function(t){return arguments.length?(d=+t,p):d},p.labelDelimiter=function(t){return arguments.length?(u=t,p):u},p.orient=function(t){return arguments.length?("horizontal"!=(t=t.toLowerCase())&&"vertical"!=t||(h=t),p):h},p.ascending=function(t){return arguments.length?(f=!!t,p):f},p.classPrefix=function(t){return arguments.length?(i=t,p):i},p.title=function(t){return arguments.length?(o=t,p):o},d3.rebind(p,g,"on"),p}},43323:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(67294),a=n(11965);function l(t,e){class n extends r.Component{constructor(t){super(t),this.container=void 0,this.setContainerRef=this.setContainerRef.bind(this)}componentDidMount(){this.execute()}componentDidUpdate(){this.execute()}componentWillUnmount(){this.container=void 0,null!=e&&e.componentWillUnmount&&e.componentWillUnmount.bind(this)()}setContainerRef(t){this.container=t}execute(){this.container&&t(this.container,this.props)}render(){const{id:t,className:e}=this.props;return(0,a.tZ)("div",{ref:this.setContainerRef,id:t,className:e})}}const l=n;return t.displayName&&(l.displayName=t.displayName),t.propTypes&&(l.propTypes={...l.propTypes,...t.propTypes}),t.defaultProps&&(l.defaultProps=t.defaultProps),n}}}]);