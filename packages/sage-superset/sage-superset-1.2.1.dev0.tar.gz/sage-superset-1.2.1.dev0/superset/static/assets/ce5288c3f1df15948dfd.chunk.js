"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[7974],{27974:(t,e,o)=>{o.r(e),o.d(e,{default:()=>J});var a=o(67294);const r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"plus-square",theme:"outlined"};var s=o(27029),l=function(t,e){return a.createElement(s.Z,Object.assign({},t,{ref:e,icon:r}))};l.displayName="PlusSquareOutlined";const n=a.forwardRef(l),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"minus-square",theme:"outlined"};var c=function(t,e){return a.createElement(s.Z,Object.assign({},t,{ref:e,icon:i}))};c.displayName="MinusSquareOutlined";const u=a.forwardRef(c);var p=o(51995),h=o(67190),d=o(10581),g=o(72813),m=o(38575),f=o(45697),b=o.n(f),v=o(61988);const y=function(t){const e={digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:"",...t};return function(t){if(Number.isNaN(t)||!Number.isFinite(t))return"";const o=function(t,e,o){const a=String(t).split(".");let r=a[0];const s=a.length>1?o+a[1]:"",l=/(\d+)(\d{3})/;for(;l.test(r);)r=r.replace(l,`$1${e}$2`);return r+s}((e.scaler*t).toFixed(e.digitsAfterDecimal),e.thousandsSep,e.decimalSep);return`${e.prefix}${o}${e.suffix}`}},w=/(\d+)|(\D+)/g,k=/\d/,T=/^0/,C=(t,e)=>{if(null!==e&&null===t)return-1;if(null!==t&&null===e)return 1;if("number"==typeof t&&Number.isNaN(t))return-1;if("number"==typeof e&&Number.isNaN(e))return 1;const o=Number(t),a=Number(e);if(o<a)return-1;if(o>a)return 1;if("number"==typeof t&&"number"!=typeof e)return-1;if("number"==typeof e&&"number"!=typeof t)return 1;if("number"==typeof t&&"number"==typeof e)return 0;if(Number.isNaN(a)&&!Number.isNaN(o))return-1;if(Number.isNaN(o)&&!Number.isNaN(a))return 1;let r=String(t),s=String(e);if(r===s)return 0;if(!k.test(r)||!k.test(s))return r>s?1:-1;for(r=r.match(w),s=s.match(w);r.length&&s.length;){const t=r.shift(),e=s.shift();if(t!==e)return k.test(t)&&k.test(e)?t.replace(T,".0")-e.replace(T,".0"):t>e?1:-1}return r.length-s.length},S=function(t){const e={},o={};return t.forEach(((t,a)=>{e[t]=a,"string"==typeof t&&(o[t.toLowerCase()]=a)})),function(t,a){return t in e&&a in e?e[t]-e[a]:t in e?-1:a in e?1:t in o&&a in o?o[t]-o[a]:t in o?-1:a in o?1:C(t,a)}},O=function(t,e){if(t)if("function"==typeof t){const o=t(e);if("function"==typeof o)return o}else if(e in t)return t[e];return C},N=y(),A=y({digitsAfterDecimal:0}),x=y({digitsAfterDecimal:1,scaler:100,suffix:"%"}),H={count:(t=A)=>()=>function(){return{count:0,push(){this.count+=1},value(){return this.count},format:t}},uniques:(t,e=A)=>function([o]){return function(){return{uniq:[],push(t){Array.from(this.uniq).includes(t[o])||this.uniq.push(t[o])},value(){return t(this.uniq)},format:e,numInputs:void 0!==o?0:1}}},sum:(t=N)=>function([e]){return function(){return{sum:0,push(t){Number.isNaN(parseFloat(t[e]))||(this.sum+=parseFloat(t[e]))},value(){return this.sum},format:t,numInputs:void 0!==e?0:1}}},extremes:(t,e=N)=>function([o]){return function(a){return{val:null,sorter:O(void 0!==a?a.sorters:null,o),push(e){let a=e[o];["min","max"].includes(t)&&(a=parseFloat(a),Number.isNaN(a)||(this.val=Math[t](a,null!==this.val?this.val:a))),"first"===t&&this.sorter(a,null!==this.val?this.val:a)<=0&&(this.val=a),"last"===t&&this.sorter(a,null!==this.val?this.val:a)>=0&&(this.val=a)},value(){return this.val},format:t=>Number.isNaN(t)?t:e(t),numInputs:void 0!==o?0:1}}},quantile:(t,e=N)=>function([o]){return function(){return{vals:[],push(t){const e=parseFloat(t[o]);Number.isNaN(e)||this.vals.push(e)},value(){if(0===this.vals.length)return null;this.vals.sort(((t,e)=>t-e));const e=(this.vals.length-1)*t;return(this.vals[Math.floor(e)]+this.vals[Math.ceil(e)])/2},format:e,numInputs:void 0!==o?0:1}}},runningStat:(t="mean",e=1,o=N)=>function([a]){return function(){return{n:0,m:0,s:0,push(t){const e=parseFloat(t[a]);if(Number.isNaN(e))return;this.n+=1,1===this.n&&(this.m=e);const o=this.m+(e-this.m)/this.n;this.s+=(e-this.m)*(e-o),this.m=o},value(){if("mean"===t)return 0===this.n?NaN:this.m;if(this.n<=e)return 0;switch(t){case"var":return this.s/(this.n-e);case"stdev":return Math.sqrt(this.s/(this.n-e));default:throw new Error("unknown mode for runningStat")}},format:o,numInputs:void 0!==a?0:1}}},sumOverSum:(t=N)=>function([e,o]){return function(){return{sumNum:0,sumDenom:0,push(t){Number.isNaN(parseFloat(t[e]))||(this.sumNum+=parseFloat(t[e])),Number.isNaN(parseFloat(t[o]))||(this.sumDenom+=parseFloat(t[o]))},value(){return this.sumNum/this.sumDenom},format:t,numInputs:void 0!==e&&void 0!==o?0:2}}},fractionOf:(t,e="total",o=x)=>(...a)=>function(r,s,l){return{selector:{total:[[],[]],row:[s,[]],col:[[],l]}[e],inner:t(...Array.from(a||[]))(r,s,l),push(t){this.inner.push(t)},format:o,value(){return this.inner.value()/r.getAggregator(...Array.from(this.selector||[])).inner.value()},numInputs:t(...Array.from(a||[]))().numInputs}}},R={countUnique:t=>H.uniques((t=>t.length),t),listUnique:(t,e)=>H.uniques((e=>e.join(t)),e||(t=>t)),max:t=>H.extremes("max",t),min:t=>H.extremes("min",t),first:t=>H.extremes("first",t),last:t=>H.extremes("last",t),median:t=>H.quantile(.5,t),average:t=>H.runningStat("mean",1,t),var:(t,e)=>H.runningStat("var",t,e),stdev:(t,e)=>H.runningStat("stdev",t,e)},F={...H,...R},_={Count:(K=F).count(A),"Count Unique Values":K.countUnique(A),"List Unique Values":K.listUnique(", "),Sum:K.sum(N),"Integer Sum":K.sum(A),Average:K.average(N),Median:K.median(N),"Sample Variance":K.var(1,N),"Sample Standard Deviation":K.stdev(1,N),Minimum:K.min(N),Maximum:K.max(N),First:K.first(N),Last:K.last(N),"Sum over Sum":K.sumOverSum(N),"Sum as Fraction of Total":K.fractionOf(K.sum(),"total",x),"Sum as Fraction of Rows":K.fractionOf(K.sum(),"row",x),"Sum as Fraction of Columns":K.fractionOf(K.sum(),"col",x),"Count as Fraction of Total":K.fractionOf(K.count(),"total",x),"Count as Fraction of Rows":K.fractionOf(K.count(),"row",x),"Count as Fraction of Columns":K.fractionOf(K.count(),"col",x)};var K;const M=t=>t.join(String.fromCharCode(0));class Z{constructor(t={},e={}){this.props={...Z.defaultProps,...t},this.processRecord=this.processRecord.bind(this),b().checkPropTypes(Z.propTypes,this.props,"prop","PivotData"),this.aggregator=this.props.aggregatorsFactory(this.props.defaultFormatter)[this.props.aggregatorName](this.props.vals),this.formattedAggregators=this.props.customFormatters&&Object.entries(this.props.customFormatters).reduce(((t,[e,o])=>(t[e]={},Object.entries(o).forEach((([o,a])=>{t[e][o]=this.props.aggregatorsFactory(a)[this.props.aggregatorName](this.props.vals)})),t)),{}),this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.aggregator(this,[],[]),this.subtotals=e,this.sorted=!1,Z.forEachRecord(this.props.data,this.processRecord)}getFormattedAggregator(t,e){if(!this.formattedAggregators)return this.aggregator;const[o,a]=Object.entries(t).find((([t,e])=>this.formattedAggregators[t]&&this.formattedAggregators[t][e]))||[];return!o||!a||e&&!e.includes(a)?this.aggregator:this.formattedAggregators[o][a]||this.aggregator}arrSort(t,e,o=!1){const a=t.map((t=>O(this.props.sorters,t)));return function(t,r){const s=Math.min(t.length,r.length);for(let e=0;e<s;e+=1){const s=a[e],l=o?s(r[e],t[e]):s(t[e],r[e]);if(0!==l)return l}return e?t.length-r.length:r.length-t.length}}sortKeys(){if(!this.sorted){this.sorted=!0;const t=(t,e)=>this.getAggregator(t,e).value();switch(this.props.rowOrder){case"key_z_to_a":this.rowKeys.sort(this.arrSort(this.props.rows,this.subtotals.rowPartialOnTop,!0));break;case"value_a_to_z":this.rowKeys.sort(((e,o)=>C(t(e,[]),t(o,[]))));break;case"value_z_to_a":this.rowKeys.sort(((e,o)=>-C(t(e,[]),t(o,[]))));break;default:this.rowKeys.sort(this.arrSort(this.props.rows,this.subtotals.rowPartialOnTop))}switch(this.props.colOrder){case"key_z_to_a":this.colKeys.sort(this.arrSort(this.props.cols,this.subtotals.colPartialOnTop,!0));break;case"value_a_to_z":this.colKeys.sort(((e,o)=>C(t([],e),t([],o))));break;case"value_z_to_a":this.colKeys.sort(((e,o)=>-C(t([],e),t([],o))));break;default:this.colKeys.sort(this.arrSort(this.props.cols,this.subtotals.colPartialOnTop))}}}getColKeys(){return this.sortKeys(),this.colKeys}getRowKeys(){return this.sortKeys(),this.rowKeys}processRecord(t){const e=[],o=[];this.props.cols.forEach((o=>{e.push(o in t?t[o]:"null")})),this.props.rows.forEach((e=>{o.push(e in t?t[e]:"null")})),this.allTotal.push(t);const a=this.subtotals.rowEnabled?1:Math.max(1,o.length),r=this.subtotals.colEnabled?1:Math.max(1,e.length);let s,l;for(let e=a;e<=o.length;e+=1){s=e<o.length;const a=o.slice(0,e),r=M(a);this.rowTotals[r]||(this.rowKeys.push(a),this.rowTotals[r]=this.getFormattedAggregator(t,o)(this,a,[])),this.rowTotals[r].push(t),this.rowTotals[r].isSubtotal=s}for(let o=r;o<=e.length;o+=1){l=o<e.length;const a=e.slice(0,o),r=M(a);this.colTotals[r]||(this.colKeys.push(a),this.colTotals[r]=this.getFormattedAggregator(t,e)(this,[],a)),this.colTotals[r].push(t),this.colTotals[r].isSubtotal=l}for(let n=a;n<=o.length;n+=1){s=n<o.length;const a=o.slice(0,n),i=M(a);this.tree[i]||(this.tree[i]={});for(let o=r;o<=e.length;o+=1){l=o<e.length;const r=e.slice(0,o),n=M(r);this.tree[i][n]||(this.tree[i][n]=this.getFormattedAggregator(t)(this,a,r)),this.tree[i][n].push(t),this.tree[i][n].isRowSubtotal=s,this.tree[i][n].isColSubtotal=l,this.tree[i][n].isSubtotal=s||l}}}getAggregator(t,e){let o;const a=M(t),r=M(e);return o=0===t.length&&0===e.length?this.allTotal:0===t.length?this.colTotals[r]:0===e.length?this.rowTotals[a]:this.tree[a][r],o||{value:()=>null,format:()=>""}}}Z.forEachRecord=function(t,e){if(Array.isArray(t))return t.map((t=>e(t)));throw new Error((0,v.t)("Unknown input format"))},Z.defaultProps={aggregators:_,cols:[],rows:[],vals:[],aggregatorName:"Count",sorters:{},rowOrder:"key_a_to_z",colOrder:"key_a_to_z"},Z.propTypes={data:b().oneOfType([b().array,b().object,b().func]).isRequired,aggregatorName:b().string,cols:b().arrayOf(b().string),rows:b().arrayOf(b().string),vals:b().arrayOf(b().string),valueFilter:b().objectOf(b().objectOf(b().bool)),sorters:b().oneOfType([b().func,b().objectOf(b().func)]),derivedAttributes:b().objectOf(b().func),rowOrder:b().oneOf(["key_a_to_z","key_z_to_a","value_a_to_z","value_z_to_a"]),colOrder:b().oneOf(["key_a_to_z","key_z_to_a","value_a_to_z","value_z_to_a"])};const E=p.iK.div`
  table.pvtTable {
    position: relative;
    font-size: 12px;
    text-align: left;
    margin-top: 3px;
    margin-left: 3px;
    border-collapse: separate;
    font-family: 'Inter', Helvetica, Arial, sans-serif;
    line-height: 1.4;
  }

  table thead {
    position: sticky;
    top: 0;
  }

  table.pvtTable thead tr th,
  table.pvtTable tbody tr th {
    background-color: #fff;
    border-top: 1px solid #e0e0e0;
    border-left: 1px solid #e0e0e0;
    font-size: 12px;
    padding: 5px;
    font-weight: normal;
  }

  table.pvtTable tbody tr.pvtRowTotals {
    position: sticky;
    bottom: 0;
  }

  table.pvtTable thead tr:last-of-type th,
  table.pvtTable thead tr:first-of-type th.pvtTotalLabel,
  table.pvtTable thead tr:nth-last-of-type(2) th.pvtColLabel,
  table.pvtTable thead th.pvtSubtotalLabel,
  table.pvtTable tbody tr:last-of-type th,
  table.pvtTable tbody tr:last-of-type td {
    border-bottom: 1px solid #e0e0e0;
  }

  table.pvtTable
    thead
    tr:last-of-type:not(:only-child)
    th.pvtAxisLabel
    ~ th.pvtColLabel,
  table.pvtTable tbody tr:first-of-type th,
  table.pvtTable tbody tr:first-of-type td {
    border-top: none;
  }

  table.pvtTable tbody tr td:last-of-type,
  table.pvtTable thead tr th:last-of-type:not(.pvtSubtotalLabel) {
    border-right: 1px solid #e0e0e0;
  }

  table.pvtTable
    thead
    tr:last-of-type:not(:only-child)
    th.pvtAxisLabel
    + .pvtTotalLabel {
    border-right: none;
  }

  table.pvtTable tr th.active {
    background-color: #d9dbe4;
  }

  table.pvtTable .pvtTotalLabel {
    text-align: right;
    font-weight: bold;
  }

  table.pvtTable .pvtSubtotalLabel {
    font-weight: bold;
  }

  table.pvtTable tbody tr td {
    color: #2a3f5f;
    padding: 5px;
    background-color: #fff;
    border-top: 1px solid #e0e0e0;
    border-left: 1px solid #e0e0e0;
    vertical-align: top;
    text-align: right;
  }

  table.pvtTable tbody tr th.pvtRowLabel {
    vertical-align: baseline;
  }

  .pvtTotal,
  .pvtGrandTotal {
    font-weight: bold;
  }

  table.pvtTable tbody tr td.pvtRowTotal {
    vertical-align: middle;
  }

  .toggle-wrapper {
    white-space: nowrap;
  }

  .toggle-wrapper > .toggle-val {
    white-space: normal;
  }

  .toggle {
    padding-right: 4px;
    cursor: pointer;
  }

  .hoverable:hover {
    background-color: #eceef2;
    cursor: pointer;
  }
`;var L=o(11965);const P=t=>"number"==typeof t||"string"==typeof t?t:String(t);function D(t,e,o,a,r){const s=r[a]||a;return t?(0,L.tZ)("span",{className:"toggle-wrapper"},(0,L.tZ)("span",{role:"button",tabIndex:"0",className:"toggle",onClick:o},e),(0,L.tZ)("span",{className:"toggle-val"},P(s))):P(s)}class q extends a.Component{constructor(t){super(t),this.state={collapsedRows:{},collapsedCols:{}},this.clickHeaderHandler=this.clickHeaderHandler.bind(this),this.clickHandler=this.clickHandler.bind(this)}getBasePivotSettings(){const{props:t}=this,e=t.cols,o=t.rows,a={rowTotals:!0,colTotals:!0,...t.tableOptions},r=a.rowTotals||0===e.length,s=a.colTotals||0===o.length,l=t.namesMapping||{},n={arrowCollapsed:"▲",arrowExpanded:"▼",...t.subtotalOptions},i={displayOnTop:!1,enabled:r,hideOnExpand:!1,...n.colSubtotalDisplay},c={displayOnTop:!1,enabled:s,hideOnExpand:!1,...n.rowSubtotalDisplay},u=new Z(t,{rowEnabled:c.enabled,colEnabled:i.enabled,rowPartialOnTop:c.displayOnTop,colPartialOnTop:i.displayOnTop}),p=u.getRowKeys(),h=u.getColKeys(),d={},g={},m={};let f=null;return a.clickCallback&&(p.forEach((t=>{const e=M(t);e in d||(d[e]={}),h.forEach((o=>{d[e][M(o)]=this.clickHandler(u,t,o)}))})),r&&p.forEach((t=>{g[M(t)]=this.clickHandler(u,t,[])})),s&&h.forEach((t=>{m[M(t)]=this.clickHandler(u,[],t)})),r&&s&&(f=this.clickHandler(u,[],[]))),{pivotData:u,colAttrs:e,rowAttrs:o,colKeys:h,rowKeys:p,rowTotals:r,colTotals:s,arrowCollapsed:n.arrowCollapsed,arrowExpanded:n.arrowExpanded,colSubtotalDisplay:i,rowSubtotalDisplay:c,cellCallbacks:d,rowTotalCallbacks:g,colTotalCallbacks:m,grandTotalCallback:f,namesMapping:l}}clickHandler(t,e,o){const a=this.props.cols,r=this.props.rows,s=t.getAggregator(e,o).value(),l={},n=Math.min(a.length,o.length);for(let t=0;t<n;t+=1){const e=a[t];null!==o[t]&&(l[e]=o[t])}const i=Math.min(r.length,e.length);for(let t=0;t<i;t+=1){const o=r[t];null!==e[t]&&(l[o]=e[t])}return e=>this.props.tableOptions.clickCallback(e,s,l,t)}clickHeaderHandler(t,e,o,a,r,s=!1,l=!1){const n={};for(let t=0;t<=a;t+=1){const a=o[t];n[a]=e[t]}return o=>r(o,e[a],n,t,s,l)}collapseAttr(t,e,o){return a=>{a.stopPropagation();const r=e+1,s=o.filter((t=>t.length===r)).map(M),l={};s.forEach((t=>{l[t]=!0})),t?this.setState((t=>({collapsedRows:{...t.collapsedRows,...l}}))):this.setState((t=>({collapsedCols:{...t.collapsedCols,...l}})))}}expandAttr(t,e,o){return a=>{a.stopPropagation();const r={};o.forEach((t=>{for(let o=0;o<=e;o+=1)r[M(t.slice(0,o+1))]=!1})),t?this.setState((t=>({collapsedRows:{...t.collapsedRows,...r}}))):this.setState((t=>({collapsedCols:{...t.collapsedCols,...r}})))}}toggleRowKey(t){return e=>{e.stopPropagation(),this.setState((e=>({collapsedRows:{...e.collapsedRows,[t]:!e.collapsedRows[t]}})))}}toggleColKey(t){return e=>{e.stopPropagation(),this.setState((e=>({collapsedCols:{...e.collapsedCols,[t]:!e.collapsedCols[t]}})))}}calcAttrSpans(t,e){const o=[],a=Array(e).map((()=>0));let r=Array(e).map((()=>null));for(let e=0;e<t.length;e+=1){const s=t[e],l=[];let n=0;const i=Math.min(r.length,s.length);for(;n<i&&r[n]===s[n];)l.push(-1),o[a[n]][n]+=1,n+=1;for(;n<s.length;)a[n]=e,l.push(1),n+=1;o.push(l),r=s}return o}renderColHeaderRow(t,e,o){const{rowAttrs:a,colAttrs:r,colKeys:s,visibleColKeys:l,colAttrSpans:n,rowTotals:i,arrowExpanded:c,arrowCollapsed:u,colSubtotalDisplay:p,maxColVisible:h,pivotData:d,namesMapping:g}=o,{highlightHeaderCellsOnHover:m,omittedHighlightHeaderGroups:f=[],highlightedHeaderCells:b,dateFormatters:v}=this.props.tableOptions,y=0===e&&0!==a.length?(0,L.tZ)("th",{key:"padding",colSpan:a.length,rowSpan:r.length,"aria-hidden":"true"}):null,w=p.enabled&&e!==r.length-1;let k=null,T=null;w&&(k=e+1<h?this.collapseAttr(!1,e,s):this.expandAttr(!1,e,s),T=e+1<h?c:u);const C=(0,L.tZ)("th",{key:"label",className:"pvtAxisLabel"},D(w,T,k,t,g)),S=[],O=0!==a.length?1:0;let N=0;for(;N<l.length;){const o=l[N],a=e<o.length?n[N][e]:1;let s="pvtColLabel";if(e<o.length){m&&!f.includes(r[e])&&(s+=" hoverable"),b&&Array.isArray(b[r[e]])&&b[r[e]].includes(o[e])&&(s+=" active");const l=1+(e===r.length-1?O:0),n=M(o.slice(0,e+1)),i=w?this.toggleColKey(n):null,p=v&&v[t]&&"function"==typeof v[t]?v[t](o[e]):o[e];S.push((0,L.tZ)("th",{className:s,key:`colKey-${n}`,colSpan:a,rowSpan:l,onClick:this.clickHeaderHandler(d,o,this.props.cols,e,this.props.tableOptions.clickColumnHeaderCallback)},D(w,this.state.collapsedCols[n]?u:c,i,p,g)))}else if(e===o.length){const t=r.length-o.length+O;S.push((0,L.tZ)("th",{className:`${s} pvtSubtotalLabel`,key:`colKeyBuffer-${M(o)}`,colSpan:a,rowSpan:t,onClick:this.clickHeaderHandler(d,o,this.props.cols,e,this.props.tableOptions.clickColumnHeaderCallback,!0)},"Subtotal"))}N+=a}const A=0===e&&i?(0,L.tZ)("th",{key:"total",className:"pvtTotalLabel",rowSpan:r.length+Math.min(a.length,1),onClick:this.clickHeaderHandler(d,[],this.props.cols,e,this.props.tableOptions.clickColumnHeaderCallback,!1,!0)},`Total (${this.props.aggregatorName})`):null,x=[y,C,...S,A];return(0,L.tZ)("tr",{key:`colAttr-${e}`},x)}renderRowHeaderRow(t){const{rowAttrs:e,colAttrs:o,rowKeys:a,arrowCollapsed:r,arrowExpanded:s,rowSubtotalDisplay:l,maxRowVisible:n,pivotData:i,namesMapping:c}=t;return(0,L.tZ)("tr",{key:"rowHdr"},e.map(((t,o)=>{const i=l.enabled&&o!==e.length-1;let u=null,p=null;return i&&(u=o+1<n?this.collapseAttr(!0,o,a):this.expandAttr(!0,o,a),p=o+1<n?s:r),(0,L.tZ)("th",{className:"pvtAxisLabel",key:`rowAttr-${o}`},D(i,p,u,t,c))})),(0,L.tZ)("th",{className:"pvtTotalLabel",key:"padding",onClick:this.clickHeaderHandler(i,[],this.props.rows,0,this.props.tableOptions.clickRowHeaderCallback,!1,!0)},0===o.length?`Total (${this.props.aggregatorName})`:null))}renderTableRow(t,e,o){const{rowAttrs:a,colAttrs:r,rowAttrSpans:s,visibleColKeys:l,pivotData:n,rowTotals:i,rowSubtotalDisplay:c,arrowExpanded:u,arrowCollapsed:p,cellCallbacks:h,rowTotalCallbacks:d,namesMapping:g}=o,{highlightHeaderCellsOnHover:m,omittedHighlightHeaderGroups:f=[],highlightedHeaderCells:b,cellColorFormatters:v,dateFormatters:y}=this.props.tableOptions,w=M(t),k=0!==r.length?1:0,T=t.map(((o,r)=>{let l="pvtRowLabel";m&&!f.includes(a[r])&&(l+=" hoverable"),b&&Array.isArray(b[a[r]])&&b[a[r]].includes(o)&&(l+=" active");const i=s[e][r];if(i>0){const e=M(t.slice(0,r+1)),s=1+(r===a.length-1?k:0),h=c.enabled&&r!==a.length-1,d=h?this.toggleRowKey(e):null,m=y&&y[a[r]]?y[a[r]](o):o;return(0,L.tZ)("th",{key:`rowKeyLabel-${r}`,className:l,rowSpan:i,colSpan:s,onClick:this.clickHeaderHandler(n,t,this.props.rows,r,this.props.tableOptions.clickRowHeaderCallback)},D(h,this.state.collapsedRows[e]?p:u,d,m,g))}return null})),C=t.length<a.length?(0,L.tZ)("th",{className:"pvtRowLabel pvtSubtotalLabel",key:"rowKeyBuffer",colSpan:a.length-t.length+k,rowSpan:1,onClick:this.clickHeaderHandler(n,t,this.props.rows,t.length,this.props.tableOptions.clickRowHeaderCallback,!0)},"Subtotal"):null,S=h[w]||{},O=l.map((e=>{const o=M(e),a=n.getAggregator(t,e),r=a.value(),s=[...t,...e];let l;v&&Object.values(v).forEach((t=>{Array.isArray(t)&&s.forEach((e=>{l||t.filter((t=>t.column===e)).forEach((t=>{const e=t.getColorFromValue(r);e&&(l=e)}))}))}));const i=a.isSubtotal?{fontWeight:"bold"}:{backgroundColor:l};return(0,L.tZ)("td",{role:"gridcell",className:"pvtVal",key:`pvtVal-${o}`,onClick:S[o],style:i},a.format(r))}));let N=null;if(i){const e=n.getAggregator(t,[]),o=e.value();N=(0,L.tZ)("td",{role:"gridcell",key:"total",className:"pvtTotal",onClick:d[w]},e.format(o))}const A=[...T,C,...O,N];return(0,L.tZ)("tr",{key:`keyRow-${w}`},A)}renderTotalsRow(t){const{rowAttrs:e,colAttrs:o,visibleColKeys:a,rowTotals:r,pivotData:s,colTotalCallbacks:l,grandTotalCallback:n}=t,i=(0,L.tZ)("th",{key:"label",className:"pvtTotalLabel pvtRowTotalLabel",colSpan:e.length+Math.min(o.length,1),onClick:this.clickHeaderHandler(s,[],this.props.rows,0,this.props.tableOptions.clickRowHeaderCallback,!1,!0)},`Total (${this.props.aggregatorName})`),c=a.map((t=>{const e=M(t),o=s.getAggregator([],t),a=o.value();return(0,L.tZ)("td",{role:"gridcell",className:"pvtTotal pvtRowTotal",key:`total-${e}`,onClick:l[e],style:{padding:"5px"}},o.format(a))}));let u=null;if(r){const t=s.getAggregator([],[]),e=t.value();u=(0,L.tZ)("td",{role:"gridcell",key:"total",className:"pvtGrandTotal pvtRowTotal",onClick:n},t.format(e))}const p=[i,...c,u];return(0,L.tZ)("tr",{key:"total",className:"pvtRowTotals"},p)}visibleKeys(t,e,o,a){return t.filter((t=>!t.some(((o,a)=>e[M(t.slice(0,a))]))&&(t.length===o||M(t)in e||!a.hideOnExpand)))}render(){this.cachedProps!==this.props&&(this.cachedProps=this.props,this.cachedBasePivotSettings=this.getBasePivotSettings());const{colAttrs:t,rowAttrs:e,rowKeys:o,colKeys:a,colTotals:r,rowSubtotalDisplay:s,colSubtotalDisplay:l}=this.cachedBasePivotSettings,n=this.visibleKeys(o,this.state.collapsedRows,e.length,s),i=this.visibleKeys(a,this.state.collapsedCols,t.length,l),c={visibleRowKeys:n,maxRowVisible:Math.max(...n.map((t=>t.length))),visibleColKeys:i,maxColVisible:Math.max(...i.map((t=>t.length))),rowAttrSpans:this.calcAttrSpans(n,e.length),colAttrSpans:this.calcAttrSpans(i,t.length),...this.cachedBasePivotSettings};return(0,L.tZ)(E,null,(0,L.tZ)("table",{className:"pvtTable",role:"grid"},(0,L.tZ)("thead",null,t.map(((t,e)=>this.renderColHeaderRow(t,e,c))),0!==e.length&&this.renderRowHeaderRow(c)),(0,L.tZ)("tbody",null,n.map(((t,e)=>this.renderTableRow(t,e,c))),r&&this.renderTotalsRow(c))))}}q.propTypes={...Z.propTypes,tableOptions:b().object},q.defaultProps={...Z.defaultProps,tableOptions:{}};class z extends a.PureComponent{render(){return(0,L.tZ)(q,this.props)}}z.propTypes=Z.propTypes,z.defaultProps=Z.defaultProps;const $=z;var j=o(86769);const V=p.iK.div`
  ${({height:t,width:e,margin:o})=>`\n      margin: ${o}px;\n      height: ${t-2*o}px;\n      width: ${"string"==typeof e?parseInt(e,10):e-2*o}px;\n `}
`,I=p.iK.div`
  height: 100%;
  max-width: fit-content;
  overflow: auto;
`,U="metric",B={stroke:"black",strokeWidth:"16px"},G=["value"],W=t=>({Count:F.count(t),"Count Unique Values":F.countUnique(t),"List Unique Values":F.listUnique(", ",t),Sum:F.sum(t),Average:F.average(t),Median:F.median(t),"Sample Variance":F.var(1,t),"Sample Standard Deviation":F.stdev(1,t),Minimum:F.min(t),Maximum:F.max(t),First:F.first(t),Last:F.last(t),"Sum as Fraction of Total":F.fractionOf(F.sum(),"total",t),"Sum as Fraction of Rows":F.fractionOf(F.sum(),"row",t),"Sum as Fraction of Columns":F.fractionOf(F.sum(),"col",t),"Count as Fraction of Total":F.fractionOf(F.count(),"total",t),"Count as Fraction of Rows":F.fractionOf(F.count(),"row",t),"Count as Fraction of Columns":F.fractionOf(F.count(),"col",t)});function J(t){const{data:e,height:o,width:r,groupbyRows:s,groupbyColumns:l,metrics:i,colOrder:c,rowOrder:f,aggregateFunction:b,transposePivot:v,combineMetric:y,rowSubtotalPosition:w,colSubtotalPosition:k,colTotals:T,rowTotals:C,valueFormat:O,emitFilter:N,setDataMask:A,selectedFilters:x,verboseMap:H,columnFormats:R,metricsLayout:F,metricColorFormatters:_,dateFormatters:K}=t,M=(0,p.Fg)(),Z=(0,a.useMemo)((()=>(0,h.JB)(O)),[O]),E=(0,a.useMemo)((()=>Object.entries(R)),[R]),P=E.length>0,D=(0,a.useMemo)((()=>P?{[U]:Object.fromEntries(E.map((([t,e])=>[t,(0,h.JB)(e)])))}:void 0),[E,P]),q=(0,a.useMemo)((()=>i.map((t=>"string"==typeof t?t:t.label))),[i]),z=(0,a.useMemo)((()=>e.reduce(((t,e)=>[...t,...q.map((t=>({...e,[U]:t,value:e[t]}))).filter((t=>null!==t.value))]),[])),[e,q]),J=(0,a.useMemo)((()=>s.map(d.Z)),[s]),Q=(0,a.useMemo)((()=>l.map(d.Z)),[l]),X=(0,a.useMemo)((()=>({[U]:S(q)})),[q]),[Y,tt]=(0,a.useMemo)((()=>{let[t,e]=v?[Q,J]:[J,Q];return F===j.Q.ROWS?t=y?[...t,U]:[U,...t]:e=y?[...e,U]:[U,...e],[t,e]}),[y,Q,J,F,v]),et=(0,a.useCallback)((t=>{const e=Object.keys(t),o=[...s,...l];A({extraFormData:{filters:0===e.length?void 0:e.map((e=>{var a;const r=null==t?void 0:t[e],s=null!=(a=o.find((t=>(0,g.s9)(t)?t===e:!!(0,m.GA)(t)&&t.label===e)))?a:"";return null==r?{col:s,op:"IS NULL"}:{col:s,op:"IN",val:r}}))},filterState:{value:t&&Object.keys(t).length?Object.values(t):null,selectedFilters:t&&Object.keys(t).length?t:null}})}),[l,s,A]),ot=(0,a.useCallback)(((t,e,o,a,r,s)=>{if(r||s||!N)return;const l={...o};delete l.metric;const n=Object.entries(l);if(0===n.length)return;const[i,c]=n[n.length-1];let u={...x||{}};u=x&&((t,e)=>{var o;return!!x&&(null==(o=x[t])?void 0:o.includes(e))})(i,c)?{}:{[i]:[c]},Array.isArray(u[i])&&0===u[i].length&&delete u[i],et(u)}),[N,x,et]),at=(0,a.useMemo)((()=>({clickRowHeaderCallback:ot,clickColumnHeaderCallback:ot,colTotals:T,rowTotals:C,highlightHeaderCellsOnHover:N,highlightedHeaderCells:x,omittedHighlightHeaderGroups:[U],cellColorFormatters:{[U]:_},dateFormatters:K})),[T,K,N,_,C,x,ot]),rt=(0,a.useMemo)((()=>({colSubtotalDisplay:{displayOnTop:k},rowSubtotalDisplay:{displayOnTop:w},arrowCollapsed:(0,L.tZ)(n,{style:B}),arrowExpanded:(0,L.tZ)(u,{style:B})})),[k,w]);return(0,L.tZ)(V,{height:o,width:r,margin:4*M.gridUnit},(0,L.tZ)(I,null,(0,L.tZ)($,{data:z,rows:Y,cols:tt,aggregatorsFactory:W,defaultFormatter:Z,customFormatters:D,aggregatorName:b,vals:G,colOrder:c,rowOrder:f,sorters:X,tableOptions:at,subtotalOptions:rt,namesMapping:H})))}}}]);