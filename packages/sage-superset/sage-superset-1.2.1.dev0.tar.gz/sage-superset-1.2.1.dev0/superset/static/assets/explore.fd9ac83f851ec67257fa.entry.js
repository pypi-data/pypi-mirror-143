(()=>{var e,t,a,r,o,n,s,i={12361:(e,t,a)=>{"use strict";var r={};a.r(r),a.d(r,{FETCH_DASHBOARDS_FAILED:()=>k,FETCH_DASHBOARDS_SUCCEEDED:()=>A,REMOVE_SAVE_MODAL_ALERT:()=>F,SAVE_SLICE_FAILED:()=>$,SAVE_SLICE_SUCCESS:()=>L,fetchDashboards:()=>j,fetchDashboardsFailed:()=>M,fetchDashboardsSucceeded:()=>D,removeSaveModalAlert:()=>z,saveSlice:()=>V,saveSliceFailed:()=>P,saveSliceSuccess:()=>U});var o=a(67294),n=a(90731),s=a(14890),i=a(53894),l=a(14670),c=a.n(l),d=a(31069),u=a(9679),h=a(97381),p=a(3741),f=a(23279),m=a.n(f);const b=new class{constructor({callback:e=(()=>{}),sizeThreshold:t=1e3,delayThreshold:a=1e3}){this.queue=[],this.sizeThreshold=t,this.delayThrehold=a,this.trigger=m()(this.trigger.bind(this),this.delayThrehold),this.callback=e}append(e){this.queue.push(e),this.trigger()}trigger(){if(this.queue.length>0){const e=this.queue.splice(0,this.sizeThreshold);this.callback.call(null,e),this.queue.length>0&&this.trigger()}}}({callback:e=>{if(e.length<=0)return;let t="/superset/log/?explode=events";const{source:a,source_id:r}=e[0];if("dashboard"===a?t+=`&dashboard_id=${r}`:"slice"===a&&(t+=`&slice_id=${r}`),navigator.sendBeacon){const a=new FormData;a.append("events",(0,u.o)(e)),navigator.sendBeacon(t,a)}else d.Z.post({endpoint:t,postPayload:{events:e},parseMethod:null})},sizeThreshold:1024,delayThreshold:1e3});let g=0;var v=a(91877),y=a(99543),_=a(72570),S=a(8818);function Z(e=[]){const t=[];return e.forEach((([e,a])=>{const r="danger"===e?S.p.DANGER:"success"===e&&S.p.SUCCESS||S.p.INFO,o=(0,_.fz)({text:a,toastType:r}).payload;t.push(o)})),t}var w,E=a(12515),C=a(35854),T=a(36967);function O(e,t){return function(e,t){try{const a=localStorage.getItem(e);return null===a?t:JSON.parse(a)}catch{return t}}(e,t)}function x(e,t){!function(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}(e,t)}!function(e){e.filter_box_transition_snoozed_at="filter_box_transition_snoozed_at",e.chart_split_sizes="chart_split_sizes",e.controls_width="controls_width",e.datasource_width="datasource_width",e.is_datapanel_open="is_datapanel_open",e.homepage_chart_filter="homepage_chart_filter",e.homepage_dashboard_filter="homepage_dashboard_filter",e.homepage_collapse_state="homepage_collapse_state",e.homepage_activity_filter="homepage_activity_filter",e.sqllab__is_autocomplete_enabled="sqllab__is_autocomplete_enabled",e.explore__data_table_time_formatted_columns="explore__data_table_time_formatted_columns"}(w||(w={}));var R=a(61358),N=a(37863),I=a(8868);const A="FETCH_DASHBOARDS_SUCCEEDED";function D(e){return{type:A,choices:e}}const k="FETCH_DASHBOARDS_FAILED";function M(e){return{type:k,userId:e}}function j(e){return function(t){return d.Z.get({endpoint:`/dashboardasync/api/read?_flt_0_owners=${e}`}).then((({json:e})=>{const a=e.pks.map(((t,a)=>({value:t,label:(e.result[a]||{}).dashboard_title})));return t(D(a))})).catch((()=>t(M(e))))}}const $="SAVE_SLICE_FAILED";function P(){return{type:$}}const L="SAVE_SLICE_SUCCESS";function U(e){return{type:L,data:e}}const F="REMOVE_SAVE_MODAL_ALERT";function z(){return{type:F}}function V(e,t){return a=>{const r=(0,E.H6)({formData:e,endpointType:"base",force:!1,curUrl:null,requestParams:t}),o=(0,E.u)({formData:e,force:!1,resultFormat:"json",resultType:"full"});return d.Z.post({url:r,postPayload:{form_data:e,query_context:o}}).then((e=>(a(U(e.json)),e.json))).catch((()=>a(P())))}}var q=a(55786),H=a(52256),B=a(69856),K=a(651);const W=(0,s.UY)({charts:N.Z,saveModal:function(e={},t){const a={[A]:()=>({...e,dashboards:t.choices}),[k]:()=>({...e,saveModalAlert:`fetching dashboards failed for ${t.userId}`}),[$]:()=>({...e,saveModalAlert:"Failed to save slice"}),[L]:t=>({...e,data:t}),[F]:()=>({...e,saveModalAlert:null})};return t.type in a?a[t.type]():e},dataMask:I.Z,explore:function(e={},t){const a={[H.DYNAMIC_PLUGIN_CONTROLS_READY]:()=>({...e,controls:t.controlsState}),[K.TOGGLE_FAVE_STAR]:()=>({...e,isStarred:t.isStarred}),[K.POST_DATASOURCE_STARTED]:()=>({...e,isDatasourceMetaLoading:!0}),[K.SET_DATASOURCE](){const a={...e.form_data};t.datasource.type!==e.datasource.type&&("table"===t.datasource.type?(a.granularity_sqla=t.datasource.granularity_sqla,a.time_grain_sqla=t.datasource.time_grain_sqla,delete a.druid_time_origin,delete a.granularity):(a.druid_time_origin=t.datasource.druid_time_origin,a.granularity=t.datasource.granularity,delete a.granularity_sqla,delete a.time_grain_sqla));const r={...e.controls},o=[];t.datasource.id===e.datasource.id&&t.datasource.type===e.datasource.type||(a.time_range=B.X5,Object.entries(r).forEach((([e,n])=>{("column_name"===n.valueKey||"savedMetrics"in n||"columns"in n||"options"in n&&!Array.isArray(n.options))&&(r[e]={...n},a[e]=(0,T.YY)(t.datasource,n,n.value),(0,q.Z)(a[e]).length>0&&a[e]!==r[e].default&&o.push(e))})));const n={...e,controls:r,datasource:t.datasource,datasource_id:t.datasource.id,datasource_type:t.datasource.type};return{...n,form_data:a,controls:(0,C.R3)(n,a),controlsTransferred:o}},[K.FETCH_DATASOURCES_STARTED]:()=>({...e,isDatasourcesLoading:!0}),[K.SET_DATASOURCES]:()=>({...e,datasources:t.datasources}),[K.SET_FIELD_VALUE](){const a=e.form_data,{controlName:r,value:o,validationErrors:n}=t;a[r]=o;const s=a.viz_type,i=e.controls[t.controlName]||(0,T.Bx)(t.controlName,s)||{},l={...(0,T.vP)(i,e,t.value)},c={...e,controls:{...e.controls,[t.controlName]:l}},d={};Array.isArray(l.rerender)&&l.rerender.forEach((e=>{d[e]={...(0,T.vP)(c.controls[e],c,c.controls[e].value)}}));const u=l.validationErrors||[];(n||[]).forEach((e=>{u.includes(e)||u.push(e)}));const h=u&&u.length>0,p="viz_type"===t.controlName&&t.value!==e.controls.viz_type.value?(0,C.R3)(e,(0,T.Hu)({...e.controls,viz_type:l})):e.controls;return{...e,form_data:a,triggerRender:l.renderTrigger&&!h,controls:{...p,[t.controlName]:{...l,validationErrors:u},...d}}},[K.SET_EXPLORE_CONTROLS]:()=>({...e,controls:(0,C.R3)(e,t.formData)}),[K.UPDATE_CHART_TITLE]:()=>({...e,sliceName:t.sliceName}),[K.CREATE_NEW_SLICE]:()=>({...e,slice:t.slice,controls:(0,C.R3)(e,t.form_data),can_add:t.can_add,can_download:t.can_download,can_overwrite:t.can_overwrite}),[K.SLICE_UPDATED](){var a,r;return{...e,slice:{...e.slice,...t.slice,owners:null!=(a=t.slice.owners)?a:null},sliceName:null!=(r=t.slice.slice_name)?r:e.sliceName}},[K.SET_TIME_FORMATTED_COLUMN](){const{datasourceId:a,columnName:r}=t,o={...e.timeFormattedColumns},n=(0,q.Z)(o[a]).slice();return n.push(r),o[a]=n,x(w.explore__data_table_time_formatted_columns,o),{...e,timeFormattedColumns:o}},[K.UNSET_TIME_FORMATTED_COLUMN](){const{datasourceId:a,columnIndex:r}=t,o={...e.timeFormattedColumns},n=(0,q.Z)(o[a]).slice();return n.splice(r,1),o[a]=n,0===n.length&&delete o[a],x(w.explore__data_table_time_formatted_columns,o),{...e,timeFormattedColumns:o}}};return t.type in a?a[t.type]():e},impressionId:(e="")=>e,messageToasts:function(e=[],t){switch(t.type){case _.h:{const{payload:a}=t,r=e.slice();return a.noDuplicate&&r.find((e=>e.text===a.text))?e:[a,...e]}case _.K7:{const{payload:{id:a}}=t;return[...e].filter((e=>e.id!==a))}default:return e}},reports:function(e={},t){const a={[R.jt]:()=>({...t.report.result.reduce(((e,t)=>({...e,[t.id]:t})),{})}),[R.J8](){const a=t.json.result;return a.id=t.json.id,{...e,[t.json.id]:a}},[R.Dr](){const a=t.json.result;return a.id=t.json.id,{...e,[t.json.id]:a}}};return t.type in a?a[t.type]():e}});var Q=a(37703),G=a(38626),J=a(57865),Y=a(68135),X=a(14278),ee=a(51995),te=a(11965),ae=a(94184),re=a.n(ae),oe=a(13423),ne=a(70163);const se=ee.iK.div`
  display: flex;
  justify-content: center;
  align-items: center;

  span {
    padding: 0 11px;
  }
`,ie=e=>te.iv`
  min-width: ${5*e.gridUnit}px;
  color: ${e.colors.grayscale.base};
`;function le({toast:e,onCloseToast:t}){const a=(0,o.useRef)(),[r,n]=(0,o.useState)(!1),s=()=>{n(!0)},i=(0,o.useCallback)((()=>{a.current&&clearTimeout(a.current),n((()=>(setTimeout((()=>{t(e.id)}),150),!1)))}),[t,e.id]);(0,o.useEffect)((()=>(setTimeout(s),e.duration>0&&(a.current=setTimeout(i,e.duration)),()=>{a.current&&clearTimeout(a.current)})),[i,e.duration]);let l="toast--success",c=(0,te.tZ)(ne.Z.CircleCheckSolid,{css:e=>ie(e)});return e.toastType===S.p.WARNING?(c=(0,te.tZ)(ne.Z.WarningSolid,{css:ie}),l="toast--warning"):e.toastType===S.p.DANGER?(c=(0,te.tZ)(ne.Z.ErrorSolid,{css:ie}),l="toast--danger"):e.toastType===S.p.INFO&&(c=(0,te.tZ)(ne.Z.InfoSolid,{css:ie}),l="toast--info"),(0,te.tZ)(se,{className:re()("alert","toast",r&&"toast--visible",l),role:"alert"},c,(0,te.tZ)(oe.ZP,{content:e.text}),(0,te.tZ)("i",{className:"fa fa-close pull-right pointer",role:"button",tabIndex:0,onClick:i,"aria-label":"Close"}))}const ce=ee.iK.div`
  max-width: 600px;
  position: fixed;
  bottom: 0px;
  right: 0px;
  margin-right: 50px;
  margin-bottom: 50px;
  z-index: ${({theme:e})=>e.zIndex.max};
  word-break: break-word;

  .toast {
    background: ${({theme:e})=>e.colors.grayscale.dark1};
    border-radius: ${({theme:e})=>e.borderRadius};
    box-shadow: 0 2px 4px 0
      fade(
        ${({theme:e})=>e.colors.grayscale.dark2},
        ${({theme:e})=>e.opacity.mediumLight}
      );
    color: ${({theme:e})=>e.colors.grayscale.light5};
    opacity: 0;
    position: relative;
    transform: translateY(-100%);
    white-space: pre-line;
    will-change: transform, opacity;
    transition: transform ${({theme:e})=>e.transitionTiming}s,
      opacity ${({theme:e})=>e.transitionTiming}s;

    &:after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 6px;
      height: 100%;
    }
  }

  .toast > button {
    color: ${({theme:e})=>e.colors.grayscale.light5};
    opacity: 1;
  }

  .toast--visible {
    opacity: 1;
    transform: translateY(0);
  }
`,de=(0,Q.$j)((({messageToasts:e})=>({toasts:e})),(e=>(0,s.DE)({removeToast:_.RS},e)))((function({toasts:e,removeToast:t}){return e.length>0&&(0,te.tZ)(ce,{id:"toast-presenter"},e.map((e=>(0,te.tZ)(le,{key:e.id,toast:e,onCloseToast:t}))))}));var ue=a(19755),he=a.n(ue),pe=a(98286),fe=a(92869),me=a(67663),be=a(61988);function ge({code:e,message:t}){return(0,te.tZ)(o.Fragment,null,t," ",(0,te.tZ)("a",{href:`https://superset.apache.org/docs/miscellaneous/issue-codes#issue-${e}`,rel:"noopener noreferrer",target:"_blank"},(0,te.tZ)("i",{className:"fa fa-external-link"})))}var ve=a(91178);const ye=function({error:e,source:t}){const{extra:a,level:r}=e,n=["dashboard","explore"].includes(t),s=n?(0,be.tn)("We’re having trouble loading this visualization. Queries are set to timeout after %s second.","We’re having trouble loading this visualization. Queries are set to timeout after %s seconds.",a.timeout,a.timeout):(0,be.tn)("We’re having trouble loading these results. Queries are set to timeout after %s second.","We’re having trouble loading these results. Queries are set to timeout after %s seconds.",a.timeout,a.timeout),i=(0,te.tZ)(o.Fragment,null,(0,te.tZ)("p",null,(0,be.t)("This may be triggered by:"),(0,te.tZ)("br",null),a.issue_codes.map((e=>(0,te.tZ)(ge,e))).reduce(((e,t)=>[e,(0,te.tZ)("br",null),t]))),n&&a.owners&&(0,te.tZ)(o.Fragment,null,(0,te.tZ)("br",null),(0,te.tZ)("p",null,(0,be.tn)("Please reach out to the Chart Owner for assistance.","Please reach out to the Chart Owners for assistance.",a.owners.length)),(0,te.tZ)("p",null,(0,be.tn)("Chart Owner: %s","Chart Owners: %s",a.owners.length,a.owners.join(", "))))),l=(0,be.t)("%(subtitle)s\nThis may be triggered by:\n %(issue)s",{subtitle:s,issue:a.issue_codes.map((e=>e.message)).join("\n")});return(0,te.tZ)(ve.Z,{title:(0,be.t)("Timeout error"),subtitle:s,level:r,source:t,copyText:l,body:i})};var _e=a(5872),Se=a.n(_e);const Ze=function({error:e,source:t="dashboard",subtitle:a}){const{extra:r,level:n,message:s}=e,i=["dashboard","explore"].includes(t),l=r&&(0,te.tZ)(o.Fragment,null,(0,te.tZ)("p",null,(0,be.t)("This may be triggered by:"),(0,te.tZ)("br",null),r.issue_codes.map((e=>(0,te.tZ)(ge,Se()({},e,{key:e.code})))).reduce(((e,t)=>[e,(0,te.tZ)("br",null),t]))),i&&r.owners&&(0,te.tZ)(o.Fragment,null,(0,te.tZ)("br",null),(0,te.tZ)("p",null,(0,be.tn)("Please reach out to the Chart Owner for assistance.","Please reach out to the Chart Owners for assistance.",r.owners.length)),(0,te.tZ)("p",null,(0,be.tn)("Chart Owner: %s","Chart Owners: %s",r.owners.length,r.owners.join(", "))))),c=r&&r.issue_codes?(0,be.t)("%(message)s\nThis may be triggered by: \n%(issues)s",{message:s,issues:r.issue_codes.map((e=>e.message)).join("\n")}):s;return(0,te.tZ)(ve.Z,{title:(0,be.t)("%s Error",r&&r.engine_name||(0,be.t)("DB engine")),subtitle:a,level:n,source:t,copyText:c,body:l})};var we=a(39991),Ee=a.n(we);const Ce=function({error:e,source:t="sqllab",subtitle:a}){const{extra:r={issue_codes:[]},level:n,message:s}=e,i=(0,be.tn)("This was triggered by:","This may be triggered by:",r.issue_codes.length),l=((e,t)=>{const a={};return e.forEach((e=>{t.forEach((t=>{Ee()(e,t)<=2&&(a[e]||(a[e]=[]),a[e].push(`"${t}"`))}))})),a})(r.undefined_parameters||[],Object.keys(r.template_parameters||{})),c=(0,te.tZ)(o.Fragment,null,(0,te.tZ)("p",null,Object.keys(l).length>0&&(0,te.tZ)(o.Fragment,null,(0,te.tZ)("p",null,(0,be.t)("Did you mean:")),(0,te.tZ)("ul",null,Object.entries(l).map((([e,t])=>(0,te.tZ)("li",null,(0,be.tn)('%(suggestion)s instead of "%(undefinedParameter)s?"','%(firstSuggestions)s or %(lastSuggestion)s instead of "%(undefinedParameter)s"?',t.length,{suggestion:t.join(", "),firstSuggestions:t.slice(0,-1).join(", "),lastSuggestion:t[t.length-1],undefinedParameter:e}))))),(0,te.tZ)("br",null)),i,(0,te.tZ)("br",null),r.issue_codes.length>0&&r.issue_codes.map((e=>(0,te.tZ)(ge,e))).reduce(((e,t)=>[e,(0,te.tZ)("br",null),t])))),d=`${s}\n${i}\n${r.issue_codes.map((e=>e.message)).join("\n")}`;return(0,te.tZ)(ve.Z,{title:(0,be.t)("Parameter error"),subtitle:a,level:n,source:t,copyText:d,body:c})},Te=function({error:e,source:t="dashboard",subtitle:a}){const{level:r,message:o}=e;return(0,te.tZ)(ve.Z,{title:(0,be.t)("Missing dataset"),subtitle:a,level:r,source:t,copyText:o,body:null})};var Oe=a(1629),xe=a(85156),Re=a(45697),Ne=a.n(Re),Ie=a(68492),Ae=a(29119),De=a(28615),ke=a(58593),Me=a(60812),je=a(33626),$e=a(27600),Pe=a(23525),Le=a(50810),Ue=a(2275),Fe=a(1510),ze=a(40219),Ve=a(6954),qe=a(40323),He=a(91296),Be=a.n(He),Ke=a(93096),We=a.n(Ke),Qe=function(e,t){return Qe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},Qe(e,t)};var Ge=function(){return Ge=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ge.apply(this,arguments)};var Je=function(e,t,a,r){switch(t){case"debounce":return Be()(e,a,r);case"throttle":return We()(e,a,r);default:return e}},Ye=function(e){return"function"==typeof e},Xe=function(){return"undefined"==typeof window},et=function(e){return e instanceof Element||e instanceof HTMLDocument},tt=function(e,t,a,r){return function(o){var n=o.width,s=o.height;t((function(t){return t.width===n&&t.height===s||t.width===n&&!r||t.height===s&&!a?t:(e&&Ye(e)&&e(n,s),{width:n,height:s})}))}};!function(e){function t(t){var a=e.call(this,t)||this;a.cancelHandler=function(){a.resizeHandler&&a.resizeHandler.cancel&&(a.resizeHandler.cancel(),a.resizeHandler=null)},a.attachObserver=function(){var e=a.props,t=e.targetRef,r=e.observerOptions;if(!Xe()){t&&t.current&&(a.targetRef.current=t.current);var o=a.getElement();o&&(a.observableElement&&a.observableElement===o||(a.observableElement=o,a.resizeObserver.observe(o,r)))}},a.getElement=function(){var e=a.props,t=e.querySelector,r=e.targetDomEl;if(Xe())return null;if(t)return document.querySelector(t);if(r&&et(r))return r;if(a.targetRef&&et(a.targetRef.current))return a.targetRef.current;var o=(0,n.findDOMNode)(a);if(!o)return null;switch(a.getRenderType()){case"renderProp":case"childFunction":case"child":case"childArray":return o;default:return o.parentElement}},a.createResizeHandler=function(e){var t=a.props,r=t.handleWidth,o=void 0===r||r,n=t.handleHeight,s=void 0===n||n,i=t.onResize;if(o||s){var l=tt(i,a.setState.bind(a),o,s);e.forEach((function(e){var t=e&&e.contentRect||{},r=t.width,o=t.height;!a.skipOnMount&&!Xe()&&l({width:r,height:o}),a.skipOnMount=!1}))}},a.getRenderType=function(){var e=a.props,t=e.render,r=e.children;return Ye(t)?"renderProp":Ye(r)?"childFunction":(0,o.isValidElement)(r)?"child":Array.isArray(r)?"childArray":"parent"};var r=t.skipOnMount,s=t.refreshMode,i=t.refreshRate,l=void 0===i?1e3:i,c=t.refreshOptions;return a.state={width:void 0,height:void 0},a.skipOnMount=r,a.targetRef=(0,o.createRef)(),a.observableElement=null,Xe()||(a.resizeHandler=Je(a.createResizeHandler,s,l,c),a.resizeObserver=new window.ResizeObserver(a.resizeHandler)),a}(function(e,t){function a(){this.constructor=e}Qe(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)})(t,e),t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver()},t.prototype.componentWillUnmount=function(){Xe()||(this.resizeObserver.disconnect(),this.cancelHandler())},t.prototype.render=function(){var e,t=this.props,a=t.render,r=t.children,n=t.nodeType,s=void 0===n?"div":n,i=this.state,l={width:i.width,height:i.height,targetRef:this.targetRef};switch(this.getRenderType()){case"renderProp":return a&&a(l);case"childFunction":return(e=r)(l);case"child":if((e=r).type&&"string"==typeof e.type){var c=function(e,t){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(a[r[o]]=e[r[o]])}return a}(l,["targetRef"]);return(0,o.cloneElement)(e,c)}return(0,o.cloneElement)(e,l);case"childArray":return(e=r).map((function(e){return!!e&&(0,o.cloneElement)(e,l)}));default:return o.createElement(s,null)}}}(o.PureComponent);var at=Xe()?o.useEffect:o.useLayoutEffect;function rt(e){void 0===e&&(e={});var t=e.skipOnMount,a=void 0!==t&&t,r=e.refreshMode,n=e.refreshRate,s=void 0===n?1e3:n,i=e.refreshOptions,l=e.handleWidth,c=void 0===l||l,d=e.handleHeight,u=void 0===d||d,h=e.targetRef,p=e.observerOptions,f=e.onResize,m=(0,o.useRef)(a),b=(0,o.useRef)(null),g=null!=h?h:b,v=(0,o.useRef)(),y=(0,o.useState)({width:void 0,height:void 0}),_=y[0],S=y[1];return at((function(){if(!Xe()){var e=tt(f,S,c,u);v.current=Je((function(t){(c||u)&&t.forEach((function(t){var a=t&&t.contentRect||{},r=a.width,o=a.height;!m.current&&!Xe()&&e({width:r,height:o}),m.current=!1}))}),r,s,i);var t=new window.ResizeObserver(v.current);return g.current&&t.observe(g.current,p),function(){t.disconnect();var e=v.current;e&&e.cancel&&e.cancel()}}}),[r,s,i,c,u,f,p,g.current]),Ge({ref:g},_)}var ot=a(18239),nt=a(28062),st=a(97860),it=a(93185),lt=a(48600),ct=a(38270),dt=a(41609),ut=a.n(dt),ht=a(18446),pt=a.n(ht),ft=a(88306),mt=a.n(ft),bt=a(37687),gt=a(92252);const vt=mt()(((e,t)=>{const a={};return((null==t?void 0:t.controlPanelSections)||[]).forEach((e=>{e.controlSetRows.forEach((e=>{e.forEach((e=>{e&&("string"==typeof e?a[e]=gt.ai[e]:e.name&&e.config&&(a[e.name]=e.config))}))}))})),a}));var yt=a(68073),_t=a(76962);const St={origFormData:Ne().object.isRequired,currentFormData:Ne().object.isRequired};function Zt(e){if(null==e||""===e)return null;if("object"==typeof e){if(Array.isArray(e)&&0===e.length)return null;const t=Object.keys(e);if(t&&0===t.length)return null}return e}class wt extends o.Component{constructor(e){super(e);const t=this.getDiffs(e),a=(e=>{const t=(0,bt.Z)().get(e);return vt(e,t)})(this.props.origFormData.viz_type),r=this.getRowsFromDiffs(t,a);this.state={rows:r,hasDiffs:!ut()(t),controlsMap:a}}UNSAFE_componentWillReceiveProps(e){if(pt()(this.props,e))return;const t=this.getDiffs(e);this.setState((e=>({rows:this.getRowsFromDiffs(t,e.controlsMap),hasDiffs:!ut()(t)})))}getRowsFromDiffs(e,t){return Object.entries(e).map((([e,a])=>({control:t[e]&&t[e].label||e,before:this.formatValue(a.before,e,t),after:this.formatValue(a.after,e,t)})))}getDiffs(e){const t=e.origFormData,a=e.currentFormData,r=Object.keys(a),o={};return r.forEach((e=>{(t[e]||a[e])&&(["filters","having","having_filters","where"].includes(e)||this.isEqualish(t[e],a[e])||(o[e]={before:t[e],after:a[e]}))})),o}isEqualish(e,t){return pt()(Zt(e),Zt(t))}formatValue(e,t,a){var r,o,n,s;if(void 0===e)return"N/A";if(null===e)return"null";if("AdhocFilterControl"===(null==(r=a[t])?void 0:r.type))return e.length?e.map((e=>{const t=e.comparator&&e.comparator.constructor===Array?`[${e.comparator.join(", ")}]`:e.comparator;return`${e.subject} ${e.operator} ${t}`})).join(", "):"[]";if("BoundsControl"===(null==(o=a[t])?void 0:o.type))return`Min: ${e[0]}, Max: ${e[1]}`;if("CollectionControl"===(null==(n=a[t])?void 0:n.type))return e.map((e=>(0,u.o)(e))).join(", ");if("MetricsControl"===(null==(s=a[t])?void 0:s.type)&&Array.isArray(e)){const t=e.map((e=>e.label?e.label:e));return t.length?t.join(", "):"[]"}return"boolean"==typeof e?e?"true":"false":e.constructor===Array?e.length?e.join(", "):"[]":"string"==typeof e||"number"==typeof e?e:(0,u.o)(e)}renderModalBody(){return(0,te.tZ)(_t.Z,{columns:[{accessor:"control",Header:"Control"},{accessor:"before",Header:"Before"},{accessor:"after",Header:"After"}],data:this.state.rows,pageSize:50,className:"table-condensed",columnsForWrapText:["Control","Before","After"]})}renderTriggerNode(){return(0,te.tZ)(ke.u,{id:"difference-tooltip",title:(0,be.t)("Click to see difference")},(0,te.tZ)("span",{className:"label label-warning m-l-5",style:{fontSize:"12px"}},(0,be.t)("Altered")))}render(){return this.state.hasDiffs?(0,te.tZ)(yt.Z,{triggerNode:this.renderTriggerNode(),modalTitle:(0,be.t)("Chart changes"),modalBody:this.renderModalBody(),responsive:!0}):null}}wt.propTypes=St;var Et=a(36674),Ct=a(37921),Tt=a(1836);const Ot=(0,ee.iK)(Ct.Z)`
  text-align: left;
  width: 91px;
`;function xt({endTime:e,isRunning:t,startTime:a,status:r="success"}){const[n,s]=(0,o.useState)("00:00:00.00"),i=(0,o.useRef)();return(0,o.useEffect)((()=>{const r=()=>{i.current&&(clearInterval(i.current),i.current=void 0)};return t&&(i.current=setInterval((()=>{if(a){const o=e||(0,Tt.zO)();a<o&&s((0,Tt.zQ)(a,o)),t||r()}}),30)),r}),[e,t,a]),(0,te.tZ)(Ot,{type:r,role:"timer"},n)}var Rt=a(30381),Nt=a.n(Rt);const It=({cachedTimestamp:e})=>{const t=e?(0,te.tZ)("span",null,(0,be.t)("Loaded data cached"),(0,te.tZ)("b",null," ",Nt().utc(e).fromNow())):(0,be.t)("Loaded from cache");return(0,te.tZ)("span",null,t,". ",(0,be.t)("Click to force-refresh"))},At=({className:e,onClick:t,cachedTimestamp:a})=>{const[r,n]=(0,o.useState)(!1),s=r?"primary":"default";return(0,te.tZ)(ke.u,{title:(0,te.tZ)(It,{cachedTimestamp:a}),id:"cache-desc-tooltip"},(0,te.tZ)(Ct.Z,{className:`${e}`,type:s,onClick:t,onMouseOver:()=>n(!0),onMouseOut:()=>n(!1)},(0,be.t)("cached")," ",(0,te.tZ)("i",{className:"fa fa-refresh"})))};var Dt=a(74069),kt=a(9875),Mt=a(35932),jt=a(4715),$t=a(15926),Pt=a.n($t),Lt=a(14114);const Ut=jt.qz.Item,Ft=(0,ee.iK)(jt.qz.Item)`
  margin-bottom: 0;
`,zt=ee.iK.span`
  margin-bottom: 0;
`,Vt=(0,Lt.Z)((function({slice:e,onHide:t,onSave:a,show:r,addSuccessToast:n}){const[s,i]=(0,o.useState)(!1),[l]=jt.qz.useForm(),[c,u]=(0,o.useState)(e.slice_name||""),[h,p]=(0,o.useState)(null);function f({error:e,statusText:t,message:a}){let r=e||t||(0,be.t)("An error has occurred");"Forbidden"===a&&(r=(0,be.t)("You do not have permission to edit this chart")),Dt.Z.error({title:"Error",content:r,okButtonProps:{danger:!0,className:"btn-danger"}})}const m=(0,o.useCallback)((async function(){try{const t=(await d.Z.get({endpoint:`/api/v1/chart/${e.slice_id}`})).json.result;p(t.owners.map((e=>({value:e.id,label:`${e.first_name} ${e.last_name}`}))))}catch(e){f(await(0,pe.O)(e))}}),[e.slice_id]),b=(0,o.useMemo)((()=>(e="",t,a)=>{const r=Pt().encode({filter:e,page:t,page_size:a});return d.Z.get({endpoint:`/api/v1/chart/related/owners?q=${r}`}).then((e=>({data:e.json.result.map((e=>({value:e.value,label:e.text}))),totalCount:e.json.count})))}),[]),g=(0,be.t)("Owners");return(0,o.useEffect)((()=>{m()}),[m]),(0,o.useEffect)((()=>{u(e.slice_name||"")}),[e.slice_name]),(0,te.tZ)(Dt.Z,{show:r,onHide:t,title:"Edit Chart Properties",footer:(0,te.tZ)(o.Fragment,null,(0,te.tZ)(Mt.Z,{htmlType:"button",buttonSize:"small",onClick:t,cta:!0},(0,be.t)("Cancel")),(0,te.tZ)(Mt.Z,{htmlType:"submit",buttonSize:"small",buttonStyle:"primary",onClick:l.submit,disabled:s||!c,cta:!0},(0,be.t)("Save"))),responsive:!0,wrapProps:{"data-test":"properties-edit-modal"}},(0,te.tZ)(jt.qz,{form:l,onFinish:async r=>{i(!0);const{certified_by:o,certification_details:s,description:l,cache_timeout:u}=r,p={slice_name:c||null,description:l||null,cache_timeout:u||null,certified_by:o||null,certification_details:o&&s?s:null};h&&(p.owners=h.map((e=>e.value)));try{const r=await d.Z.put({endpoint:`/api/v1/chart/${e.slice_id}`,headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}),o={...p,...r.json.result,id:e.slice_id};a(o),n((0,be.t)("Chart properties updated")),t()}catch(e){f(await(0,pe.O)(e))}i(!1)},layout:"vertical",initialValues:{name:e.slice_name||"",description:e.description||"",cache_timeout:null!=e.cache_timeout?e.cache_timeout:"",certified_by:e.certified_by||"",certification_details:e.certified_by&&e.certification_details?e.certification_details:""}},(0,te.tZ)(jt.X2,{gutter:16},(0,te.tZ)(jt.JX,{xs:24,md:12},(0,te.tZ)("h3",null,(0,be.t)("Basic information")),(0,te.tZ)(Ut,{label:(0,be.t)("Name"),required:!0},(0,te.tZ)(kt.II,{"aria-label":(0,be.t)("Name"),name:"name",type:"text",value:c,onChange:e=>{var t;return u(null!=(t=e.target.value)?t:"")}})),(0,te.tZ)(Ut,null,(0,te.tZ)(Ft,{label:(0,be.t)("Description"),name:"description"},(0,te.tZ)(kt.Kx,{rows:3,style:{maxWidth:"100%"}})),(0,te.tZ)(zt,{className:"help-block"},(0,be.t)("The description can be displayed as widget headers in the dashboard view. Supports markdown."))),(0,te.tZ)("h3",null,(0,be.t)("Certification")),(0,te.tZ)(Ut,null,(0,te.tZ)(Ft,{label:(0,be.t)("Certified by"),name:"certified_by"},(0,te.tZ)(kt.II,{"aria-label":(0,be.t)("Certified by")})),(0,te.tZ)(zt,{className:"help-block"},(0,be.t)("Person or group that has certified this chart."))),(0,te.tZ)(Ut,null,(0,te.tZ)(Ft,{label:(0,be.t)("Certification details"),name:"certification_details"},(0,te.tZ)(kt.II,{"aria-label":(0,be.t)("Certification details")})),(0,te.tZ)(zt,{className:"help-block"},(0,be.t)("Any additional detail to show in the certification tooltip.")))),(0,te.tZ)(jt.JX,{xs:24,md:12},(0,te.tZ)("h3",null,(0,be.t)("Configuration")),(0,te.tZ)(Ut,null,(0,te.tZ)(Ft,{label:(0,be.t)("Cache timeout"),name:"cache_timeout"},(0,te.tZ)(kt.II,{"aria-label":"Cache timeout"})),(0,te.tZ)(zt,{className:"help-block"},(0,be.t)("Duration (in seconds) of the caching timeout for this chart. Note this defaults to the dataset's timeout if undefined."))),(0,te.tZ)("h3",{style:{marginTop:"1em"}},(0,be.t)("Access")),(0,te.tZ)(Ut,{label:g},(0,te.tZ)(jt.Ph,{ariaLabel:g,mode:"multiple",name:"owners",value:h||[],onChange:p,options:b,disabled:!h,allowClear:!0}),(0,te.tZ)(zt,{className:"help-block"},(0,be.t)("A list of users who can alter the chart. Searchable by name or username.")))))))}));var qt=a(79789),Ht=a(10222),Bt=a(76697),Kt=a(49238),Wt=a(13433);class Qt extends o.Component{constructor(e){super(e),this.state={height:"400",width:"600"},this.handleInputChange=this.handleInputChange.bind(this)}handleInputChange(e){const{value:t,name:a}=e.currentTarget,r={};r[a]=t,this.setState(r)}generateEmbedHTML(){const e=`${window.location.href}&${$e.KD.standalone.name}=1&height=${this.state.height}`;return`<iframe\n  width="${this.state.width}"\n  height="${this.state.height}"\n  seamless\n  frameBorder="0"\n  scrolling="no"\n  src="${e}"\n>\n</iframe>`}renderPopoverContent(){const e=this.generateEmbedHTML();return(0,te.tZ)("div",{id:"embed-code-popover"},(0,te.tZ)("div",{className:"row"},(0,te.tZ)("div",{className:"col-sm-10"},(0,te.tZ)("textarea",{name:"embedCode",value:e,rows:"4",readOnly:!0,className:"form-control input-sm",style:{resize:"vertical"}})),(0,te.tZ)("div",{className:"col-sm-2"},(0,te.tZ)(Wt.Z,{shouldShowText:!1,text:e,copyNode:(0,te.tZ)("i",{className:"fa fa-clipboard",title:(0,be.t)("Copy to clipboard")})}))),(0,te.tZ)("br",null),(0,te.tZ)("div",{className:"row"},(0,te.tZ)("div",{className:"col-md-6 col-sm-12"},(0,te.tZ)("div",{className:"form-group"},(0,te.tZ)("small",null,(0,te.tZ)(Kt.lX,{htmlFor:"embed-height"},(0,be.t)("Height"))),(0,te.tZ)("input",{className:"form-control input-sm",type:"text",defaultValue:this.state.height,name:"height",onChange:this.handleInputChange}))),(0,te.tZ)("div",{className:"col-md-6 col-sm-12"},(0,te.tZ)("div",{className:"form-group"},(0,te.tZ)("small",null,(0,te.tZ)(Kt.lX,{htmlFor:"embed-width"},(0,be.t)("Width"))),(0,te.tZ)("input",{className:"form-control input-sm",type:"text",defaultValue:this.state.width,name:"width",onChange:this.handleInputChange,id:"embed-width"})))))}render(){return(0,te.tZ)(Bt.Z,{trigger:"click",placement:"left",content:this.renderPopoverContent()},(0,te.tZ)(ke.u,{id:"embed-code-tooltip",placement:"top",title:"Embed code",trigger:["hover"]},(0,te.tZ)("div",{className:"btn btn-default btn-sm",style:{display:"flex",alignItems:"center",height:30}},(0,te.tZ)(ne.Z.Code,{iconSize:"l"}))))}}var Gt=a(83862),Jt=a(56727),Yt=a(15423);const Xt={onOpenPropertiesModal:Ne().func,onOpenInEditor:Ne().func,chartStatus:Ne().string,latestQueryFormData:Ne().object.isRequired,slice:Ne().object},ea="edit_properties",ta="run_in_sql_lab",aa="download_as_image",ra=e=>{const{datasource:t}=e.latestQueryFormData,a=t&&"table"===t.split("__")[1],{slice:r}=e;return(0,te.tZ)(jt.Gj,{trigger:"click",overlay:(0,te.tZ)(Gt.v,{onClick:({key:t,domEvent:a})=>{var r;const{slice:o,onOpenInEditor:n,latestQueryFormData:s}=e;switch(t){case ea:e.onOpenPropertiesModal();break;case ta:n(s);break;case aa:(0,Jt.Z)(".panel-body > .chart-container",null!=(r=null==o?void 0:o.slice_name)?r:(0,be.t)("New chart"),{},!0)(a)}},selectable:!1},r&&(0,te.tZ)(Gt.v.Item,{key:ea},(0,be.t)("Edit properties")),(0,te.tZ)(Gt.v.Item,{key:"view_query"},(0,te.tZ)(yt.Z,{triggerNode:(0,te.tZ)("span",null,(0,be.t)("View query")),modalTitle:(0,be.t)("View query"),modalBody:(0,te.tZ)(Yt.Z,{latestQueryFormData:e.latestQueryFormData}),draggable:!0,resizable:!0,responsive:!0})),a&&(0,te.tZ)(Gt.v.Item,{key:ta},(0,be.t)("Run in SQL Lab")),(0,te.tZ)(Gt.v.Item,{key:aa},(0,be.t)("Download as image")))},(0,te.tZ)("div",{role:"button",id:"query",tabIndex:0,className:"btn btn-default btn-sm"},(0,te.tZ)("i",{role:"img",className:"fa fa-bars"})))};ra.propTypes=Xt;const oa=(0,Q.$j)(null,(function(e){return(0,s.DE)({sliceUpdated:K.sliceUpdated},e)}))(ra);var na,sa;(sa=na||(na={})).EXPORT_ORIGINAL="export_original",sa.EXPORT_PIVOTED="export_pivoted";const ia=ee.iK.div`
  display: flex;
  align-items: center;
  justify-content: space-between;

  span[role='img'] {
    font-size: ${({theme:e})=>e.typography.sizes.l}px;
    margin-left: ${({theme:e})=>4*e.gridUnit}px;
  }
`,la=({exportCSVOriginal:e,exportCSVPivoted:t,children:a})=>{const r=(0,o.useCallback)((({key:a})=>{switch(a){case na.EXPORT_ORIGINAL:e();break;case na.EXPORT_PIVOTED:t()}}),[t,e]);return(0,te.tZ)(jt.Gj,{trigger:["click"],overlay:(0,te.tZ)(Gt.v,{onClick:r,selectable:!1},(0,te.tZ)(Gt.v.Item,{key:na.EXPORT_ORIGINAL},(0,te.tZ)(ia,null,(0,be.t)("Original"),(0,te.tZ)(ne.Z.Download,null))),(0,te.tZ)(Gt.v.Item,{key:na.EXPORT_PIVOTED},(0,te.tZ)(ia,null,(0,be.t)("Pivoted"),(0,te.tZ)(ne.Z.Download,null))))},a)},ca=["pivot_table","pivot_table_v2"];var da={name:"yc7s2v",styles:"display:flex;align-items:center;&:focus, &:focus:active{outline:0;}"};const ua=e=>{const{prefixIcon:t,suffixIcon:a,text:r,tooltip:o,className:n,onTooltipVisibilityChange:s,...i}=e;return(0,te.tZ)(ke.u,{id:`${t}-tooltip`,placement:"top",title:o,trigger:["hover"],onVisibleChange:s},(0,te.tZ)("div",Se()({role:"button",tabIndex:0,css:da,className:n||"btn btn-default btn-sm",style:{height:30}},i),t,r&&(0,te.tZ)("span",{style:{marginLeft:5}},r),a))},ha=(0,Lt.Z)((e=>{const{actions:t,canDownloadCSV:a,chartStatus:r,latestQueryFormData:n,slice:s,addDangerToast:i,addSuccessToast:l}=e,c=(0,be.t)("Copy chart URL to clipboard"),[d,u]=(0,o.useState)(c),h=a?E.pe.bind(void 0,{formData:n,resultType:"full",resultFormat:"csv"}):null,p=a?E.pe.bind(void 0,{formData:n,resultType:"post_processed",resultFormat:"csv"}):null,f=E.pe.bind(void 0,{formData:n,resultType:"results",resultFormat:"json"}),m=re()("btn btn-default btn-sm",{disabled:!a});return(0,te.tZ)("div",{className:"btn-group results",role:"group"},n&&(0,te.tZ)(o.Fragment,null,(0,te.tZ)(ua,{prefixIcon:(0,te.tZ)(ne.Z.Link,{iconSize:"l"}),tooltip:d,onClick:async()=>{try{u((0,be.t)("Loading..."));const e=window.location.href;await(0,Ht.Z)(e),u((0,be.t)("Copied to clipboard!")),l((0,be.t)("Copied to clipboard!"))}catch(e){u((0,be.t)("Sorry, your browser does not support copying.")),i((0,be.t)("Sorry, your browser does not support copying."))}},onTooltipVisibilityChange:e=>!e&&setTimeout((()=>u(c)),200)}),(0,te.tZ)(ua,{prefixIcon:(0,te.tZ)(ne.Z.Email,{iconSize:"l"}),tooltip:(0,be.t)("Share chart by email"),onClick:async()=>{try{const e=(0,be.t)("Superset Chart"),t=window.location.href,a=encodeURIComponent((0,be.t)("%s%s","Check out this chart: ",t));window.location.href=`mailto:?Subject=${e}%20&Body=${a}`}catch(e){i((0,be.t)("Sorry, something went wrong. Try again later."))}}}),(0,te.tZ)(Qt,null),(0,te.tZ)(ua,{prefixIcon:(0,te.tZ)(ne.Z.FileTextOutlined,{iconSize:"m"}),text:".JSON",tooltip:(0,be.t)("Export to .JSON format"),onClick:f}),ca.includes(n.viz_type)?(0,te.tZ)(la,{exportCSVOriginal:h,exportCSVPivoted:p},(0,te.tZ)(ua,{prefixIcon:(0,te.tZ)(ne.Z.FileExcelOutlined,{iconSize:"m"}),suffixIcon:(0,te.tZ)(ne.Z.CaretDown,{iconSize:"l",css:e=>`\n                    margin-left: ${e.gridUnit}px;\n                    margin-right: ${-e.gridUnit}px;\n                  `}),text:".CSV",tooltip:(0,be.t)("Export to .CSV format"),className:m})):(0,te.tZ)(ua,{prefixIcon:(0,te.tZ)(ne.Z.FileExcelOutlined,{iconSize:"m"}),text:".CSV",tooltip:(0,be.t)("Export to .CSV format"),onClick:h,className:m})),(0,te.tZ)(oa,{latestQueryFormData:n,chartStatus:r,onOpenInEditor:t.redirectSQLLab,onOpenPropertiesModal:t.openPropertiesModal,slice:s}))}));var pa=a(33891);const fa={failed:"danger",loading:"warning",success:"success"},ma={actions:Ne().object.isRequired,can_overwrite:Ne().bool.isRequired,can_download:Ne().bool.isRequired,dashboardId:Ne().number,isStarred:Ne().bool.isRequired,slice:Ne().object,sliceName:Ne().string,table_name:Ne().string,form_data:Ne().object,ownState:Ne().object,timeout:Ne().number,chart:Ue.$6},ba=ee.iK.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  flex-wrap: wrap;
  justify-content: space-between;

  span[role='button'] {
    display: flex;
    height: 100%;
  }

  .title-panel {
    display: flex;
    align-items: center;
  }

  .right-button-panel {
    display: flex;
    align-items: center;

    > .btn-group {
      flex: 0 0 auto;
      margin-left: ${({theme:e})=>e.gridUnit}px;
    }
  }

  .action-button {
    color: ${({theme:e})=>e.colors.grayscale.base};
    margin: 0 ${({theme:e})=>1.5*e.gridUnit}px 0
      ${({theme:e})=>e.gridUnit}px;
  }
`,ga=ee.iK.span`
  display: flex;
  align-items: center;
`;class va extends o.PureComponent{constructor(e){super(e),this.state={isPropertiesModalOpen:!1,showingReportModal:!1},this.openPropertiesModal=this.openPropertiesModal.bind(this),this.closePropertiesModal=this.closePropertiesModal.bind(this),this.showReportModal=this.showReportModal.bind(this),this.hideReportModal=this.hideReportModal.bind(this),this.renderReportModal=this.renderReportModal.bind(this),this.fetchChartDashboardData=this.fetchChartDashboardData.bind(this)}componentDidMount(){const{dashboardId:e}=this.props;if(this.canAddReports()){const{user:e,chart:t}=this.props;this.props.fetchUISpecificReport(e.userId,"chart_id","charts",t.id)}e&&this.fetchChartDashboardData()}async fetchChartDashboardData(){const{dashboardId:e,slice:t}=this.props;await d.Z.get({endpoint:`/api/v1/chart/${t.slice_id}`}).then((t=>{var a;const r=null==t||null==(a=t.json)?void 0:a.result;if(r&&r.dashboards&&r.dashboards.length){const{dashboards:t}=r,a=e&&t.length&&t.find((t=>t.id===e));if(a&&a.json_metadata){const e=JSON.parse(a.json_metadata).label_colors||{},t=nt.getNamespace();Object.keys(e).forEach((a=>{t.setColor(a,e[a])}))}}})).catch((()=>{}))}getSliceName(){const{sliceName:e,table_name:t}=this.props;return e||(0,be.t)("%s - untitled",t)}postChartFormData(){this.props.actions.postChartFormData(this.props.form_data,!0,this.props.timeout,this.props.chart.id,this.props.ownState)}openPropertiesModal(){this.setState({isPropertiesModalOpen:!0})}closePropertiesModal(){this.setState({isPropertiesModalOpen:!1})}showReportModal(){this.setState({showingReportModal:!0})}hideReportModal(){this.setState({showingReportModal:!1})}renderReportModal(){return Object.keys(this.props.reports).length?(0,te.tZ)(lt.Z,{showReportModal:this.showReportModal,hideReportModal:this.hideReportModal,toggleActive:this.props.toggleActive,deleteActiveReport:this.props.deleteActiveReport}):(0,te.tZ)(o.Fragment,null,(0,te.tZ)("span",{role:"button",title:(0,be.t)("Schedule email report"),tabIndex:0,className:"action-button",onClick:this.showReportModal},(0,te.tZ)(ne.Z.Calendar,null)))}canAddReports(){if(!(0,v.cr)(it.T.ALERT_REPORTS))return!1;const{user:e}=this.props;return!(null==e||!e.userId)&&Object.keys(e.roles||[]).map((t=>e.roles[t].filter((e=>"menu_access"===e[0]&&"Manage"===e[1]))))[0].length>0}render(){var e,t,a;const{user:r,form_data:n,slice:s}=this.props,{chartStatus:i,chartUpdateEndTime:l,chartUpdateStartTime:c,latestQueryFormData:d,queriesResponse:u}=this.props.chart,h=null==u?void 0:u[0],p=["failed","rendered","success"].includes(this.props.chart.chartStatus);return(0,te.tZ)(ba,{id:"slice-header",className:"panel-title-large"},(0,te.tZ)("div",{className:"title-panel"},(null==s?void 0:s.certified_by)&&(0,te.tZ)(o.Fragment,null,(0,te.tZ)(qt.Z,{certifiedBy:s.certified_by,details:s.certification_details})," "),(0,te.tZ)(ct.Z,{title:this.getSliceName(),canEdit:!this.props.slice||this.props.can_overwrite||((null==(e=this.props.slice)?void 0:e.owners)||[]).includes(null==(t=this.props)||null==(a=t.user)?void 0:a.userId),onSaveTitle:this.props.actions.updateChartTitle}),this.props.slice&&(0,te.tZ)(ga,null,r.userId&&(0,te.tZ)(Et.Z,{itemId:this.props.slice.slice_id,fetchFaveStar:this.props.actions.fetchFaveStar,saveFaveStar:this.props.actions.saveFaveStar,isStarred:this.props.isStarred,showTooltip:!0}),this.state.isPropertiesModalOpen&&(0,te.tZ)(Vt,{show:this.state.isPropertiesModalOpen,onHide:this.closePropertiesModal,onSave:this.props.sliceUpdated,slice:this.props.slice}),(0,te.tZ)(ke.u,{id:"edit-desc-tooltip",title:(0,be.t)("Edit chart properties")},(0,te.tZ)("span",{"aria-label":(0,be.t)("Edit chart properties"),role:"button",tabIndex:0,className:"edit-desc-icon",onClick:this.openPropertiesModal},(0,te.tZ)("i",{className:"fa fa-edit"}))),this.props.chart.sliceFormData&&(0,te.tZ)(wt,{className:"altered",origFormData:this.props.chart.sliceFormData,currentFormData:n}))),(0,te.tZ)("div",{className:"right-button-panel"},p&&h&&(0,te.tZ)(pa.Z,{rowcount:Number(h.rowcount)||0,limit:Number(n.row_limit)||0}),p&&h&&h.is_cached&&(0,te.tZ)(At,{onClick:this.postChartFormData.bind(this),cachedTimestamp:h.cached_dttm}),(0,te.tZ)(xt,{startTime:c,endTime:l,isRunning:"loading"===i,status:fa[i]}),this.canAddReports()&&this.renderReportModal(),(0,te.tZ)(st.Z,{show:this.state.showingReportModal,onHide:this.hideReportModal,props:{userId:this.props.user.userId,userEmail:this.props.user.email,chart:this.props.chart,creationMethod:"charts"}}),(0,te.tZ)(ha,{actions:{...this.props.actions,openPropertiesModal:this.openPropertiesModal},slice:this.props.slice,canDownloadCSV:this.props.can_download,chartStatus:i,latestQueryFormData:d,queryResponse:h})))}}va.propTypes=ma;const ya=(0,Q.$j)(null,(function(e){return(0,s.DE)({sliceUpdated:K.sliceUpdated,fetchUISpecificReport:R.Aw,toggleActive:R.M,deleteActiveReport:R.MZ},e)}))(va);var _a=a(43700),Sa=a(40637),Za=a(38703),wa=a(94301),Ea=a(50909),Ca=a(54076);const Ta="results",Oa="samples",xa=e=>({[Ta]:e,[Oa]:e}),Ra="data",Na=ee.iK.div`
  display: flex;
  align-items: center;

  span {
    flex-shrink: 0;
  }
`,Ia=ee.iK.div`
  position: relative;
  background-color: ${({theme:e})=>e.colors.grayscale.light5};
  z-index: 5;
  overflow: hidden;
`,Aa=ee.iK.div`
  height: ${({contentHeight:e})=>e}px;
  overflow: hidden;

  .table-condensed {
    height: 100%;
    overflow: auto;
  }
`,Da=ee.iK.div`
  height: 100%;

  .collapse-inner {
    height: 100%;

    .ant-collapse-item {
      height: 100%;

      .ant-collapse-content {
        height: calc(100% - ${({theme:e})=>8*e.gridUnit}px);

        .ant-collapse-content-box {
          padding-top: 0;
          height: 100%;
        }
      }
    }
  }
`,ka=ee.iK.pre`
  margin-top: ${({theme:e})=>4*e.gridUnit+"px"};
`,Ma=({columnNames:e,columnTypes:t,datasource:a,filterText:r,data:o,timeFormattedColumns:n,isLoading:s,error:i,errorMessage:l,type:c})=>{const d=(0,Ea._q)(e,t,o,a,n),u=(0,Ea.C4)(r,o);if(s)return(0,te.tZ)(Za.Z,null);if(i)return(0,te.tZ)(ka,null,i);if(o){if(0===o.length){const e="samples"===c?(0,be.t)("No samples were returned for this query"):(0,be.t)("No results were returned for this query");return(0,te.tZ)(wa.x3,{image:"document.svg",title:e})}return(0,te.tZ)(_t.Z,{columns:d,data:u,pageSize:50,noDataText:(0,be.t)("No results"),emptyWrapperType:_t.u.Small,className:"table-condensed",isPaginationSticky:!0,showRowCount:!1,small:!0})}if(l){const e="samples"===c?(0,be.t)("Run a query to display samples"):(0,be.t)("Run a query to display results");return(0,te.tZ)(wa.x3,{image:"document.svg",title:e})}return null},ja=({queryFormData:e,tableSectionHeight:t,onCollapseChange:a,chartStatus:r,ownState:n,errorMessage:s,queriesResponse:i})=>{const[l,c]=(0,o.useState)(xa(void 0)),[d,u]=(0,o.useState)(xa(!0)),[h,p]=(0,o.useState)(xa([])),[f,m]=(0,o.useState)(xa([])),[b,g]=(0,o.useState)(xa("")),[v,y]=(0,o.useState)(""),[_,S]=(0,o.useState)(Ta),[Z,E]=(0,o.useState)(xa(!1)),[C,T]=(0,o.useState)(O(w.is_datapanel_open,!1)),R=(N=null==e?void 0:e.datasource,(0,Q.v9)((e=>{var t,a;return N&&null!=(t=null==(a=e.explore.timeFormattedColumns)?void 0:a[N])?t:[]})));var N;const I=(0,o.useMemo)((()=>({[Ta]:(0,Ca.cD)(l.results,R),[Oa]:(0,Ca.cD)(l.samples,R)})),[l,R]),A=(0,o.useCallback)((t=>(u((e=>({...e,[t]:!0}))),(0,H.getChartDataRequest)({formData:e,resultFormat:"json",resultType:t,ownState:n}).then((({json:e})=>{if(e.result.length>1){const a=[];e.result.forEach((e=>{e.data.forEach(((e,t)=>{void 0!==a[t]?a[t]={...a[t],...e}:a[t]=e}))})),c((e=>({...e,[t]:a})))}else c((a=>({...a,[t]:e.result[0].data})));const a=(0,q.Z)(e.result[0].colnames);p((e=>({...e,[t]:a}))),m((a=>({...a,[t]:e.result[0].coltypes||[]}))),u((e=>({...e,[t]:!1}))),g((e=>({...e,[t]:void 0})))})).catch((e=>{(0,pe.O)(e).then((({error:e,message:a})=>{g((r=>({...r,[t]:e||a||(0,be.t)("Sorry, an error occurred")}))),u((e=>({...e,[t]:!1})))}))})))),[e,h]);(0,o.useEffect)((()=>{x(w.is_datapanel_open,C)}),[C]),(0,o.useEffect)((()=>{E((e=>({...e,[Ta]:!0})))}),[e]),(0,o.useEffect)((()=>{E((e=>({...e,[Oa]:!0})))}),[null==e?void 0:e.datasource]),(0,o.useEffect)((()=>{if(i&&"success"===r){const{colnames:e}=i[0];p((t=>({...t,[Ta]:null!=e?e:[]})))}}),[i,r]),(0,o.useEffect)((()=>{if(C&&Z.results){if(s)return E((e=>({...e,[Ta]:!1}))),void u((e=>({...e,[Ta]:!1})));"loading"===r?u((e=>({...e,[Ta]:!0}))):(E((e=>({...e,[Ta]:!1}))),A(Ta))}C&&Z.samples&&_===Oa&&(E((e=>({...e,[Oa]:!1}))),A(Oa))}),[C,Z,A,_,r,s]);const D=(0,te.tZ)(Na,null,(0,te.tZ)(Ea.uy,{data:l[_],loading:d[_]}),(0,te.tZ)(Ea.m,{data:I[_],columns:h[_]}),(0,te.tZ)(Ea.HS,{onChangeHandler:y}));return(0,te.tZ)(Ia,null,(0,te.tZ)(Aa,{contentHeight:t},(0,te.tZ)(Da,null,(0,te.tZ)(_a.Z,{accordion:!0,bordered:!1,defaultActiveKey:C?Ra:void 0,onChange:e=>{a(e),T(!!e)},bold:!0,ghost:!0,className:"collapse-inner"},(0,te.tZ)(_a.Z.Panel,{header:(0,be.t)("Data"),key:Ra},(0,te.tZ)(Sa.ZP,{fullWidth:!1,tabBarExtraContent:D,activeKey:_,onChange:S},(0,te.tZ)(Sa.ZP.TabPane,{tab:(0,be.t)("View results"),key:Ta},(0,te.tZ)(Ma,{isLoading:d.results,data:l.results,datasource:null==e?void 0:e.datasource,timeFormattedColumns:R,columnNames:h.results,columnTypes:f.results,filterText:v,error:b.results,errorMessage:s,type:Ta})),(0,te.tZ)(Sa.ZP.TabPane,{tab:(0,be.t)("View samples"),key:Oa},(0,te.tZ)(Ma,{isLoading:d.samples,data:l.samples,datasource:null==e?void 0:e.datasource,timeFormattedColumns:R,columnNames:h.samples,columnTypes:f.samples,filterText:v,error:b.samples,errorMessage:s,type:Oa}))))))))},$a={actions:Ne().object.isRequired,onQuery:Ne().func,can_overwrite:Ne().bool.isRequired,can_download:Ne().bool.isRequired,datasource:Ne().object,dashboardId:Ne().number,column_formats:Ne().object,containerId:Ne().string.isRequired,height:Ne().string.isRequired,width:Ne().string.isRequired,isStarred:Ne().bool.isRequired,slice:Ne().object,sliceName:Ne().string,table_name:Ne().string,vizType:Ne().string.isRequired,form_data:Ne().object,ownState:Ne().object,standalone:Ne().number,force:Ne().bool,timeout:Ne().number,refreshOverlayVisible:Ne().bool,chart:Ue.$6,errorMessage:Ne().node,triggerRender:Ne().bool},Pa=1.25,La=[90,10],Ua=[300,50],Fa=ee.iK.div`
  display: flex;
  flex-direction: column;
  align-items: stretch;
  align-content: stretch;
  overflow: auto;
  box-shadow: none;
  height: 100%;

  & > div:last-of-type {
    flex-basis: 100%;
  }

  .gutter {
    border-top: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    border-bottom: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    width: ${({theme:e})=>9*e.gridUnit}px;
    margin: ${({theme:e})=>e.gridUnit*Pa}px auto;
  }

  .gutter.gutter-vertical {
    cursor: row-resize;
  }

  .ant-collapse {
    .ant-tabs {
      height: 100%;
      .ant-tabs-nav {
        padding-left: ${({theme:e})=>5*e.gridUnit}px;
        margin: 0;
      }
      .ant-tabs-content-holder {
        overflow: hidden;
        .ant-tabs-content {
          height: 100%;
        }
      }
    }
  }
`,za=e=>{const t=(0,ee.Fg)(),a=t.gridUnit*Pa,r=t.gridUnit*Pa,{height:n,ref:s}=rt({refreshMode:"debounce",refreshRate:300}),{width:i,ref:l}=rt({refreshMode:"debounce",refreshRate:300}),[c,u]=(0,o.useState)(O(w.chart_split_sizes,La)),{slice:h}=e,p=(0,o.useCallback)((async function(){if(h&&null===h.query_context){const t=(0,E.u)({formData:h.form_data,force:e.force,resultFormat:"json",resultType:"full",setDataMask:null,ownState:null});await d.Z.put({endpoint:`/api/v1/chart/${h.slice_id}`,headers:{"Content-Type":"application/json"},body:JSON.stringify({query_context:JSON.stringify(t),query_context_generation:!0})})}}),[h]);(0,o.useEffect)((()=>{p()}),[p]);const f=(0,o.useCallback)((t=>{let o;return o=e.standalone?0:n?n+15:50,(parseInt(e.height,10)-o)*t/100-(r/2+a)}),[r,a,e.height,e.standalone,n]),[m,b]=(0,o.useState)(f(La[1])),g=(0,o.useCallback)((([,e])=>{b(f(e))}),[f]);(0,o.useEffect)((()=>{g(c)}),[g,c]),(0,o.useEffect)((()=>{x(w.chart_split_sizes,c)}),[c]);const v=(0,o.useCallback)((()=>{const{chart:t,vizType:a}=e,r="filter_box"===a?f(100)-15:f(c[0])-15,o=i-30;return o>0&&(0,te.tZ)(ot.Z,{width:Math.floor(o),height:r,ownState:e.ownState,annotationData:t.annotationData,chartAlert:t.chartAlert,chartStackTrace:t.chartStackTrace,chartId:t.id,chartStatus:t.chartStatus,triggerRender:e.triggerRender,force:e.force,datasource:e.datasource,errorMessage:e.errorMessage,formData:e.form_data,onQuery:e.onQuery,queriesResponse:t.queriesResponse,refreshOverlayVisible:e.refreshOverlayVisible,setControlValue:e.actions.setControlValue,timeout:e.timeout,triggerQuery:t.triggerQuery,vizType:e.vizType})}),[f,i,e,c]),y=(0,o.useMemo)((()=>(0,te.tZ)("div",{className:"panel-body",ref:l},v())),[l,v]),_=(0,o.useMemo)((()=>(0,te.tZ)("div",{ref:l},v())),[l,v]),[S,Z]=(0,o.useState)(e.chart.latestQueryFormData);if((0,o.useEffect)((()=>{e.triggerRender||Z(e.chart.latestQueryFormData)}),[e.chart.latestQueryFormData]),e.standalone){const e="background-transparent";return document.body.className.split(" ").includes(e)||(document.body.className+=` ${e}`),_}const C=(0,te.tZ)(ya,{ownState:e.ownState,actions:e.actions,can_overwrite:e.can_overwrite,can_download:e.can_download,dashboardId:e.dashboardId,isStarred:e.isStarred,slice:e.slice,sliceName:e.sliceName,table_name:e.table_name,form_data:e.form_data,timeout:e.timeout,chart:e.chart,user:e.user,reports:e.reports});return(0,te.tZ)(Fa,{className:"panel panel-default chart-container",ref:l},(0,te.tZ)("div",{className:"panel-heading",ref:s},C),"filter_box"===e.vizType?y:(0,te.tZ)(qe.Z,{sizes:c,minSize:Ua,direction:"vertical",gutterSize:r,onDragEnd:e=>{u(e)},elementStyle:(e,t,r)=>({[e]:`calc(${t}% - ${r+a}px)`})},y,(0,te.tZ)(ja,{ownState:e.ownState,queryFormData:S,tableSectionHeight:m,onCollapseChange:e=>{let t;t=e?[60,40]:La,u(t)},chartStatus:e.chart.chartStatus,errorMessage:e.errorMessage,queriesResponse:e.chart.queriesResponse})))};za.propTypes=$a;const Va=za;var qa=a(46078),Ha=a(674),Ba=a(9882),Ka=a(61357),Wa=a(11865);const Qa=ee.iK.div`
  margin: ${({theme:e})=>4*e.gridUnit}px;
  padding: ${({theme:e})=>4*e.gridUnit}px;

  border: ${({theme:e})=>`1px solid ${e.colors.info.base}`};
  background-color: ${({theme:e})=>e.colors.info.light2};
  border-radius: 2px;

  color: ${({theme:e})=>e.colors.info.dark2};
  font-size: ${({theme:e})=>e.typography.sizes.s};

  &.alert-type-warning {
    border-color: ${({theme:e})=>e.colors.alert.base};
    background-color: ${({theme:e})=>e.colors.alert.light2};

    p {
      color: ${({theme:e})=>e.colors.alert.dark2};
    }
  }
`,Ga=ee.iK.div`
  display: flex;
  justify-content: flex-end;
  button {
    line-height: 1;
  }
`,Ja=ee.iK.p`
  font-weight: ${({theme:e})=>e.typography.weights.bold};
`,Ya=({title:e,bodyText:t,primaryButtonAction:a,secondaryButtonAction:r,primaryButtonText:o,secondaryButtonText:n,type:s="info"})=>(0,te.tZ)(Qa,{className:`alert-type-${s}`},(0,te.tZ)(Ja,null,e),(0,te.tZ)("p",null,t),(0,te.tZ)(Ga,null,r&&n&&(0,te.tZ)(Mt.Z,{buttonStyle:"link",buttonSize:"small",onClick:r},n),(0,te.tZ)(Mt.Z,{buttonStyle:"warning"===s?"warning":"primary",buttonSize:"small",onClick:a},o))),Xa=ee.iK.div`
  height: 100%;
  width: 100%;
  overflow: auto;
  overflow-x: visible;
  #controlSections {
    min-height: 100%;
    overflow: visible;
  }
  .nav-tabs {
    flex: 0 0 1;
  }
  .tab-content {
    overflow: auto;
    flex: 1 1 100%;
  }
  .Select__menu {
    max-width: 100%;
  }
  .type-label {
    margin-right: ${({theme:e})=>3*e.gridUnit}px;
    width: ${({theme:e})=>7*e.gridUnit}px;
    display: inline-block;
    text-align: center;
    font-weight: ${({theme:e})=>e.typography.weights.bold};
  }
`,er=(0,ee.iK)(Sa.ZP)`
  .ant-tabs-nav-list {
    width: ${({fullWidth:e})=>e?"100%":"50%"};
  }
  .ant-tabs-content-holder {
    overflow: visible;
  }
  .ant-tabs-tabpane {
    height: 100%;
  }
`,tr=(e,t)=>e.reduce(((e,a)=>!a.expanded||(e=>!!e.label&&(Ha.sections.legacyRegularTime.label===e.label||Ha.sections.legacyTimeseriesTime.label===e.label))(a)&&!(e=>{var t;return(null==e||null==(t=e.columns)?void 0:t.some((e=>e.is_dttm)))||e.type===qa.i.Druid})(t)?e:[...e,String(a.label)]),[]),ar=e=>{var t,a;const r=(0,o.useContext)(X.Zn),n=(0,Me.D)(e.exploreState),s=(0,Me.D)(e.exploreState.datasource),[i,l]=(0,o.useState)(!1),c=(0,o.useRef)(null);(0,o.useEffect)((()=>{var t,a,r;!s||(null==(t=e.exploreState.datasource)?void 0:t.id)===s.id&&(null==(a=e.exploreState.datasource)?void 0:a.type)===s.type||(l(!0),null==(r=c.current)||r.scrollTo(0,0))}),[null==(t=e.exploreState.datasource)?void 0:t.id,null==(a=e.exploreState.datasource)?void 0:a.type,s]);const{expandedQuerySections:d,expandedCustomizeSections:u,querySections:h,customizeSections:p}=(0,o.useMemo)((()=>function(e,t,a){const r=[],o=[];return(0,T.Bq)(e,a).forEach((e=>{"data"===e.tabOverride||e.controlSetRows.some((e=>e.some((e=>e&&"object"==typeof e&&"config"in e&&e.config&&(!e.config.renderTrigger||"data"===e.config.tabOverride)))))?r.push(e):o.push(e)})),{expandedQuerySections:tr(r,t),expandedCustomizeSections:tr(o,t),querySections:r,customizeSections:o}}(e.form_data.viz_type,e.exploreState.datasource,e.datasource_type)),[e.exploreState.datasource,e.form_data.viz_type,e.datasource_type]),f=(0,o.useCallback)((()=>{(0,q.Z)(e.exploreState.controlsTransferred).forEach((t=>e.actions.setControlValue(t,e.controls[t].default)))}),[e.actions,e.exploreState.controlsTransferred,e.controls]),m=(0,o.useCallback)((()=>{f(),l(!1)}),[f]),b=(0,o.useCallback)((()=>{l(!1)}),[]),g=({name:t,config:a})=>{const{controls:r,chart:o,exploreState:s}=e;return Boolean(null==a.shouldMapStateToProps?void 0:a.shouldMapStateToProps(n||s,s,r[t],o))},v=t=>{const{controls:a}=e,{label:r,description:n}=t,s=String(r),i=t.controlSetRows.some((e=>e.some((e=>{const t="string"==typeof e?e:e&&"name"in e?e.name:null;return t&&t in a&&a[t].validationErrors&&a[t].validationErrors.length>0}))));return(0,te.tZ)(_a.Z.Panel,{css:e=>te.iv`
          margin-bottom: 0;
          box-shadow: none;

          &:last-child {
            padding-bottom: ${10*e.gridUnit}px;
          }

          .panel-body {
            margin-left: ${4*e.gridUnit}px;
            padding-bottom: 0;
          }

          span.label {
            display: inline-block;
          }
        `,header:(0,te.tZ)((()=>(0,te.tZ)("span",null,(0,te.tZ)("span",null,r)," ",n&&(0,te.tZ)(Ba.V,{label:s,tooltip:n}),i&&(0,te.tZ)(Ba.V,{label:"validation-errors",bsStyle:"danger",tooltip:"This section contains validation errors"}))),null),key:s},t.controlSetRows.map(((t,a)=>{const r=t.map((t=>t?o.isValidElement(t)?t:t.name&&t.config&&"datasource"!==t.name?(({name:t,config:a})=>{const{controls:r,chart:o,exploreState:n}=e,{visibility:s}=a,i={...a,...r[t],...g({name:t,config:a})?null==a||null==a.mapStateToProps?void 0:a.mapStateToProps(n,r[t],o):void 0,name:t},{validationErrors:l,...c}=i;return s&&!s.call(a,e,i)?null:(0,te.tZ)(Wa.Z,Se()({key:`control-${t}`,name:t,validationErrors:l,actions:e.actions},c))})(t):null:null)).filter((e=>null!==e));return 0===r.length?null:(0,te.tZ)(Ka.Z,{key:`controlsetrow-${a}`,controls:r})})))},y=(0,q.Z)(e.exploreState.controlsTransferred).length>0,_=(0,o.useCallback)((()=>y?(0,te.tZ)(Ya,{title:(0,be.t)("Keep control settings?"),bodyText:(0,be.t)("You've changed datasets. Any controls with data (columns, metrics) that match this new dataset have been retained."),primaryButtonAction:b,secondaryButtonAction:m,primaryButtonText:(0,be.t)("Continue"),secondaryButtonText:(0,be.t)("Clear form"),type:"info"}):(0,te.tZ)(Ya,{title:(0,be.t)("No form settings were maintained"),bodyText:(0,be.t)("We were unable to carry over any controls when switching to this new dataset."),primaryButtonAction:b,primaryButtonText:(0,be.t)("Continue"),type:"warning"})),[m,b,y]);if(!(0,bt.Z)().has(e.form_data.viz_type)&&r.loading)return(0,te.tZ)(Za.Z,null);const S=p.length>0;return(0,te.tZ)(Xa,{ref:c},(0,te.tZ)(er,{id:"controlSections",fullWidth:S},(0,te.tZ)(Sa.ZP.TabPane,{key:"query",tab:(0,be.t)("Data")},(0,te.tZ)(_a.Z,{bordered:!0,defaultActiveKey:d,expandIconPosition:"right",ghost:!0,key:`query-sections-${e.form_data.datasource}-${e.form_data.viz_type}`},i&&(0,te.tZ)(_,null),h.map(v))),S&&(0,te.tZ)(Sa.ZP.TabPane,{key:"display",tab:(0,be.t)("Customize")},(0,te.tZ)(_a.Z,{bordered:!0,defaultActiveKey:u,expandIconPosition:"right",ghost:!0,key:`customize-sections-${e.form_data.datasource}-${e.form_data.viz_type}`},p.map(v)))))};var rr=a(29487),or=a(30724),nr=a.n(or),sr=a(87183);const ir="save_chart_recent_dashboard",lr=(0,be.t)("**Select** a dashboard OR **create** a new one"),cr=(0,ee.iK)(Dt.Z)`
  .ant-modal-body {
    overflow: visible;
  }
`;class dr extends o.Component{constructor(e){super(e),this.state={saveToDashboardId:null,newSliceName:e.sliceName,alert:null,action:this.canOverwriteSlice()?"overwrite":"saveas"},this.onDashboardSelectChange=this.onDashboardSelectChange.bind(this),this.onSliceNameChange=this.onSliceNameChange.bind(this),this.changeAction=this.changeAction.bind(this),this.saveOrOverwrite=this.saveOrOverwrite.bind(this)}canOverwriteSlice(){var e,t;return null==(e=this.props.slice)||null==(t=e.owners)?void 0:t.includes(this.props.userId)}componentDidMount(){this.props.actions.fetchDashboards(this.props.userId).then((()=>{const e=this.props.dashboards.map((e=>e.value)),t=sessionStorage.getItem(ir);let a=t&&parseInt(t,10);this.props.dashboardId&&(a=this.props.dashboardId),null!==a&&-1!==e.indexOf(a)&&this.setState({saveToDashboardId:a})}))}onSliceNameChange(e){this.setState({newSliceName:e.target.value})}onDashboardSelectChange(e){const t=e?String(e):void 0,a=e&&"number"==typeof e?e:null;this.setState({saveToDashboardId:a,newDashboardName:t})}changeAction(e){this.setState({action:e})}saveOrOverwrite(e){this.setState({alert:null}),this.props.actions.removeSaveModalAlert();const t={};if(this.props.slice&&this.props.slice.slice_id&&(t.slice_id=this.props.slice.slice_id),"saveas"===t.action&&""===this.state.newSliceName)return void this.setState({alert:(0,be.t)("Please enter a chart name")});t.action=this.state.action,t.slice_name=this.state.newSliceName,t.save_to_dashboard_id=this.state.saveToDashboardId,t.new_dashboard_name=this.state.newDashboardName;const{url_params:a,...r}=this.props.form_data||{};this.props.actions.saveSlice(r,t).then((t=>{null===t.dashboard_id?sessionStorage.removeItem(ir):sessionStorage.setItem(ir,t.dashboard_id);let r=e?t.dashboard_url:t.slice.slice_url;if(a){const e=r.includes("?")?"&":"?";r=`${r}${e}${new URLSearchParams(a).toString()}`}window.location.assign(r)})),this.props.onHide()}removeAlert(){this.props.alert&&this.props.actions.removeSaveModalAlert(),this.setState({alert:null})}render(){const e=this.state.saveToDashboardId||this.state.newDashboardName;return(0,te.tZ)(cr,{show:!0,onHide:this.props.onHide,title:(0,be.t)("Save chart"),footer:(0,te.tZ)("div",null,(0,te.tZ)(Mt.Z,{id:"btn_cancel",buttonSize:"small",onClick:this.props.onHide},(0,be.t)("Cancel")),(0,te.tZ)(Mt.Z,{id:"btn_modal_save_goto_dash",buttonSize:"small",disabled:!this.state.newSliceName||!this.state.saveToDashboardId&&!this.state.newDashboardName,onClick:()=>this.saveOrOverwrite(!0)},(0,be.t)("Save & go to dashboard")),(0,te.tZ)(Mt.Z,{id:"btn_modal_save",buttonSize:"small",buttonStyle:"primary",onClick:()=>this.saveOrOverwrite(!1),disabled:!this.state.newSliceName},!this.canOverwriteSlice()&&this.props.slice?(0,be.t)("Save as new chart"):(0,be.t)("Save")))},(0,te.tZ)(Kt.l0,{layout:"vertical"},(this.state.alert||this.props.alert)&&(0,te.tZ)(rr.Z,{type:"warning",message:(0,te.tZ)(o.Fragment,null,this.state.alert?this.state.alert:this.props.alert,(0,te.tZ)("i",{role:"button","aria-label":"Remove alert",tabIndex:0,className:"fa fa-close pull-right",onClick:this.removeAlert.bind(this),style:{cursor:"pointer"}}))}),(0,te.tZ)(Kt.xJ,null,(0,te.tZ)(sr.Y,{id:"overwrite-radio",disabled:!this.canOverwriteSlice(),checked:"overwrite"===this.state.action,onChange:()=>this.changeAction("overwrite")},(0,be.t)("Save (Overwrite)")),(0,te.tZ)(sr.Y,{id:"saveas-radio",checked:"saveas"===this.state.action,onChange:()=>this.changeAction("saveas")}," ",(0,be.t)("Save as ..."),"  ")),(0,te.tZ)("hr",null),(0,te.tZ)(Kt.xJ,{label:(0,be.t)("Chart name"),required:!0},(0,te.tZ)(kt.II,{name:"new_slice_name",type:"text",placeholder:"Name",value:this.state.newSliceName,onChange:this.onSliceNameChange})),(0,te.tZ)(Kt.xJ,{label:(0,be.t)("Add to dashboard")},(0,te.tZ)(jt.Ph,{allowClear:!0,allowNewOptions:!0,ariaLabel:(0,be.t)("Select a dashboard"),options:this.props.dashboards,onChange:this.onDashboardSelectChange,value:e||void 0,placeholder:(0,te.tZ)(nr(),{source:lr,renderers:{paragraph:"span"}})}))))}}const ur=(0,Q.$j)((function({explore:e,saveModal:t}){var a;return{datasource:e.datasource,slice:e.slice,userId:null==(a=e.user)?void 0:a.userId,dashboards:t.dashboards,alert:t.saveModalAlert}}),(()=>({})))(dr);var hr=a(37488);function pr(e){const{canAdd:t,onQuery:a=(()=>{}),onSave:r=(()=>{}),onStop:o=(()=>{}),loading:n,chartIsStale:s,errorMessage:i}=e;let l="tertiary";i?l="danger":s&&(l="primary");const c=!!i||n,d=n?(0,te.tZ)(Mt.Z,{onClick:o,buttonStyle:"warning",buttonSize:"small",disabled:!t},(0,te.tZ)("i",{className:"fa fa-stop-circle-o"})," ",(0,be.t)("Stop")):(0,te.tZ)(Mt.Z,{buttonSize:"small",onClick:a,buttonStyle:l,disabled:!!i},(0,te.tZ)("i",{className:"fa fa-bolt"})," ",(0,be.t)("Run")),u=(0,ee.Fg)();return(0,te.tZ)("div",{css:(0,te.iv)({display:"flex",flexShrink:0,flexDirection:"row",alignItems:"center",paddingTop:2*u.gridUnit,paddingRight:2*u.gridUnit,paddingBottom:0,paddingLeft:4*u.gridUnit,"& button":{width:100},".errMsg":{marginLeft:4*u.gridUnit}},"","")},(0,te.tZ)(hr.Z,{className:"query-and-save"},d,(0,te.tZ)(Mt.Z,{buttonStyle:"tertiary",buttonSize:"small","data-target":"#save_modal","data-toggle":"modal",disabled:c,onClick:r},(0,te.tZ)("i",{className:"fa fa-plus-circle"})," ",(0,be.t)("Save"))),i&&(0,te.tZ)("span",{className:"errMsg"}," ",(0,te.tZ)(ke.u,{id:"query-error-tooltip",placement:"right",title:i},(0,te.tZ)("i",{className:"fa fa-exclamation-circle text-danger fa-lg"}))))}var fr=a(90233),mr=a(27034),br=a(42753),gr=a(99963);const vr=ee.iK.div`
  display: flex;
  align-items: center;
  width: 100%;
  height: ${({theme:e})=>6*e.gridUnit}px;
  cursor: pointer;

  > div {
    width: 100%;
  }

  :hover {
    background-color: ${({theme:e})=>e.colors.grayscale.light2};
  }
`;function yr(e){const{labelRef:t,showTooltip:a,type:r,value:o}=e,[{isDragging:n},s]=(0,mr.c)({item:{value:e.value,type:e.type},collect:e=>({isDragging:e.isDragging()})}),i={labelRef:t,showTooltip:!n&&a,showType:!0};return(0,te.tZ)(vr,{ref:s},r===br.g.Column?(0,te.tZ)(gr.l,Se()({column:o},i)):(0,te.tZ)(gr.B,Se()({metric:o},i)))}const _r=ee.iK.button`
  background: none;
  border: none;
  text-decoration: underline;
  color: ${({theme:e})=>e.colors.primary.dark1};
`,Sr=ee.iK.div`
  text-align: center;
  padding-top: 2px;
`,Zr=ee.iK.div`
  ${({theme:e})=>te.iv`
    background-color: ${e.colors.grayscale.light4};
    position: relative;
    height: 100%;
    display: flex;
    flex-direction: column;
    max-height: 100%;
    .ant-collapse {
      height: auto;
    }
    .field-selections {
      padding: 0 0 ${4*e.gridUnit}px;
      overflow: auto;
    }
    .field-length {
      margin-bottom: ${2*e.gridUnit}px;
      font-size: ${e.typography.sizes.s}px;
      color: ${e.colors.grayscale.light1};
    }
    .form-control.input-md {
      width: calc(100% - ${4*e.gridUnit}px);
      height: ${8*e.gridUnit}px;
      margin: ${2*e.gridUnit}px auto;
    }
    .type-label {
      font-weight: ${e.typography.weights.light};
      font-size: ${e.typography.sizes.s}px;
      color: ${e.colors.grayscale.base};
    }
    .Control {
      padding-bottom: 0;
    }
  `};
`,wr=ee.iK.div`
  overflow: hidden;
  text-overflow: ellipsis;

  & > span {
    white-space: nowrap;
  }

  .option-label {
    display: inline;
  }

  .metric-option {
    & > svg {
      min-width: ${({theme:e})=>4*e.gridUnit+"px"};
    }
    & > .option-label {
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
`,Er=e=>{const t={labelRef:(0,o.useRef)(null)};return(0,te.tZ)(wr,{className:e.className},o.cloneElement(e.children,t))},Cr=(0,v.cr)(it.T.ENABLE_EXPLORE_DRAG_AND_DROP);function Tr({datasource:e,controls:{datasource:t},actions:a,shouldForceUpdate:r}){const{columns:n,metrics:s}=e,i=(0,o.useMemo)((()=>[...n].sort(((e,t)=>e.is_dttm&&!t.is_dttm?-1:t.is_dttm&&!e.is_dttm?1:0))),[n]),[l,c]=(0,o.useState)(""),[d,u]=(0,o.useState)({columns:i,metrics:s}),[h,p]=(0,o.useState)(!1),[f,b]=(0,o.useState)(!1),g=(0,o.useMemo)((()=>m()((e=>{u(""!==e?{columns:(0,fr.Lu)(i,e,{keys:[{key:"verbose_name",threshold:fr.tL.CONTAINS},{key:"column_name",threshold:fr.tL.CONTAINS},{key:e=>[e.description,e.expression].map((e=>(null==e?void 0:e.replace(/[_\n\s]+/g," "))||"")),threshold:fr.tL.CONTAINS,maxRanking:fr.tL.CONTAINS}],keepDiacritics:!0}),metrics:(0,fr.Lu)(s,e,{keys:[{key:"verbose_name",threshold:fr.tL.CONTAINS},{key:"metric_name",threshold:fr.tL.CONTAINS},{key:e=>[e.description,e.expression].map((e=>(null==e?void 0:e.replace(/[_\n\s]+/g," "))||"")),threshold:fr.tL.CONTAINS,maxRanking:fr.tL.CONTAINS}],keepDiacritics:!0,baseSort:(e,t)=>Number(t.item.is_certified)-Number(e.item.is_certified)||String(e.rankedValue).localeCompare(t.rankedValue)})}:{columns:i,metrics:s})}),$e.oP)),[i,s]);(0,o.useEffect)((()=>{u({columns:i,metrics:s}),c("")}),[i,e,s]);const v=(0,o.useMemo)((()=>h?d.metrics:d.metrics.slice(0,50)),[d.metrics,h]),y=(0,o.useMemo)((()=>(f?d.columns:d.columns.slice(0,50)).sort(((e,t)=>t.is_certified-e.is_certified))),[d.columns,f]),_=(0,o.useMemo)((()=>(0,te.tZ)(o.Fragment,null,(0,te.tZ)(kt.II,{allowClear:!0,onChange:e=>{c(e.target.value),g(e.target.value)},value:l,className:"form-control input-md",placeholder:(0,be.t)("Search Metrics & Columns")}),(0,te.tZ)("div",{className:"field-selections"},(0,te.tZ)(_a.Z,{bordered:!0,defaultActiveKey:["metrics","column"],expandIconPosition:"right",ghost:!0},(0,te.tZ)(_a.Z.Panel,{header:(0,te.tZ)("span",{className:"header"},(0,be.t)("Metrics")),key:"metrics"},(0,te.tZ)("div",{className:"field-length"},(0,be.t)("Showing %s of %s",v.length,d.metrics.length)),v.map((e=>(0,te.tZ)(Er,{key:e.metric_name+String(r),className:"column"},Cr?(0,te.tZ)(yr,{value:e,type:br.g.Metric}):(0,te.tZ)(gr.B,{metric:e,showType:!0})))),d.metrics.length>50?(0,te.tZ)(Sr,null,(0,te.tZ)(_r,{onClick:()=>p(!h)},h?(0,be.t)("Show less..."):(0,be.t)("Show all..."))):(0,te.tZ)(o.Fragment,null)),(0,te.tZ)(_a.Z.Panel,{header:(0,te.tZ)("span",{className:"header"},(0,be.t)("Columns")),key:"column"},(0,te.tZ)("div",{className:"field-length"},(0,be.t)("Showing %s of %s",y.length,d.columns.length)),y.map((e=>(0,te.tZ)(Er,{key:e.column_name+String(r),className:"column"},Cr?(0,te.tZ)(yr,{value:e,type:br.g.Column}):(0,te.tZ)(gr.l,{column:e,showType:!0})))),d.columns.length>50?(0,te.tZ)(Sr,null,(0,te.tZ)(_r,{onClick:()=>b(!f)},f?(0,be.t)("Show Less..."):(0,be.t)("Show all..."))):(0,te.tZ)(o.Fragment,null)))))),[y,l,d.columns.length,d.metrics.length,v,g,f,h,r]);return(0,te.tZ)(Zr,null,(0,te.tZ)(Wa.Z,Se()({},t,{name:"datasource",actions:a})),null!=e.id&&_)}const Or={...Va.propTypes,height:Ne().string,width:Ne().string,actions:Ne().object.isRequired,datasource_type:Ne().string.isRequired,dashboardId:Ne().number,isDatasourceMetaLoading:Ne().bool.isRequired,chart:Ue.$6.isRequired,slice:Ne().object,sliceName:Ne().string,controls:Ne().object.isRequired,forcedHeight:Ne().string,form_data:Ne().object.isRequired,standalone:Ne().number.isRequired,force:Ne().bool,timeout:Ne().number,impressionId:Ne().string,vizType:Ne().string},xr=ee.iK.div`
  background: ${({theme:e})=>e.colors.grayscale.light5};
  text-align: left;
  position: relative;
  width: 100%;
  max-height: 100%;
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  flex-basis: 100vh;
  align-items: stretch;
  border-top: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
  .explore-column {
    display: flex;
    flex-direction: column;
    padding: ${({theme:e})=>2*e.gridUnit}px 0;
    max-height: 100%;
  }
  .data-source-selection {
    background-color: ${({theme:e})=>e.colors.grayscale.light4};
    padding: ${({theme:e})=>2*e.gridUnit}px 0;
    border-right: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
  }
  .main-explore-content {
    flex: 1;
    min-width: ${({theme:e})=>128*e.gridUnit}px;
    border-left: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    .panel {
      margin-bottom: 0;
    }
  }
  .controls-column {
    align-self: flex-start;
    padding: 0;
  }
  .title-container {
    position: relative;
    display: flex;
    flex-direction: row;
    padding: 0 ${({theme:e})=>2*e.gridUnit}px;
    justify-content: space-between;
    .horizontal-text {
      text-transform: uppercase;
      color: ${({theme:e})=>e.colors.grayscale.light1};
      font-size: ${({theme:e})=>4*e.typography.sizes.s};
    }
  }
  .no-show {
    display: none;
  }
  .vertical-text {
    writing-mode: vertical-rl;
    text-orientation: mixed;
  }
  .sidebar {
    height: 100%;
    background-color: ${({theme:e})=>e.colors.grayscale.light4};
    padding: ${({theme:e})=>2*e.gridUnit}px;
    width: ${({theme:e})=>8*e.gridUnit}px;
  }
  .callpase-icon > svg {
    color: ${({theme:e})=>e.colors.primary.base};
  }
`,Rr=()=>({height:window.innerHeight,width:window.innerWidth}),Nr=m()((async(e,t,a,r,o,n,s)=>{const i={...e},l=e.slice_id,c={};l?c[$e.KD.sliceId.name]=l:c[$e.KD.datasetId.name]=t;const d=(null==i?void 0:i.url_params)||{};Object.entries(d).forEach((([e,t])=>{[$e.KD.sliceId.name,$e.KD.formDataKey.name,$e.KD.datasetId.name].includes(e)||(c[e]=t)}));try{let d,u;a?(d=await(0,ze.nv)(t,e,l,s),u="replaceState"):(d=(0,Pe.e)($e.KD.formDataKey),await(0,ze.LW)(t,d,e,l,s),u="pushState");const h=(0,E.y8)(r?$e.KD.standalone.name:null,{[$e.KD.formDataKey.name]:d,...c},o);window.history[u](i,n,h)}catch(e){Ie.Z.warn("Failed at altering browser history",e)}}),1e3);function Ir(e){const t=(0,X.gp)().dynamicPlugins[e.vizType],a=t&&t.mounting,r=(0,Me.D)(a),n=(0,Me.D)(e.controls),[s,i]=(0,o.useState)(e.controls),l=function({delayMs:e=250}={}){const[t,a]=(0,o.useState)(Rr());return(0,o.useEffect)((()=>{const t=m()((()=>a(Rr())),e);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}),[]),t}(),[c,d]=(0,o.useState)(!1),[u,h]=(0,o.useState)(!1),[f,b]=(0,o.useState)(-1),g=(0,Ve.z)(),v=(0,ee.Fg)(),_=`${l.width}px`,S=e.standalone?0:90,Z=e.forcedHeight?`${e.forcedHeight}px`:l.height-S+"px",E={controls_width:320,datasource_width:300},C=(0,o.useCallback)((async({isReplace:t=!1,title:a}={})=>{const r=e.dashboardId?{...e.form_data,dashboardId:e.dashboardId}:e.form_data,o=e.datasource.id;Nr(r,o,t,e.standalone,e.force,a,g)}),[e.dashboardId,e.form_data,e.datasource.id,e.standalone,e.force,g]),R=(0,o.useCallback)((()=>{const t=window.history.state;t&&Object.keys(t).length&&(e.actions.setExploreControls(t),e.actions.postChartFormData(t,e.force,e.timeout,e.chart.id))}),[e.actions,e.chart.id,e.timeout]),N=(0,o.useCallback)((()=>{e.actions.triggerQuery(!0,e.chart.id),C(),i(e.controls)}),[e.controls,C,e.actions,e.chart.id]),I=(0,o.useCallback)((t=>{if(t.ctrlKey||t.metaKey){const a="Enter"===t.key||13===t.keyCode,r="s"===t.key||83===t.keyCode;a?N():r&&e.slice&&e.actions.saveSlice(e.form_data,{action:"overwrite",slice_id:e.slice.slice_id,slice_name:e.slice.slice_name,add_to_dash:"noSave",goto_dash:!1}).then((({data:e})=>{window.location=e.slice.slice_url}))}}),[N,e.actions,e.form_data,e.slice]);function A(){d(!c)}function D(){h(!u)}(0,je.J)((()=>{e.actions.logEvent(p.$b)})),(0,De.S)(g,((e,t)=>{t&&C({isReplace:!0})}));const k=(0,Me.D)(R);(0,o.useEffect)((()=>(k&&window.removeEventListener("popstate",k),window.addEventListener("popstate",R),()=>{window.removeEventListener("popstate",R)})),[R,k]);const M=(0,Me.D)(I);(0,o.useEffect)((()=>(M&&window.removeEventListener("keydown",M),document.addEventListener("keydown",I),()=>{document.removeEventListener("keydown",I)})),[I,M]),(0,o.useEffect)((()=>{r&&!a&&e.actions.dynamicPluginControlsReady()}),[a]),(0,o.useEffect)((()=>{Object.values(e.controls).some((e=>e.validationErrors&&e.validationErrors.length>0))||e.actions.triggerQuery(!0,e.chart.id)}),[]);const j=()=>{e.actions.updateQueryFormData((0,T.Hu)(e.controls),e.chart.id),e.actions.renderTriggered((new Date).getTime(),e.chart.id),C()};(0,o.useEffect)((()=>{n&&(!e.controls.datasource||null!=n.datasource&&e.controls.datasource.value===n.datasource.value||(0,Le.QR)(e.form_data.datasource,!0),Object.keys(e.controls).filter((t=>void 0!==n[t]&&!(0,y.JB)(e.controls[t].value,n[t].value))).some((t=>e.controls[t].renderTrigger))&&j())}),[e.controls,e.ownState]);const $=(0,o.useMemo)((()=>!!s&&Object.keys(e.controls).filter((t=>void 0!==s[t]&&!(0,y.JB)(e.controls[t].value,s[t].value))).some((t=>!e.controls[t].renderTrigger&&!e.controls[t].dontRefreshOnChange))),[s,e.controls]);function P(){const t=Object.values(e.controls).filter((e=>e.validationErrors&&e.validationErrors.length>0));if(0===t.length)return null;const a=t.map((e=>e.validationErrors)),r=[...new Set(a.flat())].map((e=>[t.filter((t=>{var a;return null==(a=t.validationErrors)?void 0:a.includes(e)})).map((e=>e.label)),e])).map((([e,t])=>(0,te.tZ)("div",{key:t},e.length>1?(0,be.t)("Controls labeled "):(0,be.t)("Control labeled "),(0,te.tZ)("strong",null,` ${e.join(", ")}`),(0,te.tZ)("span",null,": ",t))));let o;return r.length>0&&(o=(0,te.tZ)("div",{style:{textAlign:"left"}},r)),o}function L(){return(0,te.tZ)(Va,Se()({width:_,height:Z},e,{errorMessage:P(),refreshOverlayVisible:$,onQuery:N}))}function U(e){return O(e,E[e])}function F(e,t){x(e,Number(U(e))+t.width)}return(0,o.useEffect)((()=>{void 0!==e.ownState&&(N(),j())}),[e.ownState]),$&&e.actions.logEvent(p.Ep),e.standalone?L():(0,te.tZ)(xr,{id:"explore-container",height:Z},(0,te.tZ)(te.xB,{styles:te.iv`
          .navbar {
            margin-bottom: 0;
          }
          body {
            height: 100vh;
            max-height: 100vh;
            overflow: hidden;
          }
          #app-menu,
          #app {
            flex: 1 1 auto;
          }
          #app {
            flex-basis: 100%;
            overflow: hidden;
            height: 100%;
          }
          #app-menu {
            flex-shrink: 0;
          }
        `}),c&&(0,te.tZ)(ur,{onHide:A,actions:e.actions,form_data:e.form_data,sliceName:e.sliceName,dashboardId:e.dashboardId}),(0,te.tZ)(Ae.e,{onResizeStop:(e,t,a,r)=>{b(null==r?void 0:r.width),F(w.datasource_width,r)},defaultSize:{width:U(w.datasource_width),height:"100%"},minWidth:E[w.datasource_width],maxWidth:"33%",enable:{right:!0},className:u?"no-show":"explore-column data-source-selection"},(0,te.tZ)("div",{className:"title-container"},(0,te.tZ)("span",{className:"horizont al-text"},(0,be.t)("Dataset")),(0,te.tZ)("span",{role:"button",tabIndex:0,className:"action-button",onClick:D},(0,te.tZ)(ne.Z.Expand,{className:"collapse-icon",iconColor:v.colors.primary.base,iconSize:"l"}))),(0,te.tZ)(Tr,{datasource:e.datasource,controls:e.controls,actions:e.actions,shouldForceUpdate:f})),u?(0,te.tZ)("div",{className:"sidebar",onClick:D,role:"button",tabIndex:0},(0,te.tZ)("span",{role:"button",tabIndex:0,className:"action-button"},(0,te.tZ)(ke.u,{title:(0,be.t)("Open Datasource tab")},(0,te.tZ)(ne.Z.Collapse,{className:"collapse-icon",iconColor:v.colors.primary.base,iconSize:"l"}))),(0,te.tZ)(ne.Z.DatasetPhysical,{css:(0,te.iv)({marginTop:2*v.gridUnit},"",""),iconSize:"l",iconColor:v.colors.grayscale.base})):null,(0,te.tZ)(Ae.e,{onResizeStop:(e,t,a,r)=>F(w.controls_width,r),defaultSize:{width:U(w.controls_width),height:"100%"},minWidth:E[w.controls_width],maxWidth:"33%",enable:{right:!0},className:"col-sm-3 explore-column controls-column"},(0,te.tZ)(pr,{canAdd:!(!e.can_add&&!e.can_overwrite),onQuery:N,onSave:A,onStop:function(){e.chart&&e.chart.queryController&&e.chart.queryController.abort()},loading:"loading"===e.chart.chartStatus,chartIsStale:$,errorMessage:P(),datasourceType:e.datasource_type}),(0,te.tZ)(ar,{exploreState:e.exploreState,actions:e.actions,form_data:e.form_data,controls:e.controls,chart:e.chart,datasource_type:e.datasource_type,isDatasourceMetaLoading:e.isDatasourceMetaLoading})),(0,te.tZ)("div",{className:re()("main-explore-content",u?"col-sm-9":"col-sm-7")},L()))}Ir.propTypes=Or;const Ar=(0,Q.$j)((function(e){var t,a,r,o;const{explore:n,charts:s,impressionId:i,dataMask:l,reports:c}=e,d=(0,T.Hu)(n.controls);d.extra_form_data=(0,Fe.on)({...d.extra_form_data},{...null==(t=l[null!=(a=d.slice_id)?a:0])?void 0:t.ownState});const u=s[Object.keys(s)[0]];return{isDatasourceMetaLoading:n.isDatasourceMetaLoading,datasource:n.datasource,datasource_type:n.datasource.type,datasourceId:n.datasource_id,dashboardId:n.form_data?n.form_data.dashboardId:void 0,controls:n.controls,can_overwrite:!!n.can_overwrite,can_add:!!n.can_add,can_download:!!n.can_download,column_formats:n.datasource?n.datasource.column_formats:null,containerId:n.slice?`slice-container-${n.slice.slice_id}`:"slice-container",isStarred:n.isStarred,slice:n.slice,sliceName:n.sliceName,triggerRender:n.triggerRender,form_data:d,table_name:d.datasource_name,vizType:d.viz_type,standalone:n.standalone,force:n.force,forcedHeight:n.forced_height,chart:u,timeout:n.common.conf.SUPERSET_WEBSERVER_TIMEOUT,ownState:null==(r=l[null!=(o=d.slice_id)?o:0])?void 0:r.ownState,impressionId:i,user:n.user,exploreState:n,reports:c}}),(function(e){const t={...K,...r,...H,...h};return{actions:(0,s.DE)(t,e)}}))(Ir);he()(document).ready((function(){he()(":checkbox[data-checkbox-api-prefix]").change((function(){const e=he()(this);var t,a;t=e.data("checkbox-api-prefix"),a=`#${e.attr("id")}`,d.Z.get({endpoint:t+he()(a)[0].checked}).then((()=>{})).catch((e=>(0,pe.O)(e).then((e=>{e&&e.message&&function(e){const t=e.severity||"info";he()('<div class="alert"> <button type="button" class="close" data-dismiss="alert">×</button> </div>').addClass(`alert-${t}`).append(e.message||"").appendTo(he()("#alert-container"))}(e)}))))})),he()("#language-picker a").click((function(e){e.preventDefault(),d.Z.get({url:e.currentTarget.href,parseMethod:null}).then((()=>{window.location.reload()}))}))})),window.$=he(),window.jQuery=he(),a(57915),function(){const e=(0,fe.Z)();e.registerValue(me.C.FRONTEND_TIMEOUT_ERROR,ye),e.registerValue(me.C.BACKEND_TIMEOUT_ERROR,ye),e.registerValue(me.C.DATABASE_NOT_FOUND_ERROR,Ze),e.registerValue(me.C.GENERIC_DB_ENGINE_ERROR,Ze),e.registerValue(me.C.GENERIC_BACKEND_ERROR,Ze),e.registerValue(me.C.COLUMN_DOES_NOT_EXIST_ERROR,Ze),e.registerValue(me.C.TABLE_DOES_NOT_EXIST_ERROR,Ze),e.registerValue(me.C.MISSING_TEMPLATE_PARAMS_ERROR,Ce),e.registerValue(me.C.INVALID_TEMPLATE_PARAMS_ERROR,Ce),e.registerValue(me.C.RESULTS_BACKEND_NOT_CONFIGURED_ERROR,Ze),e.registerValue(me.C.DML_NOT_ALLOWED_ERROR,Ze),e.registerValue(me.C.INVALID_CTAS_QUERY_ERROR,Ze),e.registerValue(me.C.INVALID_CVAS_QUERY_ERROR,Ze),e.registerValue(me.C.QUERY_SECURITY_ACCESS_ERROR,Ze),e.registerValue(me.C.CONNECTION_INVALID_HOSTNAME_ERROR,Ze),e.registerValue(me.C.RESULTS_BACKEND_ERROR,Ze),e.registerValue(me.C.ASYNC_WORKERS_ERROR,Ze),e.registerValue(me.C.SQLLAB_TIMEOUT_ERROR,Ze),e.registerValue(me.C.CONNECTION_PORT_CLOSED_ERROR,Ze),e.registerValue(me.C.CONNECTION_HOST_DOWN_ERROR,Ze),e.registerValue(me.C.CONNECTION_INVALID_USERNAME_ERROR,Ze),e.registerValue(me.C.CONNECTION_INVALID_PASSWORD_ERROR,Ze),e.registerValue(me.C.CONNECTION_ACCESS_DENIED_ERROR,Ze),e.registerValue(me.C.CONNECTION_UNKNOWN_DATABASE_ERROR,Ze),e.registerValue(me.C.SCHEMA_DOES_NOT_EXIST_ERROR,Ze),e.registerValue(me.C.OBJECT_DOES_NOT_EXIST_ERROR,Ze),e.registerValue(me.C.SYNTAX_ERROR,Ze),e.registerValue(me.C.CONNECTION_DATABASE_PERMISSIONS_ERROR,Ze),e.registerValue(me.C.FAILED_FETCHING_DATASOURCE_INFO_ERROR,Te)}(),(0,Oe.Z)();const Dr=document.getElementById("app"),kr=JSON.parse(Dr.getAttribute("data-bootstrap"));(0,v.fG)(kr.common.feature_flags);const Mr=function(e){const{form_data:t}=e,{slice:a}=e,r=a?a.slice_name:null,o={...e,sliceName:r,common:{flash_messages:e.common.flash_messages,conf:e.common.conf},isDatasourceMetaLoading:!1,isStarred:!1,controls:(0,C.R3)(e,t),controlsTransferred:[],timeFormattedColumns:O(w.explore__data_table_time_formatted_columns,{})};Object.entries(o.controls).forEach((([e,t])=>{o.controls[e]=(0,T.RO)(t,o)}));const n=a?(0,T.Hu)((0,C.R3)(e,a.form_data)):null,s=(0,E.Jp)(e);return{charts:{[s]:{id:s,chartAlert:null,chartStatus:null,chartStackTrace:null,chartUpdateEndTime:null,chartUpdateStartTime:0,latestQueryFormData:(0,T.Hu)(o.controls),sliceFormData:n,queryController:null,queriesResponse:null,triggerQuery:!1,lastRendered:0}},saveModal:{dashboards:[],saveModalAlert:null},explore:o,impressionId:c().generate(),messageToasts:Z((e.common||{}).flash_messages||[])}}(kr),jr=(0,s.MT)(W,Mr,(0,s.qC)((0,s.md)(i.Z,(e=>t=>a=>{var r;if(a.type!==h.LOG_EVENT)return t(a);const{dashboardInfo:o,explore:n,impressionId:s,dashboardLayout:i}=e.getState();let l={impression_id:s,version:"v2"};o?l={source:"dashboard",source_id:o.id,...l}:n&&(l={source:"explore",source_id:n.slice?n.slice.slice_id:0,...l});const{eventName:d}=a.payload;let{eventData:u={}}=a.payload;if(u={...l,ts:(new Date).getTime(),event_name:d,...u},p.TY.has(d)?u={...u,event_type:"timing",trigger_event:g}:(g=c().generate(),u={...u,event_type:"user",event_id:g,visibility:document.visibilityState}),u.target_id&&null!=i&&null!=(r=i.present)&&r[u.target_id]){const{meta:e}=i.present[u.target_id];u.target_name=e.chartId?e.sliceName:e.text}return b.append(u),u})),(0,y.hU)(!1)));n.render((0,te.tZ)((({store:e})=>(0,te.tZ)(Q.zt,{store:e},(0,te.tZ)(G.W,{backend:J.PD},(0,te.tZ)(Y.a,{theme:xe.r},(0,te.tZ)(X.EM,null,(0,te.tZ)(Ar,null),(0,te.tZ)(de,null)))))),{store:jr}),document.getElementById("app"))},61358:(e,t,a)=>{"use strict";a.d(t,{jt:()=>l,Aw:()=>c,J8:()=>u,cq:()=>h,Dr:()=>p,Me:()=>f,M:()=>m,MZ:()=>b});var r=a(31069),o=a(61988),n=a(15926),s=a.n(n),i=a(72570);const l="SET_REPORT";function c(e,t,a,n){const c=s().encode({filters:[{col:t,opr:"eq",value:n},{col:"creation_method",opr:"eq",value:a},{col:"created_by",opr:"rel_o_m",value:e}]});return function(e){return r.Z.get({endpoint:`/api/v1/report/?q=${c}`}).then((({json:t})=>{e({type:l,report:t})})).catch((()=>e((0,i.Gb)((0,o.t)("There was an issue fetching reports attached to this dashboard.")))))}}const d=(e,t)=>{const a=t(),{user:r,dashboardInfo:o,charts:n,explore:s}=a;if(o)e(c(r.userId,"dashboard_id","dashboards",o.id));else{const[t]=Object.keys(n);e(c(s.user.userId,"chart_id","charts",n[t].id))}},u="ADD_REPORT",h=e=>t=>r.Z.post({endpoint:"/api/v1/report/",jsonPayload:e}).then((({json:e})=>{t({type:u,json:e}),t((0,i.ws)((0,o.t)("The report has been created")))})),p="EDIT_REPORT";function f(e,t){return function(a){r.Z.put({endpoint:`/api/v1/report/${e}`,jsonPayload:t}).then((({json:e})=>{a({type:p,json:e})})).catch((()=>a((0,i.Gb)((0,o.t)("An error occurred while editing this report.")))))}}function m(e,t){return function(a){return r.Z.put({endpoint:encodeURI(`/api/v1/report/${e.id}`),headers:{"Content-Type":"application/json"},body:JSON.stringify({active:t})}).catch((()=>{a((0,i.Gb)((0,o.t)("We were unable to active or deactivate this report.")))})).finally((()=>{a(d)}))}}function b(e){return function(t){return r.Z.delete({endpoint:encodeURI(`/api/v1/report/${e.id}`)}).catch((()=>{t((0,i.Gb)((0,o.t)("Your report could not be deleted")))})).finally((()=>{t(d),t((0,i.ws)((0,o.t)("Deleted: %s",e.name)))}))}}},91296:(e,t,a)=>{var r=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,s=/^0o[0-7]+$/i,i=parseInt,l="object"==typeof a.g&&a.g&&a.g.Object===Object&&a.g,c="object"==typeof self&&self&&self.Object===Object&&self,d=l||c||Function("return this")(),u=Object.prototype.toString,h=Math.max,p=Math.min,f=function(){return d.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var a=n.test(e);return a||s.test(e)?i(e.slice(2),a?2:8):o.test(e)?NaN:+e}e.exports=function(e,t,a){var r,o,n,s,i,l,c=0,d=!1,u=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var a=r,n=o;return r=o=void 0,c=t,s=e.apply(n,a)}function y(e){return c=e,i=setTimeout(S,t),d?v(e):s}function _(e){var a=e-l;return void 0===l||a>=t||a<0||u&&e-c>=n}function S(){var e=f();if(_(e))return Z(e);i=setTimeout(S,function(e){var a=t-(e-l);return u?p(a,n-(e-c)):a}(e))}function Z(e){return i=void 0,g&&r?v(e):(r=o=void 0,s)}function w(){var e=f(),a=_(e);if(r=arguments,o=this,l=e,a){if(void 0===i)return y(l);if(u)return i=setTimeout(S,t),v(l)}return void 0===i&&(i=setTimeout(S,t)),s}return t=b(t)||0,m(a)&&(d=!!a.leading,n=(u="maxWait"in a)?h(b(a.maxWait)||0,t):n,g="trailing"in a?!!a.trailing:g),w.cancel=function(){void 0!==i&&clearTimeout(i),c=0,r=l=o=i=void 0},w.flush=function(){return void 0===i?s:Z(f())},w}},93096:(e,t,a)=>{var r="Expected a function",o=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,i=/^0o[0-7]+$/i,l=parseInt,c="object"==typeof a.g&&a.g&&a.g.Object===Object&&a.g,d="object"==typeof self&&self&&self.Object===Object&&self,u=c||d||Function("return this")(),h=Object.prototype.toString,p=Math.max,f=Math.min,m=function(){return u.Date.now()};function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==h.call(e)}(e))return NaN;if(b(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=b(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var a=s.test(e);return a||i.test(e)?l(e.slice(2),a?2:8):n.test(e)?NaN:+e}e.exports=function(e,t,a){var o=!0,n=!0;if("function"!=typeof e)throw new TypeError(r);return b(a)&&(o="leading"in a?!!a.leading:o,n="trailing"in a?!!a.trailing:n),function(e,t,a){var o,n,s,i,l,c,d=0,u=!1,h=!1,v=!0;if("function"!=typeof e)throw new TypeError(r);function y(t){var a=o,r=n;return o=n=void 0,d=t,i=e.apply(r,a)}function _(e){return d=e,l=setTimeout(Z,t),u?y(e):i}function S(e){var a=e-c;return void 0===c||a>=t||a<0||h&&e-d>=s}function Z(){var e=m();if(S(e))return w(e);l=setTimeout(Z,function(e){var a=t-(e-c);return h?f(a,s-(e-d)):a}(e))}function w(e){return l=void 0,v&&o?y(e):(o=n=void 0,i)}function E(){var e=m(),a=S(e);if(o=arguments,n=this,c=e,a){if(void 0===l)return _(c);if(h)return l=setTimeout(Z,t),y(c)}return void 0===l&&(l=setTimeout(Z,t)),i}return t=g(t)||0,b(a)&&(u=!!a.leading,s=(h="maxWait"in a)?p(g(a.maxWait)||0,t):s,v="trailing"in a?!!a.trailing:v),E.cancel=function(){void 0!==l&&clearTimeout(l),d=0,o=c=n=l=void 0},E.flush=function(){return void 0===l?i:w(m())},E}(e,t,{leading:o,maxWait:t,trailing:n})}},90233:(e,t,a)=>{"use strict";a.d(t,{Lu:()=>l,tL:()=>s});var r=a(87462),o=a(76826),n=a.n(o),s={CASE_SENSITIVE_EQUAL:7,EQUAL:6,STARTS_WITH:5,WORD_STARTS_WITH:4,CONTAINS:3,ACRONYM:2,MATCHES:1,NO_MATCH:0};l.rankings=s;var i=function(e,t){return String(e.rankedValue).localeCompare(String(t.rankedValue))};function l(e,t,a){void 0===a&&(a={});var o=a,n=o.keys,l=o.threshold,d=void 0===l?s.MATCHES:l,h=o.baseSort,f=void 0===h?i:h,m=o.sorter,b=void 0===m?function(e){return e.sort((function(e,t){return function(e,t,a){var r=e.rank,o=e.keyIndex,n=t.rank,s=t.keyIndex;return r===n?o===s?a(e,t):o<s?-1:1:r>n?-1:1}(e,t,f)}))}:m,g=e.reduce((function(e,o,i){var l=function(e,t,a,r){return t?function(e,t){for(var a=[],r=0,o=t.length;r<o;r++)for(var n=t[r],s=p(n),i=u(e,n),l=0,c=i.length;l<c;l++)a.push({itemValue:i[l],attributes:s});return a}(e,t).reduce((function(e,t,o){var n=e.rank,i=e.rankedValue,l=e.keyIndex,d=e.keyThreshold,u=t.itemValue,h=t.attributes,p=c(u,a,r),f=i,m=h.minRanking,b=h.maxRanking,g=h.threshold;return p<m&&p>=s.MATCHES?p=m:p>b&&(p=b),p>n&&(n=p,l=o,d=g,f=u),{rankedValue:f,rank:n,keyIndex:l,keyThreshold:d}}),{rankedValue:e,rank:s.NO_MATCH,keyIndex:-1,keyThreshold:r.threshold}):{rankedValue:e,rank:c(e,a,r),keyIndex:-1,keyThreshold:r.threshold}}(o,n,t,a),h=l.rank,f=l.keyThreshold;return h>=(void 0===f?d:f)&&e.push((0,r.Z)({},l,{item:o,index:i})),e}),[]);return b(g).map((function(e){return e.item}))}function c(e,t,a){return e=d(e,a),(t=d(t,a)).length>e.length?s.NO_MATCH:e===t?s.CASE_SENSITIVE_EQUAL:(e=e.toLowerCase())===(t=t.toLowerCase())?s.EQUAL:e.startsWith(t)?s.STARTS_WITH:e.includes(" "+t)?s.WORD_STARTS_WITH:e.includes(t)?s.CONTAINS:1===t.length?s.NO_MATCH:(r=e,o="",r.split(" ").forEach((function(e){e.split("-").forEach((function(e){o+=e.substr(0,1)}))})),o).includes(t)?s.ACRONYM:function(e,t){var a=0,r=0;function o(e,t,r){for(var o=r,n=t.length;o<n;o++)if(t[o]===e)return a+=1,o+1;return-1}var n,i,l=o(t[0],e,0);if(l<0)return s.NO_MATCH;r=l;for(var c=1,d=t.length;c<d;c++)if(!((r=o(t[c],e,r))>-1))return s.NO_MATCH;return n=1/(r-l),i=a/t.length,s.MATCHES+i*n}(e,t);var r,o}function d(e,t){return e=""+e,t.keepDiacritics||(e=n()(e)),e}function u(e,t){var a;if("object"==typeof t&&(t=t.key),"function"==typeof t)a=t(e);else if(null==e)a=null;else if(Object.hasOwnProperty.call(e,t))a=e[t];else{if(t.includes("."))return function(e,t){for(var a=e.split("."),r=[t],o=0,n=a.length;o<n;o++){for(var s=a[o],i=[],l=0,c=r.length;l<c;l++){var d=r[l];if(null!=d)if(Object.hasOwnProperty.call(d,s)){var u=d[s];null!=u&&i.push(u)}else"*"===s&&(i=i.concat(d))}r=i}if(Array.isArray(r[0])){var h=[];return h.concat.apply(h,r)}return r}(t,e);a=null}return null==a?[]:Array.isArray(a)?a:[String(a)]}var h={maxRanking:1/0,minRanking:-1/0};function p(e){return"string"==typeof e?h:(0,r.Z)({},h,e)}},76826:e=>{var t={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",Ấ:"A",Ắ:"A",Ẳ:"A",Ẵ:"A",Ặ:"A",Æ:"AE",Ầ:"A",Ằ:"A",Ȃ:"A",Ç:"C",Ḉ:"C",È:"E",É:"E",Ê:"E",Ë:"E",Ế:"E",Ḗ:"E",Ề:"E",Ḕ:"E",Ḝ:"E",Ȇ:"E",Ì:"I",Í:"I",Î:"I",Ï:"I",Ḯ:"I",Ȋ:"I",Ð:"D",Ñ:"N",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",Ố:"O",Ṍ:"O",Ṓ:"O",Ȏ:"O",Ù:"U",Ú:"U",Û:"U",Ü:"U",Ý:"Y",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",ấ:"a",ắ:"a",ẳ:"a",ẵ:"a",ặ:"a",æ:"ae",ầ:"a",ằ:"a",ȃ:"a",ç:"c",ḉ:"c",è:"e",é:"e",ê:"e",ë:"e",ế:"e",ḗ:"e",ề:"e",ḕ:"e",ḝ:"e",ȇ:"e",ì:"i",í:"i",î:"i",ï:"i",ḯ:"i",ȋ:"i",ð:"d",ñ:"n",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",ố:"o",ṍ:"o",ṓ:"o",ȏ:"o",ù:"u",ú:"u",û:"u",ü:"u",ý:"y",ÿ:"y",Ā:"A",ā:"a",Ă:"A",ă:"a",Ą:"A",ą:"a",Ć:"C",ć:"c",Ĉ:"C",ĉ:"c",Ċ:"C",ċ:"c",Č:"C",č:"c",C̆:"C",c̆:"c",Ď:"D",ď:"d",Đ:"D",đ:"d",Ē:"E",ē:"e",Ĕ:"E",ĕ:"e",Ė:"E",ė:"e",Ę:"E",ę:"e",Ě:"E",ě:"e",Ĝ:"G",Ǵ:"G",ĝ:"g",ǵ:"g",Ğ:"G",ğ:"g",Ġ:"G",ġ:"g",Ģ:"G",ģ:"g",Ĥ:"H",ĥ:"h",Ħ:"H",ħ:"h",Ḫ:"H",ḫ:"h",Ĩ:"I",ĩ:"i",Ī:"I",ī:"i",Ĭ:"I",ĭ:"i",Į:"I",į:"i",İ:"I",ı:"i",Ĳ:"IJ",ĳ:"ij",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",Ḱ:"K",ḱ:"k",K̆:"K",k̆:"k",Ĺ:"L",ĺ:"l",Ļ:"L",ļ:"l",Ľ:"L",ľ:"l",Ŀ:"L",ŀ:"l",Ł:"l",ł:"l",Ḿ:"M",ḿ:"m",M̆:"M",m̆:"m",Ń:"N",ń:"n",Ņ:"N",ņ:"n",Ň:"N",ň:"n",ŉ:"n",N̆:"N",n̆:"n",Ō:"O",ō:"o",Ŏ:"O",ŏ:"o",Ő:"O",ő:"o",Œ:"OE",œ:"oe",P̆:"P",p̆:"p",Ŕ:"R",ŕ:"r",Ŗ:"R",ŗ:"r",Ř:"R",ř:"r",R̆:"R",r̆:"r",Ȓ:"R",ȓ:"r",Ś:"S",ś:"s",Ŝ:"S",ŝ:"s",Ş:"S",Ș:"S",ș:"s",ş:"s",Š:"S",š:"s",Ţ:"T",ţ:"t",ț:"t",Ț:"T",Ť:"T",ť:"t",Ŧ:"T",ŧ:"t",T̆:"T",t̆:"t",Ũ:"U",ũ:"u",Ū:"U",ū:"u",Ŭ:"U",ŭ:"u",Ů:"U",ů:"u",Ű:"U",ű:"u",Ų:"U",ų:"u",Ȗ:"U",ȗ:"u",V̆:"V",v̆:"v",Ŵ:"W",ŵ:"w",Ẃ:"W",ẃ:"w",X̆:"X",x̆:"x",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Y̆:"Y",y̆:"y",Ź:"Z",ź:"z",Ż:"Z",ż:"z",Ž:"Z",ž:"z",ſ:"s",ƒ:"f",Ơ:"O",ơ:"o",Ư:"U",ư:"u",Ǎ:"A",ǎ:"a",Ǐ:"I",ǐ:"i",Ǒ:"O",ǒ:"o",Ǔ:"U",ǔ:"u",Ǖ:"U",ǖ:"u",Ǘ:"U",ǘ:"u",Ǚ:"U",ǚ:"u",Ǜ:"U",ǜ:"u",Ứ:"U",ứ:"u",Ṹ:"U",ṹ:"u",Ǻ:"A",ǻ:"a",Ǽ:"AE",ǽ:"ae",Ǿ:"O",ǿ:"o",Þ:"TH",þ:"th",Ṕ:"P",ṕ:"p",Ṥ:"S",ṥ:"s",X́:"X",x́:"x",Ѓ:"Г",ѓ:"г",Ќ:"К",ќ:"к",A̋:"A",a̋:"a",E̋:"E",e̋:"e",I̋:"I",i̋:"i",Ǹ:"N",ǹ:"n",Ồ:"O",ồ:"o",Ṑ:"O",ṑ:"o",Ừ:"U",ừ:"u",Ẁ:"W",ẁ:"w",Ỳ:"Y",ỳ:"y",Ȁ:"A",ȁ:"a",Ȅ:"E",ȅ:"e",Ȉ:"I",ȉ:"i",Ȍ:"O",ȍ:"o",Ȑ:"R",ȑ:"r",Ȕ:"U",ȕ:"u",B̌:"B",b̌:"b",Č̣:"C",č̣:"c",Ê̌:"E",ê̌:"e",F̌:"F",f̌:"f",Ǧ:"G",ǧ:"g",Ȟ:"H",ȟ:"h",J̌:"J",ǰ:"j",Ǩ:"K",ǩ:"k",M̌:"M",m̌:"m",P̌:"P",p̌:"p",Q̌:"Q",q̌:"q",Ř̩:"R",ř̩:"r",Ṧ:"S",ṧ:"s",V̌:"V",v̌:"v",W̌:"W",w̌:"w",X̌:"X",x̌:"x",Y̌:"Y",y̌:"y",A̧:"A",a̧:"a",B̧:"B",b̧:"b",Ḑ:"D",ḑ:"d",Ȩ:"E",ȩ:"e",Ɛ̧:"E",ɛ̧:"e",Ḩ:"H",ḩ:"h",I̧:"I",i̧:"i",Ɨ̧:"I",ɨ̧:"i",M̧:"M",m̧:"m",O̧:"O",o̧:"o",Q̧:"Q",q̧:"q",U̧:"U",u̧:"u",X̧:"X",x̧:"x",Z̧:"Z",z̧:"z"},a=Object.keys(t).join("|"),r=new RegExp(a,"g"),o=new RegExp(a,""),n=function(e){return e.replace(r,(function(e){return t[e]}))};e.exports=n,e.exports.has=function(e){return!!e.match(o)},e.exports.remove=n},67994:(e,t,a)=>{"use strict";a.d(t,{hb:()=>p,QU:()=>f,Es:()=>m,JL:()=>b});var r,o=a(22102),n=a(67294);!function(e){e.LOADING="loading",e.COMPLETE="complete",e.ERROR="error"}(r||(r={}));const s={status:r.LOADING,result:null,error:null};function i(e,t){return(0,n.useMemo)((()=>{if(e.status!==r.COMPLETE)return e;try{return{...e,result:t(e.result)}}catch(e){return{status:r.ERROR,result:null,error:e}}}),[e,t])}const l=e=>e.result;function c(e){return i(function(e){const[t,a]=(0,n.useState)(s),i=(0,n.useRef)((()=>{}));return(0,n.useEffect)((()=>{a(s),i.current();let t=!1;return i.current=()=>{t=!0},(0,o.Z)({method:"GET",endpoint:e})({}).then((e=>{t||a({status:r.COMPLETE,result:e,error:null})})).catch((e=>{t||a({status:r.ERROR,result:null,error:e})})),()=>{t=!0}}),[e]),t}(e),l)}var d=a(15926);function u({owners:e}){return e?e.map((e=>`${e.first_name} ${e.last_name}`)):null}const h=a.n(d)().encode({columns:["owners.first_name","owners.last_name"],keys:["none"]});function p(e){return i(c(`/api/v1/chart/${e}?q=${h}`),u)}const f=e=>i(c(`/api/v1/dashboard/${e}`),(e=>({...e,metadata:e.json_metadata&&JSON.parse(e.json_metadata)||{},position_data:e.position_json&&JSON.parse(e.position_json)}))),m=e=>c(`/api/v1/dashboard/${e}/charts`),b=e=>c(`/api/v1/dashboard/${e}/datasets`)},33626:(e,t,a)=>{"use strict";a.d(t,{J:()=>o});var r=a(67294);const o=e=>{(0,r.useEffect)(e,[])}}},l={};function c(e){var t=l[e];if(void 0!==t)return t.exports;var a=l[e]={id:e,loaded:!1,exports:{}};return i[e].call(a.exports,a,a.exports,c),a.loaded=!0,a.exports}c.m=i,c.amdD=function(){throw new Error("define cannot be used indirect")},c.amdO={},e=[],c.O=(t,a,r,o)=>{if(!a){var n=1/0;for(d=0;d<e.length;d++){for(var[a,r,o]=e[d],s=!0,i=0;i<a.length;i++)(!1&o||n>=o)&&Object.keys(c.O).every((e=>c.O[e](a[i])))?a.splice(i--,1):(s=!1,o<n&&(n=o));if(s){e.splice(d--,1);var l=r();void 0!==l&&(t=l)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[a,r,o]},c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},a=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,c.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var o=Object.create(null);c.r(o);var n={};t=t||[null,a({}),a([]),a(a)];for(var s=2&r&&e;"object"==typeof s&&!~t.indexOf(s);s=a(s))Object.getOwnPropertyNames(s).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,c.d(o,n),o},c.d=(e,t)=>{for(var a in t)c.o(t,a)&&!c.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},c.f={},c.e=e=>Promise.all(Object.keys(c.f).reduce(((t,a)=>(c.f[a](e,t),t)),[])),c.u=e=>4593===e?"4593.2781346fcc306d505925.entry.js":2441===e?"2441.cf2d2dd99eca21c7005d.entry.js":{57:"3eef258f00447ab2ba56",112:"881dd2510f19ed31e172",158:"488593bc94ab7caa58e0",177:"4b03c272091be7836683",183:"3f0101a74920ebdf5721",215:"abe0f2a4a3f69594f00c",310:"77d6d4c65a4250a67f54",312:"ba5d653bdbc1bcc11798",326:"7f70cded66eafbdda58b",336:"f4bdd4f606d6d7592f7e",347:"5c3072822b5d502ad29e",349:"31b11e55a94ab02f4dfe",363:"210381fc4c2bbae6d099",380:"78b7b6dc715440560460",435:"d80842b3792be4e68b96",440:"515662946aea2cdc4413",444:"fa4262dbba7f89704a67",597:"20b87c137727ff9aaf87",600:"044558ce92babe1fa2db",616:"352f03339c5c93d38ec9",704:"01d4ae00af20f1daa096",775:"e0157cc29d192ef787e1",826:"0e2f19bbb57b5a8aff83",895:"1f77c3c8dcb2024e6e96",954:"60c8e389f3d779b44283",992:"d71578d87db841083c93",999:"ce189cf323818358d600",1020:"72ffbeec3df47e34e0e0",1075:"2572ea51a4adfc4ff9a4",1095:"b533f258ca6b1a324379",1130:"2677215c8388b1ee186e",1174:"1033573182d374214540",1185:"63e33afadbeb6e51d8dd",1221:"b9936995d898af34e03c",1256:"035f322d4ce964f73de1",1258:"6381160c0229525565fd",1263:"cfe95e8e20298feb874e",1293:"14b3a7ee4cc17de5c441",1351:"2eb1a9ba1648eb7a8193",1382:"dff5a1149875c367ecda",1398:"0c371615e0996614785c",1493:"0c0664678b66d74ba38f",1497:"f64aaa6444c4f5d90950",1568:"b2bb81324e29ed5bce61",1573:"c893b7f636a2ab701c65",1605:"d6a140bf5e3bef201212",1862:"8b03e8bb1c84992cbf32",1877:"e33515e5bd6542b94f77",1899:"e1eb313fc03e90fa0d70",1948:"e8e04804b69cd452fcc9",2045:"2e374ea725d1d98f2dc1",2079:"579cd7268aa39862c290",2089:"13db7039a066b543f45a",2105:"02df5ff9f97c181f9de4",2112:"1d1b4aaac5752d48445e",2229:"269edba5d424763bd5d0",2264:"5a90b87bf6c82cddd60f",2267:"58a5465f711b4c6b0f0c",2403:"ff967bce10197be4d6e0",2439:"92ff10820007284a3594",2646:"3dcaf7b2edc6b26550ba",2698:"e7b7a6eeb3966de7d0c1",2713:"a68c27cd1e12e64ffed4",2797:"5db241c8af5a71f0f30d",2983:"8afbd45ac5fc6d8b4b6d",3126:"db7e749de1e103f1aff8",3141:"494a0ca0a1bb39f625bd",3208:"2afd52e561441bd5beb3",3232:"da20088427ef3c3faab7",3240:"e7218edd46dedf7e1dda",3265:"1671e36958a7bf6f4cfc",3325:"9295baeedc623870f610",3496:"96d921452945099f3fb5",3501:"b1f59c8250c7436d58a1",3544:"0fb4e4d961165cd76e18",3558:"e2f6e711a397fa768c21",3567:"d77d0432d12254aeeded",3606:"0b65905a659b39cd6909",3711:"25273648b8922cf74177",3745:"03ab023678c0223d3569",3749:"9d45482bb7e08b4be181",3811:"dd0d3e1829322848d982",3871:"b94982d813b3a1874fe0",3955:"afc2c2846692569a5718",3985:"f293395f2172b1317b51",3986:"b65058c809eb4184aab8",4139:"285945130a72bfc46e1d",4194:"0e16885080d878e0abd0",4266:"5b30930400b0988390e0",4273:"7ddbd55189a7899df93c",4458:"4309988c3c4fa37de107",4474:"b598fc6c061ecd9e6b0d",4572:"4bb1960b110d195d1658",4579:"16ca3c26d224ec2bea51",4625:"51252df40a568e9858e9",4662:"b32dd6447e5fae270c83",4667:"48c3843ffce6d71edad4",4732:"40416b4ab4e61de326ae",4757:"93d740911bd493adf140",4758:"139bfe0e5a3d55b967f5",4790:"3850915a2078c59355aa",4794:"604a01412367c61f28d1",4797:"ec310aed295dd6ac6d3e",4810:"c9e88f8bb26309aea9a3",4817:"c6d5f79ba80cd01dc865",4832:"ef14aea5648058059b49",4851:"ddfa921c0ae9aa3cc18b",4972:"c5b4433dc989f0536983",4981:"a591e398113e3a68af10",5094:"93746d02dfb8f501e300",5181:"47ac75a7d55a7915f8bf",5201:"3ec18a3a291224aa9108",5215:"d96d8f48f1ace1189109",5224:"c47e9d538010833596c1",5226:"6827078f00442327de34",5249:"666b274dce41432ba44f",5264:"3e22171712f6f2b56160",5281:"bee09c165592668d3f89",5330:"599272faeb108b72e7f9",5335:"8aa0878ebf5d4ad6ce59",5350:"074a558227a6662abcb5",5359:"2b8c50de5d5c4b38aca0",5367:"21ae5e3e001039f857b3",5507:"f70d497b4e7632b6cc22",5580:"24915749e40e9d761a9c",5592:"e87311d9b096af643f33",5605:"2175473641dbadf3144f",5641:"38809faee0024a508b21",5707:"147d8ca4332836cd578d",5771:"1052f585ff4ae106bee8",5777:"554d568382eb31588d65",5802:"6cc12bb8302843f1d8f2",5816:"280673beea0b5f2fd1e1",5832:"0c735281dd62de64b370",5838:"dbba442e12c14d0a2a2e",5962:"72dc9794359fb77a60d2",5972:"19c7fc52abf01d211d54",5998:"1ee3b4651923335492d5",6061:"55bf4311a87981b3e733",6126:"91fa0738674c868ec8cc",6150:"dc68c567fc3c38729c6e",6167:"d6258818427262c45fa8",6172:"2d2ae3a66a111f064bb2",6207:"6910f3c4f0be2cfcd7f9",6254:"fb638befd53ef04822fc",6277:"9ab483681e0dd61115fd",6303:"ad52f9efd303183abf5e",6371:"83c9e45ceb3fbb5ac155",6377:"0cf4434a790b254858ca",6420:"c893ff2534f9ec304fc8",6447:"ae65f54f868cf08677c1",6486:"40ed2ed019bff637c535",6507:"45af87d3e964f08e8a6b",6668:"55647a5d1bc9e3c671d6",6682:"9becee958a13c31f4d51",6693:"c6930c583c7e9d61234b",6758:"6fcf8c53e0a66334e5b5",6819:"e5d97b6c04bdd4635620",6839:"e28294d51df437cc6b53",6883:"520bd0ef8bbe299a89fd",6961:"d2477df2a28b8ea47ea2",6977:"d2b3c9ce6ad0030f20e0",6981:"a398d4d79a48e5730885",7183:"5a6c8f84f8386ea3c3ed",7249:"4073992e83966234ebec",7275:"7c3b58f1d8197ca0f5d1",7405:"108895750399ba59f40d",7460:"6a739700fefd3a4fbac2",7465:"e625fc96fa7fcd306780",7521:"5d42b54a76a6ec4a9cae",7584:"f1a7f6c3be667fceb4de",7610:"fe88065240ff7a6e5504",7654:"1cc0055d2d390c30d171",7716:"26ccebd94ddb1fb178f8",7760:"df6139586bc8db9f4686",7803:"fa5606e48db6b49a7a94",7832:"741031b8b31f62237cd5",7850:"daed96c9f6d33ebc1f7c",7922:"5d8ea477355f17a5b790",7929:"278820dd70f564f26754",7974:"ce5288c3f1df15948dfd",7979:"fc02d437961fd476496a",7984:"9934eaf18fb03f9dfb88",8041:"f11390e201c64075fd20",8146:"023f5a9d20413b6c62d8",8174:"3c9be19d3316790eddeb",8312:"65a7d4d9a4760d7a5210",8349:"7aa90fbe18ad73a1b95a",8371:"2d00ca350256634d1f71",8398:"602f4d50559d187c1db8",8425:"d4ab2b8d82b74d62566e",8463:"44ea1565bba7d3f2c8f7",8464:"882d97a886a01f301481",8549:"1ac42a66c2ee64bd74ec",8616:"dee76665d36ed3374636",8623:"553364f335b53f0d7c1e",8650:"67b7db5dd364cb97ebc5",8682:"689daa7df9dd2c6fa4fd",8695:"01d9bc6edddbf539b1b7",8701:"dc881152d46536521640",8750:"dc92e0e945b83ec1e05f",8859:"2552cd87af4b757219b6",8883:"a09378804d20733f3763",8924:"1622880c6fb5e4f1cfe3",8970:"cc02d84919fe9ecd9cde",9013:"a4b833b1258c7c9a94fd",9049:"fc259b02f224dda0c43c",9052:"02f43b9abb68bfc5f39c",9109:"276f36aed8996da1df63",9305:"34d5c67b5c79995f8a60",9322:"b26e9b6b0c073f28a102",9325:"1defe50332e08632f07f",9393:"442f478da05ba19070c4",9396:"516ebbc17daf1bbf9ee6",9483:"9fc1ae1899dad20e9396",9510:"c5c3e89e58541aa7825b",9558:"d2eaa19757d176a93ab7",9767:"ad438ca70361b5e69126",9783:"49a1c1edbc5c0821771f",9794:"c13a738c3f6b2ba76ca9",9811:"21a7c18f6923c4c737b9",9835:"2ae69e7cc7d63355340e",9857:"6a190c6f42d0d89b5004",9911:"8dd0d84bc48a0f50dd48"}[e]+".chunk.js",c.miniCssF=e=>e+"."+{380:"78b7b6dc715440560460",1862:"8b03e8bb1c84992cbf32",1877:"e33515e5bd6542b94f77",2045:"2e374ea725d1d98f2dc1",3501:"b1f59c8250c7436d58a1",3745:"03ab023678c0223d3569",3986:"b65058c809eb4184aab8",4194:"0e16885080d878e0abd0",5605:"2175473641dbadf3144f",6172:"2d2ae3a66a111f064bb2",6277:"9ab483681e0dd61115fd",6839:"e28294d51df437cc6b53",6961:"d2477df2a28b8ea47ea2",7275:"7c3b58f1d8197ca0f5d1",7465:"e625fc96fa7fcd306780",7929:"278820dd70f564f26754",7979:"fc02d437961fd476496a",8146:"023f5a9d20413b6c62d8",8549:"1ac42a66c2ee64bd74ec",8623:"553364f335b53f0d7c1e",8650:"67b7db5dd364cb97ebc5",8859:"2552cd87af4b757219b6",9049:"fc259b02f224dda0c43c",9783:"49a1c1edbc5c0821771f",9835:"2ae69e7cc7d63355340e",9911:"8dd0d84bc48a0f50dd48"}[e]+".chunk.css",c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},o="superset:",c.l=(e,t,a,n)=>{if(r[e])r[e].push(t);else{var s,i;if(void 0!==a)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==o+a){s=u;break}}s||(i=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,c.nc&&s.setAttribute("nonce",c.nc),s.setAttribute("data-webpack",o+a),s.src=e),r[e]=[t];var h=(t,a)=>{s.onerror=s.onload=null,clearTimeout(p);var o=r[e];if(delete r[e],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((e=>e(a))),t)return t(a)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),i&&document.head.appendChild(s)}},c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),c.p="/static/assets/",n=e=>new Promise(((t,a)=>{var r=c.miniCssF(e),o=c.p+r;if(((e,t)=>{for(var a=document.getElementsByTagName("link"),r=0;r<a.length;r++){var o=(s=a[r]).getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(o===e||o===t))return s}var n=document.getElementsByTagName("style");for(r=0;r<n.length;r++){var s;if((o=(s=n[r]).getAttribute("data-href"))===e||o===t)return s}})(r,o))return t();((e,t,a,r)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.onerror=o.onload=n=>{if(o.onerror=o.onload=null,"load"===n.type)a();else{var s=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=s,l.request=i,o.parentNode.removeChild(o),r(l)}},o.href=t,document.head.appendChild(o)})(e,o,t,a)})),s={9782:0,9783:0},c.f.miniCss=(e,t)=>{s[e]?t.push(s[e]):0!==s[e]&&{380:1,1862:1,1877:1,2045:1,3501:1,3745:1,3986:1,4194:1,5605:1,6172:1,6277:1,6839:1,6961:1,7275:1,7465:1,7929:1,7979:1,8146:1,8549:1,8623:1,8650:1,8859:1,9049:1,9783:1,9835:1,9911:1}[e]&&t.push(s[e]=n(e).then((()=>{s[e]=0}),(t=>{throw delete s[e],t})))},(()=>{var e={9782:0,9783:0};c.f.j=(t,a)=>{var r=c.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else if(/^(7275|8146|9783)$/.test(t))e[t]=0;else{var o=new Promise(((a,o)=>r=e[t]=[a,o]));a.push(r[2]=o);var n=c.p+c.u(t),s=new Error;c.l(n,(a=>{if(c.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=a&&("load"===a.type?"missing":a.type),n=a&&a.target&&a.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+n+")",s.name="ChunkLoadError",s.type=o,s.request=n,r[1](s)}}),"chunk-"+t,t)}},c.O.j=t=>0===e[t];var t=(t,a)=>{var r,o,[n,s,i]=a,l=0;if(n.some((t=>0!==e[t]))){for(r in s)c.o(s,r)&&(c.m[r]=s[r]);if(i)var d=i(c)}for(t&&t(a);l<n.length;l++)o=n[l],c.o(e,o)&&e[o]&&e[o][0](),e[n[l]]=0;return c.O(d)},a=globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),c.O(void 0,[1216,504,7550,4998,2102,905,1334,9356,2717,2087,741,5473,4438,995,5379,876,9602,2671,1163,323,9525,6962,5806,7843,1603,7727,3375,3389,6559,674,9671,4443],(()=>c(85156)));var d=c.O(void 0,[1216,504,7550,4998,2102,905,1334,9356,2717,2087,741,5473,4438,995,5379,876,9602,2671,1163,323,9525,6962,5806,7843,1603,7727,3375,3389,6559,674,9671,4443],(()=>c(12361)));d=c.O(d)})();