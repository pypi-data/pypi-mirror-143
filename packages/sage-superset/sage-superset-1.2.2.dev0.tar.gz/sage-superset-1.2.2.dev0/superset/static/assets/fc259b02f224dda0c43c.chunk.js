"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[9049],{39049:(t,e,a)=>{a.r(e),a.d(e,{default:()=>I});var n=a(43323),r=a(15078),i=a.n(r),s=a(45697),d=a.n(s),o=a(28041),l=a.n(o),c=a(67190),u=a(51115),p=a(28062);const g={data:d().objectOf(d().arrayOf(d().shape({key:d().arrayOf(d().string),name:d().arrayOf(d().string),time:d().number,value:d().number}))),width:d().number,height:d().number,dateTimeFormat:d().string,numberFormat:d().string,useRichTooltip:d().bool,useAreaProportions:d().bool};function m(t){return{startAngle:t.startAngle,endAngle:t.endAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius}}function h(t,e){return t.value===e.value?t.name>e.name?1:-1:e.value-t.value}function f(t,e){const{data:a,width:n,height:r,colorScheme:s,dateTimeFormat:d,numberFormat:o,useRichTooltip:g,useAreaProportions:f}=e,y=i().select(t);y.classed("superset-legacy-chart-rose",!0);const I=a,b=Object.keys(I).map((t=>parseInt(t,10))).sort(((t,e)=>t-e)),A=b.length,R=I[b[0]].length,v=(0,c.JB)(o),T=(0,u.bt)(d),w=p.getScale(s);i().select(".nvtooltip").remove(),y.selectAll("*").remove();const k=i().svg.arc(),O=l().models.legend(),x=l().models.tooltip(),N={disabled:I[b[0]].map((()=>!1))},S=y.append("svg").attr("width",n).attr("height",r).append("g").attr("class","rose").append("g"),M=S.append("g").attr("class","legendWrap");function C(t){return t[b[0]].map(((t,e)=>({disabled:N.disabled[e],key:t.name})))}O.width(n).color((t=>w(t.key))),M.datum(C(I)).call(O),x.headerFormatter(T).valueFormatter(v);const P=r-O.height(),J=O.height(),W=Math.min(n,P)/2-35,F=.075,L=`translate(${n/2},${P/2+J})`,$=S.append("g").attr("transform",L).attr("class","roseWrap"),U=S.append("g").attr("transform",L).attr("class","labelsWrap"),j=S.append("g").attr("transform",L).attr("class","groupLabelsWrap");function D(t){let e=0,a=0;const n=[];for(const t of b){const r=I[t].reduce(((t,e,a)=>t+(N.disabled[a]?0:e.value)),0);e=r>e?r:e,n[a]=r,a+=1}const r=2*Math.PI/A,i=[];for(let t=0;t<=A;t+=1)i.push(r*t-Math.PI/2);const s=W/e,d=s*W,o=(t,e)=>f?Math.sqrt(d*t+e*e):s*t+e,l={data:[],extend:{},push:{},pieStart:{},pie:{},pieOver:{},mini:{},labels:[],groupLabels:[]};let c=0;for(let e=0;e<A;e+=1){const a=b[e],r=i[e],s=i[e+1],d=2*Math.PI/n[e];let u,p,g=0,m=0;for(const e of t[a]){const t=N.disabled[c%R]?0:e.value,{name:a,time:n}=e;e.id=c,u=o(t,g),l.data.push({startAngle:r,endAngle:s,innerRadius:g,outerRadius:u,name:a,arcId:c,val:t,time:n}),l.extend[c]={startAngle:r,endAngle:s,innerRadius:g,name:a,outerRadius:u+8},l.push[c]={startAngle:r,endAngle:s,innerRadius:g+8,outerRadius:u+8},l.pieStart[c]={startAngle:r,endAngle:s,innerRadius:F*W,outerRadius:W},l.mini[c]={startAngle:r,endAngle:s,innerRadius:g*F,outerRadius:u*F},c+=1,g=u}const f={...l.data[e*R]};f.outerRadius=W+20,f.innerRadius=W+15,l.labels.push(f);for(const r of t[a].concat().sort(h))p=d*(N.disabled[r.id%R]?0:r.value)+m,l.pie[r.id]={startAngle:m,endAngle:p,innerRadius:W*F,outerRadius:W,percent:r.value/n[e]},l.pieOver[r.id]={startAngle:m,endAngle:p,innerRadius:W*F,outerRadius:W+8},m=p}return l.groupLabels=l.data.slice(0,R),l}let Z=D(I);function K(t,e){return function(a){const n=i().interpolate(m(a),m(t));return t=>e(Object.assign(a,n(t)))}}function q(t){return K(t,(t=>k(t)))}function B(t){return K(t,(t=>`translate(${k.centroid(t)})`))}const G={};function z(t){if(G[t])return G[t];const e=Math.floor(t/R);return G[t]=[t+1,R*(e+1)-1],G[t]}const E={};function H(t){if(E[t])return E[t];const e=Math.floor(t/R);return E[t]=[e*R,(e+1)*R-1],E[t]}let Q=-1,V=!1;const X=$.selectAll("g").data(JSON.parse(JSON.stringify(Z.data))).enter().append("g").attr("class","segment").classed("clickable",!0).on("mouseover",(function(t,e){x.data(function(t,e,a){const n=Math.floor(t.arcId/R),r=g?a[b[n]].filter((t=>!N.disabled[t.id%R])).map((e=>({key:e.name,value:e.value,color:w(e.name),highlight:e.id===t.arcId}))):[{key:t.name,value:t.val,color:w(t.name)}];return{key:"Date",value:t.time,series:r}}(t,0,I)).hidden(!1);const a=i().select(this);if(a.classed("hover",!0),Q<0&&!V){a.select("path").interrupt().transition().duration(180).attrTween("d",q(Z.extend[e]));const t=z(e);tt.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(180).attrTween("d",(t=>q(Z.push[t.arcId])(t)))}else if(!V){const n=H(Q);n[0]<=t.arcId&&t.arcId<=n[1]&&a.select("path").interrupt().transition().duration(180).attrTween("d",q(Z.pieOver[e]))}})).on("mouseout",(function(t,e){x.hidden(!0);const a=i().select(this);if(a.classed("hover",!1),Q<0&&!V){a.select("path").interrupt().transition().duration(180).attrTween("d",q(Z.data[e]));const t=z(e);tt.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(180).attrTween("d",(t=>q(Z.data[t.arcId])(t)))}else if(!V){const n=H(Q);n[0]<=t.arcId&&t.arcId<=n[1]&&a.select("path").interrupt().transition().duration(180).attrTween("d",q(Z.pie[e]))}})).on("mousemove",(function(){x()})).on("click",(function(t,e){if(V)return;const a=i().event.altKey?3750:375,n=H(e);if(Q<0)V=!0,Q=e,Y.interrupt().transition().duration(a).attrTween("transform",(t=>B({outerRadius:0,innerRadius:0,startAngle:t.startAngle,endAngle:t.endAngle})(t))).style("opacity",0),_.attr("transform",`translate(${k.centroid({outerRadius:W+20,innerRadius:W+15,startAngle:Z.data[e].startAngle,endAngle:Z.data[e].endAngle})})`).interrupt().transition().delay(a).duration(a).attrTween("transform",(t=>B({outerRadius:W+20,innerRadius:W+15,startAngle:Z.pie[n[0]+t.arcId].startAngle,endAngle:Z.pie[n[0]+t.arcId].endAngle})(t))).style("opacity",(t=>N.disabled[t.arcId]||Z.pie[n[0]+t.arcId].percent<.05?0:1)),X.classed("clickable",(t=>n[0]>t.arcId||t.arcId>n[1])),tt.filter((t=>n[0]<=t.arcId&&t.arcId<=n[1])).interrupt().transition().duration(a).attrTween("d",(t=>q(Z.pieStart[t.arcId])(t))).transition().duration(a).attrTween("d",(t=>q(Z.pie[t.arcId])(t))).each("end",(()=>{V=!1})),tt.filter((t=>n[0]>t.arcId||t.arcId>n[1])).interrupt().transition().duration(a).attrTween("d",(t=>q(Z.mini[t.arcId])(t)));else if(Q<n[0]||n[1]<Q){V=!0;const t=H(Q);Y.interrupt().transition().delay(a).duration(a).attrTween("transform",(t=>B(Z.labels[t.arcId/R])(t))).style("opacity",1),_.interrupt().transition().duration(a).attrTween("transform",B({outerRadius:W+20,innerRadius:W+15,startAngle:Z.data[Q].startAngle,endAngle:Z.data[Q].endAngle})).style("opacity",0),X.classed("clickable",!0),tt.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(a).attrTween("d",(t=>q(Z.pieStart[t.arcId])(t))).transition().duration(a).attrTween("d",(t=>q(Z.data[t.arcId])(t))).each("end",(()=>{Q=-1,V=!1})),tt.filter((e=>t[0]>e.arcId||e.arcId>t[1])).interrupt().transition().delay(a).duration(a).attrTween("d",(t=>q(Z.data[t.arcId])(t)))}})),Y=U.selectAll("g").data(JSON.parse(JSON.stringify(Z.labels))).enter().append("g").attr("class","roseLabel").attr("transform",(t=>`translate(${k.centroid(t)})`));Y.append("text").style("text-anchor","middle").style("fill","#000").text((t=>T(t.time)));const _=j.selectAll("g").data(JSON.parse(JSON.stringify(Z.groupLabels))).enter().append("g");_.style("opacity",0).attr("class","roseGroupLabels").append("text").style("text-anchor","middle").style("fill","#000").text((t=>t.name));const tt=X.append("path").attr("class","arc").attr("fill",(t=>w(t.name))).attr("d",k);O.dispatch.on("stateChange",(t=>{N.disabled!==t.disabled&&(N.disabled=t.disabled,function(){const t=i().event.altKey?3e3:300;M.datum(C(I)).call(O);const e=D(I);if(V=!0,Q<0)tt.style("opacity",1).interrupt().transition().duration(t).attrTween("d",(t=>q(e.data[t.arcId])(t))).each("end",(()=>{V=!1,Z=e})).transition().duration(0).style("opacity",(t=>N.disabled[t.arcId%R]?0:1));else{const a=H(Q);tt.style("opacity",1).interrupt().transition().duration(t).attrTween("d",(t=>a[0]<=t.arcId&&t.arcId<=a[1]?q(e.pie[t.arcId])(t):q(e.mini[t.arcId])(t))).each("end",(()=>{V=!1,Z=e})).transition().duration(0).style("opacity",(t=>N.disabled[t.arcId%R]?0:1)),_.interrupt().transition().duration(t).attrTween("transform",(t=>B({outerRadius:W+20,innerRadius:W+15,startAngle:e.pie[a[0]+t.arcId].startAngle,endAngle:e.pie[a[0]+t.arcId].endAngle})(t))).style("opacity",(t=>N.disabled[t.arcId]||Z.pie[a[0]+t.arcId].percent<.05?0:1))}}())}))}f.displayName="Rose",f.propTypes=g;const y=f,I=(0,n.Z)(y)},43323:(t,e,a)=>{a.d(e,{Z:()=>i});var n=a(67294),r=a(11965);function i(t,e){class a extends n.Component{constructor(t){super(t),this.container=void 0,this.setContainerRef=this.setContainerRef.bind(this)}componentDidMount(){this.execute()}componentDidUpdate(){this.execute()}componentWillUnmount(){this.container=void 0,null!=e&&e.componentWillUnmount&&e.componentWillUnmount.bind(this)()}setContainerRef(t){this.container=t}execute(){this.container&&t(this.container,this.props)}render(){const{id:t,className:e}=this.props;return(0,r.tZ)("div",{ref:this.setContainerRef,id:t,className:e})}}const i=a;return t.displayName&&(i.displayName=t.displayName),t.propTypes&&(i.propTypes={...i.propTypes,...t.propTypes}),t.defaultProps&&(i.defaultProps=t.defaultProps),a}}}]);